{"url": "http://blog.jobbole.com/110329/", "praise_nums": "2", "fav_nums": 0, "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"><p><script src=\"http://www.imooc.com/open/courselistrandjs\"></script><span style=\"display:block;margin-bottom:10px;\"></span></p>\n</div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a target=\"_blank\" href=\"https://zhuanlan.zhihu.com/p/25244146\">游民星空（已获授权）</a>   </div><p>在今天，WASD已成了游戏的标配。尽管多数玩家对此习以为常，但我们可以负责任地说，在20年前，这种键位还非常新鲜。“WASD”能有今天的地位，绝不是一蹴而就，或是某种巧合——相反，它的出现经历了漫长的演变，并得到了许多巨大力量的默默推动——其中就包括了硬件设备、操作系统和游戏设计领域的进步，以及1990年代、电子竞技在欧美的兴起。</p>\n<h3>电子游戏的洪荒时代，玩家们用什么键?</h3>\n<p>关于谁率先用了“WASD”这四个键位，如今已经无从考证，但可以肯定，这个敢于吃螃蟹的人，当初一定比较熟悉编程，而且招来了旁人好奇的目光。因为在游戏产业刚起步的1980年代，在键位设计上，厂商往往各行其是，同时，当时的开发者也很少关注改良操作，同时，它们也极少像今天一样，允许玩家修改游戏中的按键。</p>\n<p><img class=\"alignnone\" src=\"http://wx2.sinaimg.cn/mw690/63918611gy1fcz6d55p34j20go0a910o.jpg\" width=\"600\" height=\"369\"></p>\n<p><i><u>20多年前，WASD还是一件新鲜事</u></i></p>\n<p>这种情况的成因纷繁复杂，但总的来说可以归结为两点：首先，在当时，计算机仍然是一种比较专业的技术设备，其服务的对象也并不是普通家庭。另外，当时的硬件性能往往非常有限，这些因素综合起来导致了一个后果，对研制一款像Windows这样、功能强大，又让人一目了然的操作系统——更重要的是，与之相关的重要硬件——鼠标，更是到1980年代末才真正实现普及。</p>\n<p>于是，1980年代的玩家们只能死死地把住键盘，不仅如此，当时的游戏按键配置往往非常奇葩：比如在RPG《莫里亚》中，为增加游戏难度——开发者甚至没有设定专门的后退键。</p>\n<p>另外，一些开发者更天真地将控制移动的键位，设置成了一列：其中最具有代表性的就是《Rogue》，在游戏中，表示上下左右的实际是键盘右侧的H、J、K、L四个键。</p>\n<p><img class=\"alignnone\" src=\"http://wx2.sinaimg.cn/mw690/63918611gy1fcz6d5jdjrj20go0cin1s.jpg\" width=\"600\" height=\"450\"></p>\n<p><i><u>在老游戏Rogue中，HJKL控制人物移动，从这款游戏中，衍生出了如今一个很火的系列——Roguelike</u></i></p>\n<p>而在1981版的《德军总部》(Castle Wolfenstein)等游戏中，一度使用的是O、P(对应左右移动)和Q、A(对应上下)这四个按钮，这种设计虽然比《Rogue》和《莫里亚》略为高明，但许多人发现，在控制上述几个键的同时，如果还要进行“搜索”和“开枪”等活动时，其姿态就比较尴尬了。正是因此，上述布局很快消失在了历史的长河里。</p>\n<p><img class=\"alignnone\" src=\"http://wx4.sinaimg.cn/mw690/63918611gy1fcz6d682czj20go09dtb1.jpg\" width=\"600\" height=\"337\"></p>\n<p><i><u>1981年版的《德军总部》中，控制移动的是OPQA</u></i></p>\n<h3>“为什么不用上下左右键?”“何不食肉糜?”</h3>\n<p>看到这里，一些读者也许会问，为什么他们不用键盘上四个方向键呢?答案非常简单——在许多老式键盘中，这四个键其实并不存在。当时，计算机的主要作用是编程和处理文档，对于移动光标，主要是通过快捷键的组合或者小键盘上的数字键实现;另一些键盘上虽然增加了方向键，但生产商显然没有考虑人机工程学方面的问题。在那个年代，有的方向键排列成了L型，有的排列成了“一”字型，还有的“抄袭”了主机手柄上的十字键设计。由于这些并不符合玩家使用键盘的姿态，它们的意义几乎可以忽略不计。<img class=\"alignnone\" src=\"http://wx3.sinaimg.cn/mw690/63918611gy1fcz6d6f9nxj20go0cmdo4.jpg\" width=\"600\" height=\"454\"></p>\n<p><i><u>早年的苹果IIC电脑和配套键盘，注意其表示上下左右的方向键位于键盘右下方，而且呈一字排列</u></i></p>\n<p><img class=\"alignnone\" src=\"http://wx2.sinaimg.cn/mw690/63918611gy1fcz6d6wn13j20go06aaeb.jpg\" width=\"600\" height=\"226\"></p>\n<p><i><u>而在IBM公司生产的一款早期键盘上，则没有设置专门的方向键，要想移动光标，你需要先按下Num Lock，然后按小键盘上对应的方向键</u></i></p>\n<p>不过，需要指出的是，手柄十字键的出现，确实给了开发者以许多启示。在许多游戏中，更是将控制方向的键位安排成了十字形或T型。不过，当时最流行的排列不是“WASD”，而是“ESDF”或“IJKL”，1981年上市的《交叉火力(Crossfire)》和1983年上市的Lode Runner就是其中最早的一批作品。由于这种键位对玩家更友好，随后几年，成千上百的游戏都采用了类似的设计。</p>\n<p>这就引出了另一个问题，在这些老游戏中，其键位设定已和今天非常接近，但为什么，当年它们偏偏不使用“WASD”键?其背后的原因也许是，当时设计者们认为，WASD和另外一些重要的按键，如“Tab(切换)”“CapsLocks(大小写切换)”和“Shift(上档)”太接近了，容易导致误操作。不仅如此，当年的键盘是机械式的，而且手感也不太好——它们的按键不仅需要一按到底，所需的力量也远远大于今天，而且只有玩家手指的力道位于中央部分时，按键才不会卡在一半。也正是因此，在当年的游戏中，代表“上下左右”的按键通常会更靠近键盘中部，以方便玩家的大拇指按下空格键。</p>\n<p>在1980年代中后期，情况又出现了变化，尤其是在1984年之后，著名的IBM先后推出了model M及其衍生系列键盘，其中采用了呈“倒T字布局”的方向键。这种设计最早出现于迪吉多公司生产的LK201键盘上，但真正得到普及，却要得益于IBM等大企业的助推。</p>\n<p><img class=\"alignnone\" src=\"http://wx3.sinaimg.cn/mw690/63918611gy1fcz6d7b9xyj20go0760z5.jpg\" width=\"600\" height=\"258\"></p>\n<p><i><u>IBM的Model M型键盘，如今大部分键盘的设计与其相似，其方向键设计非常方便操作，此类键盘普及后，上下左右成了键位的主流</u></i></p>\n<p>与之前的产品相比，新键盘的布局更为合理，手感也更为亲民。随后几年里，它们几乎席卷了硬件市场。也正是在这种键盘推出后，设计者们发现，倒T型布局的方向键更方便玩家用右手操作，给玩家的印象也更一目了然。因此，用它们来对应“上下左右”逐渐成了键位的主流。但此时，一场变革也在计算机领域徐徐展开。</p>\n<h3>鼠标来了，WASD有了出头之日</h3>\n<p>这场变革有两位主角。其中之一被称为“图形用户界面”，今天广泛使用的Windows系统就是其集大成者——在1980年代，苹果公司最先获得突破，率先开发出了成熟的操作系统;后来微软又将此发扬光大，将它们推广到了每个家庭。<img class=\"alignnone\" src=\"http://wx4.sinaimg.cn/mw690/63918611gy1fcz6darcw7j20go094tgc.jpg\" width=\"600\" height=\"328\"></p>\n<p><i><u>微软推出的Windows 1.0，其最初仍然是dos的附属程序</u></i></p>\n<p>这类系统之所以能迅速普及，和一种设备密不可分。这种设备就是鼠标，它发明于1960年代，最初十分笨重和娇贵。但经过十多年的改进，它在1980年代已经变得比较实用和轻便。同时，苹果还让鼠标与自己的产品相互捆绑，加快了它们的进化和普及。</p>\n<p><img class=\"alignnone\" src=\"http://wx1.sinaimg.cn/mw690/63918611gy1fcz6dauhb4j20go0cgn4r.jpg\" width=\"600\" height=\"448\"></p>\n<p><i><u>《德军总部3D》的上市，开启了游戏发展的新纪元，虽然今天看来，这是一部伪3D</u></i></p>\n<p>直到鼠标的普及，这一问题才被解决。不仅如此，在鼠标普及之后，玩家在理论上也可以通过操作，360度旋转视角，这为3D FPS的开发创造了条件。而在1990年代初，随着硬件性能的不断提高，顶尖的计算机已经可以运行复杂的3D程序，一些有远见的开发者(比如传奇程序员罗梅罗和卡马克)也开始研究3D FPS游戏。而最初登场的，正是罗梅洛和卡马克携手开发的《德军总部3D》和《Doom》，虽然在这些游戏中，敌人、武器和道具等物体都是2D的，但较过去的产品已有了巨大改进。</p>\n<p><img class=\"alignnone\" src=\"http://wx1.sinaimg.cn/mw690/63918611gy1fcz6dbmwqwj20dw09cn58.jpg\" width=\"500\" height=\"336\"></p>\n<p><i><u>FPS之父——卡马克</u></i></p>\n<p>不仅如此，在这几部有先驱意义的作品中，罗梅洛和卡马克还抓住了当时社会的潮流，比如年轻人对暴力的好奇。在《德军总部3D》和《Doom》中，他们大胆加入了血浆和断肢等内容——在引发社会争论的同时，也实际是借媒体的力量，让更多人了解了游戏。同时，它们的精良制作也吸引了年轻人，让它们迅速成了当时最受欢迎的游戏作品。</p>\n<p>Raven Software的《雷神之锤》则在此基础上更进一步，增加了全3D贴图、场景高低差、鼠标自由控制视角等前卫的要素，在这些游戏之后，3D FPS最终走出了襁褓期，开始成长为一个主流的游戏类型。</p>\n<h3>助推器：电子竞技</h3>\n<p>说到这里，有读者也许会问，这和“WASD”有什么关系?答案是，鼠标的引入，改变了用户操作电脑的方式，而3D FPS这一游戏类型的风靡，则进一步推动了游戏键位布局的改变。</p>\n<p>也正是这些变革，让玩家的右手几乎被“固定”在了鼠标上，他们身体的重心也相对右移，这时，只有让其左手稍微向左移动一些，才可以实现身体的平衡。另外，与“ESDF”或“IJKL”等布局相比，采用“WASD”后，玩家双手和双臂的横向间距也变得更大，从而让他们获得了一个更为舒服的姿势。</p>\n<p>由于传统的力量是如此强大，玩家仍然需要一段时间，才能发现“WASD+鼠标”的好处。同样，不少游戏开发者也因此走了弯路，比如在《Doom》中，为了照顾不习惯鼠标(许多计算机仍在用DOS操作系统)的玩家，他们特别设置了“向左扫射”和“向右扫射”的快捷键。</p>\n<p><img class=\"alignnone\" src=\"http://wx2.sinaimg.cn/mw690/63918611gy1fcz6dc3jzvj20go0cigtm.jpg\" width=\"600\" height=\"450\"></p>\n<p><i><u>《Doom》截图，在当时的游戏设定中，还有“向左/右扫射”的快捷键</u></i></p>\n<p>同样，另一些同期游戏的键位虽然称不上画蛇添足，但和后来“WASD”的布局仍然有巨大差异，比如1994年游戏《网络奇兵》中，操纵玩家移动的是ASDX，而《Descent》中，AZ代表前进后退，QE代表侧移。还有一些游戏仍然坚持使用“上下左右”，至于另一些则明显比较奇葩了——比如让ZXC负责左右和向后移动，鼠标右键负责前进。</p>\n<p>另外，随着一些游戏允许自定义键位，当时的键位就变得更加五花八门。对统一键位，大部分玩家对此反映反应平淡——一位老玩家曾在reddit上回忆说：“当时，大家都把键位看成某种习惯问题，没有人觉得还把它们强行统一起来。”</p>\n<p>然而，随着《Doom》和《雷神之锤》等作品的出现，游戏已经不再是某种个人的娱乐——由于其在年轻人当中的影响力，它愈发成了娱乐产业的一环，并和利益、声望等捆绑在了一起。在《Doom》《雷神之锤》等FPS中，开发者还特别添加了联机对战功能，这让它们的传播速度突飞猛进。根据统计，《Doom》在上市后两年，下载量(当然是非法的)就超过了1000万人次;一些计算机公司甚至会定期检查员工的电脑——因为这类游戏实在太火爆了，而它们在对战时会严重占用互联网带宽，导致正常的办公活动无法进行。</p>\n<p><img class=\"alignnone\" src=\"http://wx3.sinaimg.cn/mw690/63918611gy1fcz6dc9cqaj20go0ciwo3.jpg\" width=\"600\" height=\"450\"></p>\n<p><i><u>《雷神之锤》截图——当时其画面可谓惊为天人</u></i></p>\n<p>在线对抗的兴起，也让电子竞技有了更广阔的舞台，许多企业注意到了其背后的商机：1997年，微软举办了《雷神之锤》比赛，大概有1900名玩家在线上报名参战，16场赛事在线下举行。为了赢得丰厚的奖品，为了证明自己，为了出人头地，或者仅仅是为了见识一下什么是真正的“专业比赛”，一批早期的电子竞技选手从家中走到了聚光灯下，同时，受到丰厚奖品的刺激，他们纷纷争相寻找一种最合理的操作方式，以提高自己获胜的概率。</p>\n<p>这时，WASD的优势就显现出来了。虽然目前尚不清楚，是谁先发现了它的好处，但可以确定的是，有一个人在其中功不可没，这个人就是著名的《雷神之锤》玩家——丹尼斯·方，在那个年代，他的名字是一个传奇。</p>\n<p>丹尼斯·方1977年出生于美国的一个中产阶级华裔家庭，中文名字是方镛钦，他的父亲在惠普科技担任高管，而他本人和几个兄弟都对电子游戏非常痴迷。但和其他“电竞选手”不同的是，方镛钦没有把大把时间堆砌在“魔鬼训练”上——他一周玩游戏的时间很少超过30个小时，相反，他把更多的精力放在了观察和分析上——这让他能迅速发现游戏对战的诀窍所在。</p>\n<p><img class=\"alignnone\" src=\"http://wx1.sinaimg.cn/mw690/63918611gy1fcz6dcqwdlj20go0b4wn0.jpg\" width=\"600\" height=\"400\"></p>\n<p><i><u>丹尼斯·方，或者说Thresh，他在推广WASD操作的过程中功不可没</u></i></p>\n<p>也正是在这个过程中，方镛钦发现了WASD的好处。就在1993年的某一天，他玩《Doom》的时候，发现偶尔会输给自己的哥哥——而以他哥哥平时的技术，其实根本没有战胜他的可能性。</p>\n<p>方镛钦发现，他哥哥的“秘密武器”是鼠标，这大大增加了他准星移动的速度和准确度，同时，为适应这种变化，他也将控制移动的键位设置在了键盘左侧。这让方镛钦非常惊讶——只要稍稍修改键位，一个普通玩家竟然有机会击败资深玩家!很快，他便逐渐抛弃了之前的操作方式，并且尝试着使用鼠标+WASD的操作方式。</p>\n<p>随后，以Thresh这个名字，方镛钦很快在《雷神之锤》系列的玩家中名声鹊起，他后来回忆说：“在成功转换了操作后，我的技巧成倍的提升。”事实上，在那之后5年，他从来没有输过一场比赛。</p>\n<p>而他的声望真正被推到顶点，是在1997年的《雷神之锤》锦标赛上。当时id Software的创立者约翰·卡马克为胜利者开出了巨奖——一辆价值近10万美元的法拉利328 GTS跑车，这也意味着，一个一文不名的穷小子，完全有可能因为打游戏而一夜暴富。这项活动立刻在玩家当中引起了轰动，无数双眼睛盯准了大奖。然后，方镛钦凭借“WASD+鼠标”的操作脱颖而出，毁掉了所有挑战者们的游戏致富梦。</p>\n<p><img class=\"alignnone\" src=\"http://wx2.sinaimg.cn/mw690/63918611gy1fcz6dd9rudj20b407xgq5.jpg\" width=\"400\" height=\"285\"></p>\n<p><i><u><span id=\"pos_placeholder\"></span>丹尼斯·方在1990年代的一次大奖赛上，注意他是在用右手鼠标+wasd的模式进行操作，而他左侧的选手则不然</u></i></p>\n<p>这次夺冠带给Thresh的，除了一辆法拉利跑车、“传奇玩家”的头衔，还有强大的玩家影响力。在当时的玩家眼中，Thresh作为电子竞技的权威，其经验似乎放之四海而皆准，不仅如此，他连续几年毫无失败的记录更令他们浮想联翩。当随后几个月、Thresh以总冠军的身份走遍美国时：很多玩家难免出于好奇向他发问，什么才是他获胜的诀窍?</p>\n<p><img class=\"alignnone\" src=\"http://wx4.sinaimg.cn/mw690/63918611gy1fcz6ddnic6j20go0czalg.jpg\" width=\"600\" height=\"467\"></p>\n<p><i><u><span id=\"pos_placeholder\"></span>丹尼斯·方(下)在他赢得的法拉利驾驶座上</u></i></p>\n<p>这时，Thresh通常不会灌输一堆关于“战术、意识”的大道理，因为他知道，“这些内容肯定会让对方感到无聊”。他后来回忆说：“我知道，普通玩家需要的是一些更实用的诀窍，于是，我就向他们介绍WASD键位的优点……许多玩家都接受了它，其中甚至有不少和我同场竞技的人，我想，这也是WASD键位今天风靡的一个重要因素。”</p>\n<p>这种说法也得到了其它证据的证实，如果翻阅国外早期电子游戏的论坛发言记录，与WASD联系最密切的主题往往是：“Thresh在《雷神之锤》中用的键位是什么?”同时，有人还找到了一些当年玩家命名的《雷神之锤》键位自定义文件，其中上下左右对应的就是WASD，这些文件还被直接命名成了“thresh.cfg”。</p>\n<p><img class=\"alignnone\" src=\"http://wx4.sinaimg.cn/mw690/63918611gy1fcz6de4zd7j20g80n2dzy.jpg\" width=\"584\" height=\"830\"></p>\n<p><u><i><span id=\"pos_placeholder\"></span>在Thresh的个人网站上，仍然记录着其当时夺冠时的设定</i></u></p>\n<p>此后，WASD的好处，很快以口耳相传的方式，被推广给了更多玩家，甚至影响到了开发商。这时，他们大多已经抛弃了1980年代自娱自乐的思路，而是聚焦于给玩家提供全方位的优秀(至少是不蹩脚的)体验。到《雷神之锤2》的时候，WASD键位已经非常流行。按照一位老玩家在PC Gamer杂志上的回忆：“在我的印象里，不使用这种键位的只有两三个人，而且多数人并不知道它的流行和电竞选手Thresh有关。”虽然《雷神之锤2》在1997年发布时，控制移动的默认键仍然是“上下左右”，但差不多一年之后，后续的升级包终于将其改成了WASD——这表明它的得到了官方的认可和肯定。</p>\n<p><img class=\"alignnone\" src=\"http://wx4.sinaimg.cn/mw690/63918611gy1fcz6deoj9fj20go0ciand.jpg\" width=\"600\" height=\"450\"></p>\n<p><i><u><span id=\"pos_placeholder\"></span>《雷神之锤2》最终将默认键为设成了WASD</u></i></p>\n<p>虽然一些人相信，这可能是由于卡马克受到了Thresh的劝说——因为在《雷神之锤》锦标赛结束后，他们一同在美国各地参加了许多活动，私交从此一直不错。但其真正的原因也许是，WASD已经成为一种潮流，对于这种潮流，游戏开发商更应该迎接而不是抗拒。</p>\n<p>1998年、V社推出的《半条命》更将WASD的地位推到了一个新高度。这款游戏瞄准的就是《Doom》和《雷神之锤》的忠实用户，其开发项目的主管也大多是两款游戏的爱好者，因此，V社当时也直接或间接地受到了《雷神之锤2》中、WASD键位设定的影响。</p>\n<p><img class=\"alignnone\" src=\"http://wx4.sinaimg.cn/mw690/63918611gy1fcz6dfdhmbj20go0ci7f1.jpg\" width=\"600\" height=\"450\"></p>\n<p>后来在接受外媒提问时，V社的工程师雅恩·波恩纳(Yahn Bernier)检查了Half-Life的原始配置文件，并确认其最初的配置确实是WASD——而它和《雷神之锤》的影响有关： “我记得这个文件是在HL1上市前做好的，具体细节已经不记得了，不过，它极有可能是从《雷神之锤》中获得了灵感……”他在一封电子邮件中写道。虽然WASD绝对不是《半条命》风靡的关键因素，但这种设计无疑让玩家感到非常舒适，这有助于巩固它当年FPS的王者地位。</p>\n<p>而另一方面，《半条命》和《雷神之锤2》中的设计也反过来影响了整个市场，就在它们上市后不久，许多同类游戏也效仿了其中的设定。《星际围攻(Starsiege)》也做了WASD默认，到1999年、《雷神之锤3》上市时，采用WASD的游戏已经越来越多，许多日本的游戏公司也效而仿之，同时，它也扩展到其它非FPS类的游戏上，比如《魔兽世界》就是其中代表，至此，WASD确定了自己的统治地位——它一直延续到今天。</p>\n<h3>结语</h3>\n<p>如果对WASD的由来做个最简单的概括：它起源于1980年代出现的、“倒T型”方向键的布局，并且受到了一系列软硬件革命的助推：是操作系统的进步，引发了鼠标的普及，而鼠标操作进入游戏，又进一步让玩家选择了左手控制人物移动;另一方面，罗梅罗和卡马克等人的优秀设计，导致了3D FPS的风靡和电子竞技的火爆，以及玩家对最高效的操作方式的关心——以上一连串复杂因果关系催生了WASD。</p>\n<p>需要指出的是，其中固然有一些偶然因素的促成，但WASD至今未被取代，却是因为它自身的优势，毕竟在如今的情况下下，WASD无疑是让玩家感到最舒适的键位设定——这也印证了历史不断证明过的事——没有一件大家习惯的事情是出于偶然，相反，它们背后往往有看不见的力量进行推动，并且经历了长期的演变，而每一次的变化，都会让它们更加科学和合理。</p>\n<p>当然了，虽说WASD的地位毋庸置疑，但目前依然有一些人对这个键位不太喜欢，这些人要么是从1980年代一路走来的老玩家，要么是由于习惯使然。</p>\n<p><img class=\"alignnone\" src=\"http://wx2.sinaimg.cn/mw690/63918611gy1fcz6dg7kmfj20go0frqfh.jpg\" width=\"600\" height=\"567\"></p>\n<p>近来网上很火的一张图：玩魔兽的G胖，从照片中看，他似乎是在用键盘右下的方向键来控制人物，不知道在这种情况下，他如何设置物品和技能的快捷键</p>\n<p>在这些异类中，就包括了V社的老板G胖，在接受采访时，他宣称自己更喜欢使用ESDF键位布局。最近流出的一张照片则显示，玩《魔兽世界》时，G胖似乎是用键盘右下方的方向键来控制人物移动。颇为有趣的是，另一位《半条命》的开发者，关卡设计师达里奥·卡萨利(Dario Casali)同样不喜欢WASD，相反，他喜欢ASXC：“对我来说这样更自然，WASD反而很蹩脚。可是很多人都觉得我很奇怪。”</p>\n<p>相信，类似的情况也适用于在PC上使用手柄的玩家，但对说实话，我们没有必要感到惊诧，因为尽管WASD的优点显而易见，但“好不好用”完全是一件私人的事，何况在游戏世界中，每个人都有选择和决定的权利——而这一点，也是它引人入胜的原因所在。</p>\n<p>本文作者：游民星空—最后的防线<br>\n本体传送门：<a href=\"http://www.gamersky.com/zl/column/201701/863437.shtml\" target=\"_blank\" rel=\"nofollow noreferrer\">冷知识：WASD，何时成了游戏操作的主流？</a></p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"110329\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"110329votetotal\">2</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"110329\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i>  收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_url": ["http://wx2.sinaimg.cn/mw690/63918611gy1fcz6d55p34j20go0a910o.jpg"], "tags": "趣文小说,WASD,游戏", "url_object_id": "18ce06d43d413e8a1fba887be9f05d4f", "title": "WASD 何时成了游戏操作的主流？", "comment_nums": 0, "front_image_path": "full/725872d20e45b06c1551d1d327fec49e772a941a.jpg", "create_date": "2017/02/22"}
{"url": "http://blog.jobbole.com/110194/", "praise_nums": "3", "fav_nums": 11, "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"><p><script src=\"http://www.imooc.com/open/courselistrandjs\"></script><span style=\"display:block;margin-bottom:10px;\"></span></p>\n</div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文由 <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/ecustRico\">Rico_Chow</a> 翻译，<a href=\"http://www.jobbole.com/members/liuchang\">刘唱</a> 校稿。未经许可，禁止转载！<br>英文出处：<a target=\"_blank\" href=\"https://www.algotech.solutions/blog/after-hours/book-recommendations-for-programmers/\">Calina-Ioana Tutunaru</a>。欢迎加入<a target=\"_blank\" href=\"http://group.jobbole.com/category/feedback/trans-team/\">翻译组</a>。</div><p>生活中我是一个嗜书如命的人，不管是小说还是非小说，不同类型的书我都喜欢看。不过，人在成年之后，读书的热情会逐渐消退，把精力投入到其他事物上。不足为奇的是，不论何种形式的书（包括电子书和有声读物），几乎没有成年人能坚持定期阅读。我既不打算谈论社交媒体如何转移了我们的注意力，也不想站在道德高地批判一番。我只想传达一个观点：阅读对一个人的职业生涯至关重要。我也有一些好书推荐给同为程序员的你们，希望你们能试着读一读。</p>\n<p>我们最近在 Algotech Solutions 投资建设了图书馆，其中大多都是技术书籍。有些书简直就是上帝的恩赐，它们帮助我们开拓了视野。每本书都对开发有所助益，我认为优秀的程序员需要认真阅读关于以下几个主题的书籍：</p>\n<h3>推荐给程序员的传记</h3>\n<p>传记或是自传，是程序员（尤其那些追求创新的程序员）的灵感源泉。人类最重要的特点之一就是不必事事都亲力亲为，他们从他人的人生经历的成功或失败中吸取经验和教训，从而拓展他们的知识。</p>\n<p>科技大佬们的人生经历构成了一部部鲜活的传记。以下是我推荐的传记：</p>\n<ul>\n<li>《Steve Jobs | <a href=\"https://www.amazon.cn/gp/product/B00IM4IFL2/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;camp=536&amp;creative=3200&amp;creativeASIN=B00IM4IFL2&amp;linkCode=as2&amp;tag=vastwork-23\" target=\"_blank\">史蒂夫·乔布斯传</a>》（作者：Walter Isaacson），苹果创始人的“官方”传记。Walter Isaacson 是著名的传记作家，这大概也是乔布斯选择他来的原因。</li>\n<li>《Losing My Virginity | <a href=\"https://www.amazon.cn/gp/product/B00CO2530E/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;camp=536&amp;creative=3200&amp;creativeASIN=B00CO2530E&amp;linkCode=as2&amp;tag=vastwork-23\" target=\"_blank\">一切行业都是创意业:我创立维珍商业帝国的故事 </a>》（Richard Branson 的自传），维珍集团创始人 Richard Branson 是一个高尚风趣的人。粉丝们也喜爱 Branson 写的其他书，他写的每本书都体现了其人格魅力。</li>\n<li>《Elon Musk | <a href=\"https://www.amazon.cn/gp/product/B01DVVQVMK/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;camp=536&amp;creative=3200&amp;creativeASIN=B01DVVQVMK&amp;linkCode=as2&amp;tag=vastwork-23\" target=\"_blank\">硅谷钢铁侠:埃隆·马斯克的冒险人生</a>》（作者：Ashlee Vance）。著名创新者和企业家的传记对需要灵感的人来说是必读之物。Elon Musk 年轻时经历的艰辛和他不断努力改变世界的壮举无疑会给你留下深刻印象。</li>\n</ul>\n<p>附：《I am Zlatan Ibrahimovic | <a href=\"https://www.amazon.cn/gp/product/B00QJV65IA/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;camp=536&amp;creative=3200&amp;creativeASIN=B00QJV65IA&amp;linkCode=as2&amp;tag=vastwork-23\" target=\"_blank\">我是伊布:我来讲述真像</a>》（作者：David Lagercrantz 和 Zlatan Ibrahimovic）虽然这本书和其他传记一样都没有涉及技术相关的主题，但如果你是那种“摇滚明星/忍者”类型的程序员，你绝对会喜欢这本书。即使你性格羞涩内向，你依然可以从伊布身上学会欣赏自身的价值。</p>\n<h3>至于编程嘛…好吧，给程序员的编程书籍</h3>\n<p>读技术书籍最难的部分在于如何选择。有时，晦涩难懂的理论或毫无生气的文字会让你对相关技术望而却步。但是精彩的技术书籍却能让你沉浸其中。它让书中主题易于理解和应用，人们很容易就能读懂。我们通常称之为“某某圣经”。</p>\n<p>技术书籍（当然不仅仅局限于编程方面的书籍）有一个问题在于，你很难区分它出名是由于炒作还是自身质量。因此，记住要认真阅读一本技术书籍的评论，同时也考虑书的评分。好的技术书籍常常有可观的读者和评分。为了愉悦的读书经历，请谨慎选择，或者你也可以从我们的推荐书籍中选取：</p>\n<ul>\n<li>算法圣经：《Introduction to Algorithms | <a href=\"https://www.amazon.cn/gp/product/B00AK7BYJY/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;camp=536&amp;creative=3200&amp;creativeASIN=B00AK7BYJY&amp;linkCode=as2&amp;tag=vastwork-23\" target=\"_blank\">算法导论</a>》（作者：Thomas H. Cormen, Charles E. Leiserson, Ronald L. Rivest and Clifford Stein）</li>\n<li>人工智能圣经：《Artificial Intelligence: A Modern Approach | <a href=\"https://www.amazon.cn/gp/product/B005CT25NY/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;camp=536&amp;creative=3200&amp;creativeASIN=B005CT25NY&amp;linkCode=as2&amp;tag=vastwork-23\" target=\"_blank\">人工智能：一种现代方法</a>》（作者：Stuart Russel 和 Peter Norvig）通常称为 AIMA，是许多大学的计算机课程教材之一。</li>\n<li>职业素养圣经：《The Clean Coder | <a href=\"https://www.amazon.cn/gp/product/B01LZJ8L9J/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;camp=536&amp;creative=3200&amp;creativeASIN=B01LZJ8L9J&amp;linkCode=as2&amp;tag=vastwork-23\" target=\"_blank\">程序员的职业素养</a>》如果只给全世界的程序员推荐一本书，我会推荐这本。它包含了许多有价值的信息，平衡工作和生活的建议，以及真正的职业素养。</li>\n<li>设计模式圣经：《Elements of Reusable Object-Oriented Software | <a href=\"https://www.amazon.cn/gp/product/B001130JN8/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;camp=536&amp;creative=3200&amp;creativeASIN=B001130JN8&amp;linkCode=as2&amp;tag=vastwork-23\" target=\"_blank\">设计模式:可复用面向对象软件的基础</a>》 （作者：Erich Gamma, Richard Helm, Ralph Johnson, John Vlissides）这几位作者通常被称为四人帮或 GoF。</li>\n<li>企业模式圣经：《Patterns of Enterprise Application Architecture | <a href=\"https://www.amazon.cn/gp/product/B003LBSRDM/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;camp=536&amp;creative=3200&amp;creativeASIN=B003LBSRDM&amp;linkCode=as2&amp;tag=vastwork-23\" target=\"_blank\">企业应用架构模式</a>》（作者：Martin Fowler 等）如果觉得上一本不难就看看这本吧。</li>\n</ul>\n<h3>推荐给程序员的社会学书籍</h3>\n<p>我费尽心思才想出“社会学”这一统称，它涵盖了心理学、经济学、历史和自我发展。近来这些主题的书籍数量激增，但质量一般，门外汉居多。这些书如此受欢迎是有许多原因的，其中之一就是你可以从中学习经验教训而不用蹈其覆辙。你可能记得我曾在传记那一节说过上述观点，这里只是领域不同。下面是我们推荐给程序员的社会学科的书籍：</p>\n<ul>\n<li>《<a href=\"https://www.amazon.cn/gp/product/0141978953/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;camp=536&amp;creative=3200&amp;creativeASIN=0141978953&amp;linkCode=as2&amp;tag=vastwork-23\" target=\"_blank\">David and Goliath: Underdogs, Misfits, and the Art of Battling Giants</a>》（作者：Malcolm Gladwell）书中作者认为，许多我们自认为的劣势恰恰却是我们的优势。作者用浅显易懂的语言表达了其观点，并以现实生活中的例子予以举证。它是创业者的必读书籍！</li>\n<li>《Predictably Irrational: The Hidden Forces That Shape Our Decisions | <a href=\"https://www.amazon.cn/gp/product/B0040NO84W/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;camp=536&amp;creative=3200&amp;creativeASIN=B0040NO84W&amp;linkCode=as2&amp;tag=vastwork-23\" target=\"_blank\">怪诞行为学:可预测的非理性</a>》（作者：Dan Ariely）读了这本书，你会了解人们如何下决策并且明白理性并非等式。</li>\n<li>《<a href=\"https://www.amazon.cn/gp/product/1405503572/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;camp=536&amp;creative=3200&amp;creativeASIN=1405503572&amp;linkCode=as2&amp;tag=vastwork-23\" target=\"_blank\">The Undercover Economist</a> | 卧底经济学》（作者：Tim Harford）你认为每个行为的发生（即使是那些被认为是非经济学相关的行为）都是孤立的吗？Tim Harford 会说服你反对这一观点，在他经济主导的世界观中，任何行为都是一场决策与妥协的游戏，彼此息息相关。游戏理论爱好者一定会和这本书产生共鸣。</li>\n<li>《The Third Chimpanzee | <a href=\"https://www.amazon.cn/gp/product/B007X2KA2Q/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;camp=536&amp;creative=3200&amp;creativeASIN=B007X2KA2Q&amp;linkCode=as2&amp;tag=vastwork-23\" target=\"_blank\">第三种黑猩猩:人类的身世与未来</a>》（作者：Jared Diamond）这是一本关于人类早期进化的书籍，书中详细阐述了社会和人类行为的生物学动机。我最欣赏贾 Jared Diamond 的一点是其对于事物的大局观。就比如他另一本书，也是我的最爱：《<a href=\"https://www.amazon.cn/gp/product/B01JODTOFK/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;camp=536&amp;creative=3200&amp;creativeASIN=B01JODTOFK&amp;linkCode=as2&amp;tag=vastwork-23\" target=\"_blank\">枪炮、病菌与钢铁</a>》，书中并没有去抠不相关的细枝末节，而是用自上而下的方法阐述错综复杂的主题。</li>\n</ul>\n<h3>推荐给程序员的科幻小说</h3>\n<p>Robert C. Martin（人称“Bob大叔”），全世界最出名的软件工程师和作家之一，他在其著作《程序员的职业素养》中提到，他需要接收例如书籍和电影等创造性的输入，才能支撑他输出富有创造性的高质量代码。他的个人爱好？你猜对了：科幻小说。</p>\n<p>出色的科幻小说会令你拍案惊奇，会让你思考道德困境以及变换莫测的未来，是一类很“适合”程序员的书，因为程序员也常常思考未来的技术。在推荐这类小说时，我常常抱有防备之心，因为通常我鼓励人们读读看再下结论时，他们却开口抱怨“如果就是机器人之类的话，我并不感兴趣”。以下是我读过最棒的科幻小说：</p>\n<ul>\n<li>《<a href=\"https://www.amazon.cn/gp/product/0553293397/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;camp=536&amp;creative=3200&amp;creativeASIN=0553293397&amp;linkCode=as2&amp;tag=vastwork-23\" target=\"_blank\">The Naked Sun</a> | 赤裸的太阳》（作者：Isaac Asimov）。其实，你随便挑一本 Asimov 的书，都能让你满意。</li>\n<li>《Ender’s Game | <a href=\"https://www.amazon.cn/gp/product/B01I2VU4B8/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;camp=536&amp;creative=3200&amp;creativeASIN=B01I2VU4B8&amp;linkCode=as2&amp;tag=vastwork-23\" target=\"_blank\">安德的游戏</a>》（作者：Orson Scott Card）哈利波特式的小说，讲述了一个太空战斗学校的神童学生的故事，故事结尾却是有趣的反转。嘘，别剧透！</li>\n<li>《The Old Man’s War | <a href=\"https://www.amazon.cn/gp/product/B00HN298W4/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;camp=536&amp;creative=3200&amp;creativeASIN=B00HN298W4&amp;linkCode=as2&amp;tag=vastwork-23\" target=\"_blank\">来自12个星球的敌人</a>》（作者：John Scalzi）故事情节是：在未来，老人们可以注册加入星际护卫队。本书情节一波三折，会让你心醉神迷。需要提示吗？好吧，你可以先问问自己：“75岁的老头怎么打太空战？”</li>\n<li>《<a href=\"https://www.amazon.cn/gp/product/B01EFICI1Q/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;camp=536&amp;creative=3200&amp;creativeASIN=B01EFICI1Q&amp;linkCode=as2&amp;tag=vastwork-23\" target=\"_blank\">1984</a>》（作者：George Orwell）经典读物之一，书中描写了在悲惨的未来世界，人们的一举一动都在严密监控之下，可以说是这本书开创了反乌托邦流派。不仅书中假设的前提有趣，而且本身的叙述手法也很出色。</li>\n</ul>\n<p>怎么样？如果你想要在这里展示其他类型书籍，请在评论中告之我们。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"110194\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"110194votetotal\">3</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"110194\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 11 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i> 3 评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/ecustRico\">Rico_Chow</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/ecustRico\">\r\n\t\t\t<img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/a4fd64b15a64e56ae1c47f46686fa173.jpg\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            爱生活，爱编码        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/ecustRico\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/ecustrico/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/ecustRico/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 12</a> · <a title=\"我的网站\" target=\"_blank\" href=\"http://ricoflasky.herokuapp.com/\"><i class=\"fa fa-link\"></i></a> <a title=\"QQ：691049297\" target=\"_blank\" href=\"#\"><i class=\"fa fa-qq\"></i></a> <a title=\"GitHub主页\" target=\"_blank\" href=\"http://github.com/RicoChou\"><i class=\"fa fa-github\"></i></a>         </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2011/11/book-logo.jpg"], "tags": "书籍与教程,书籍", "url_object_id": "517a94b358e4229eeb04213ce5a31983", "title": "推荐给程序员的一些书（不止是技术书）", "comment_nums": 3, "front_image_path": "full/531eb849012feb4ab0733e2d5786096a0574d25c.jpg", "create_date": "2017/02/19"}
{"url": "http://blog.jobbole.com/110197/", "praise_nums": "3", "fav_nums": 5, "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"><p><script src=\"http://www.imooc.com/open/courselistrandjs\"></script><span style=\"display:block;margin-bottom:10px;\"></span></p>\n</div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文由 <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/minxuaner\">李小萌</a> 翻译，<a href=\"http://www.jobbole.com/members/hanxiaomax\">艾凌风</a> 校稿。未经许可，禁止转载！<br>英文出处：<a target=\"_blank\" href=\"https://www.quora.com/What-are-some-of-the-most-important-things-that-we-should-be-informed-about-in-life\">Quora</a>。欢迎加入<a target=\"_blank\" href=\"http://group.jobbole.com/category/feedback/trans-team/\">翻译组</a>。</div><p>【伯乐在线导读】：有位网友在 Quora 发帖提问，询问生活中该最应该了解哪些重要的事？本文摘编了 3 位网友的回答。</p>\n<h3>Justin-Freeman （曾做过警cha的作家）的分享， 17.5 k 顶</h3>\n<p><strong>1、其实没人关注你，即便他们真忽略你，你也不用在意。</strong>买了辆新车？没人注意。前两周会有些围观者，但他们不是关心，而是好奇。三周内，闪耀的新车也只是高速公路、车库和街道中的沧海一粟。别人关注你的车，就跟你关注别人的车一样。低价得了件新宝贝？买了新衣橱？去了家高级餐厅？出国旅行了？没人关注这些。不要把你的快乐建立在别人的关注上，因为没人在乎。如果有，他们要么是想夺人所爱，要么就是嫉妒你能拥有这些。</p>\n<p><strong>2、有些人会打破第一条规律↑。</strong>偶尔，有人会反其道而行之地真心在乎你。抱歉，仍然不是你想要的。但如果他们重视你，就会觉得你值得拥有这些，并会倾听你。当你和对方谈论这些其他人不在意的事情，他们会注视着你，消化你说的每个字，在那时，你就知道他们是全身心地和你在一起。</p>\n<p><strong>3、和在乎你的人共度一生。</strong>和他们结婚、做朋友或同事、一起共度周末。不管以后你拥有多大的权力，都没法强迫一个人在意你——所以把这些关心你的人聚集到身边来。</p>\n<p><strong>4、金钱是廉价的。</strong>我的意思是说，世界上的钱数不胜数，印有面值的现金至少占了大半。不要把生活建立在怎么赚钱上，让你的慷慨精神反映此原则。我认识一个被财欲驱使的人，为了积累六位数积蓄，他努力工作、省吃俭用，为达目标做了很多牺牲。而他在癌症病亡前，确实做到了。我相信他妻子的新任丈夫会感激她前夫的勤奋。</p>\n<p><strong>5、金钱是昂贵的。</strong>我的意思是说，有时候挣钱并不容易——你永远也不知道谁会在什么时候悄悄将你一军——所以不要草率对待金钱。避免贬值资产带来的债务，永远不要为了满足虚荣心而负债（参照第一条规则）。现在债务变得合乎规范了，但不要轻率地认为这是进入成年的一个仪式——负债代表着收支不平衡，而且往往在某种意义上代表了缺乏自控力。学生贷款债务不可避免，但也不一定——我和妻子一共花了十年时间读完大学，却是零负债。如果不能避免负债，那么就要确保你的学位是门投资，而不是责任——我为那些为了追求模糊的文科学位而身负上万美元债务，而且不知道在生活之外想要什么的人感到悲哀。如果你是因为当时没有更好的办法，只能将大把的学费浪费掉，还不如利用退回的学费在欧洲游玩几周——我保证游玩花的钱少，学的东西还比上学时多。</p>\n<p><strong>6、学习古老的修辞艺术。</strong>各种各样形式的修辞元素，让世界丰富多彩——因为他们促使着人们做出决定。如果你深入理解修辞如何运作，当其他人受到绚丽言辞的惊吓时，你就能明白语言沟通背后的含义，看清小把戏。到时你不仅会对各种带欺骗性质、糖衣炮弹形式的商业广告、市场营销、街边叫卖以及销售员形成免疫，还会发现自己拥有了影响他人的言辞艺术。当你知道怎么劝说别人改变主意、建议他人的自信心、安抚小孩的恐惧时，就已掌握这项技能。然而，当你使用这门艺术时要切记：在任何争辩中，你的对手不是另外一个人，而是《无知》。</p>\n<p><strong>7、你要<em>对</em>别人负责，更要<em>为</em>自己负责。</strong>我相信，在有些事情上我们需要对每个人负责，即使那些事情就像肯定人格那样简单。但是，我们肩负的责任远非如此，它需要体现在为他人服务，为沉默的人呐喊。如果你正在看这篇文章，身边还有一些责任更重大的人，他们需要抚慰、尊重和机遇。相反，能为你负责的只有你自己。没人能为你找到成功，也没人能帮你从外界获得快乐。只能靠你自己。</p>\n<p><strong>8、学会在体系中认清现实。</strong>当你意识到世界是一个相互连接、相互依存的巨大网络，有些事就变得不那么神秘了——越少归结于魔法或模棱两可的结论，我们就越不容易受他人影响。</p>\n<p><strong>9、小心驶得万年船。</strong>有时一些小事打乱了精心的计划，如果在生活中没有给经济、情感或者其他方面留白，就会受突发事件的影响。冒险要准备好退路——我严重怀疑那些说B计划象征弱者的人，在生活中朝不保夕。一步一个脚印地做你需要做的事儿。</p>\n<p><strong>10、寻求他人帮助的同时，也需要独立。</strong>在某种意义上，你需要其他人，因为你需要融入团体——这也是我们同情隐士的原因。抛开人类起源论，很难否认我们就是群居动物，而且“我们”总是胜过“我”。然而你的人生意义并不需要其他人来参与—— Disney 把这样的想法推到世人面前：如果我们始终坚信并且不停止寻找，那个等待我们的人就会出现，这只是瞎话……别无其他，因为算法（复杂）。开创你自己的人生——如果之后有个特别的人，让你情不自禁地想在一起，相信我，到时你会懂的。</p>\n<p><strong>11、总比要求的做多一点。</strong></p>\n<p> </p>\n<h3>Mike Leary 的分享， 7.7 翘赞</h3>\n<p>1、你寿命有限。</p>\n<p>2、你想成为什么样的人。</p>\n<p>3、持续冒险，直到你找到热情所在。</p>\n<p>4、不要为了外貌、地位、一时冲动或金钱结婚。你只是和魔鬼做了个交易，它会使你失去灵魂。</p>\n<p>5、你的身体健康，不只是现在关键，在未来也是一样。照顾好它。</p>\n<p>6、让其他人轻易看到，诚实、正直、可靠、礼貌、友善等（品质）在你的生活中成为必然。</p>\n<p>7、找到回馈以真诚的朋友，他们会救你的命。</p>\n<p>8、学会根据内心真实（想法），而不是凭着理智或感觉。</p>\n<p>9、谅解父母、兄弟姐妹、小孩儿和那些不知道你是谁的人。</p>\n<p>10、人生在世，除了为自己，（应该）找一个更好的精神追求。</p>\n<p> </p>\n<h3>Zehra Alvi 的分享，2.5 千顶</h3>\n<p><strong>1、身体健康总是第一位。</strong></p>\n<p>身体陪伴你的时间最久。它会从你出生坚持到离世时。什么都能被替代，唯独健康不行。只有当你病了，才会意识到健康的价值。从现在开始照顾好自己。吃健康的食物，做适当的运动。不要忽略身体上的小毛病，必要时去看医生。</p>\n<p><strong>“身体就像金钱，我们永远不会真正了解它的价值，直到失去它。”—— Josh Billings</strong></p>\n<p><strong>2、最好的生活方式就是用自己的方式生活。</strong></p>\n<p>你可以努力取悦父母或生活中的其他人，但事实是你永远无法真正满足他们。所以，甚至懒得尝试。做那些让你自己高兴、开心的事儿。不要让他人的期望束缚你。朝着自己的方向前行。</p>\n<p><strong>“尝试用你希望的方式生活，其他人会用他们自己的方式生活。”—— Raymond Burr</strong></p>\n<p><strong>3、时光不复返。</strong></p>\n<p>现在，此刻的呼吸，永不复返。时光流逝。生命在一秒一秒地慢慢逝去。你失去了很多宝贵的时间。你永远回不到童年，青春很快消失，你会后悔以前做的决定。做你必须做的事儿，就是现在！</p>\n<p><strong>“乐在当下，此刻就是你的人生。”—— Omar Khayyam</strong></p>\n<p><strong>4、钱财问题。</strong></p>\n<p>爱和信任不是保持关系的唯一方法。钱是最重要的，经济独立应该是你的头等大事。你不用成为一个百万富翁，但是应该能够养活自己和家人。当你没足够的钱维持生计，爱不能喂饱你。事实上，在这世上，缺钱或想要钱是万恶之源。</p>\n<p><strong>“永远记住，生活中钱不是万能的，但在说这样的废话之前，确保你挣了足够的钱。”—— Earl Wilson</strong></p>\n<p><strong>5、脸皮厚，得长存。</strong></p>\n<p>你越容易受他人看法的影响，给自己掘的坟墓就越深。虽然不受别人影响很困难，但你能做的最佳方法就是对这些人充耳不闻。澄清事件和施以报复会让事情变得更糟。历史告诉我们，圣人都会被评判，更何况是我们呢。</p>\n<p><strong>“没你的同意，没人能让你自卑。”—— Eleanor Roosevelt</strong></p>\n<p><strong>6、失败是无法避免的。</strong></p>\n<p>你会面临失败，可能是绝对的或相对的。尽管如此，没有失败的生活是不完整的。你要知道，没人能一直占优势，也没有谁一夜成名。通往成功的路有几个收费站，这些地方你失败了，但是你肯定获得了经验。站起来，拍拍身上的尘埃，继续前行。这是你唯一的选择。</p>\n<p><strong>“摔倒不是失败，当你拒绝站起来，那才是失败。”—— Paulo Coelho</strong></p>\n<p><strong>7、你并不会永远对。</strong></p>\n<p>通常，你会是错的。你的观点、意见、想法和信仰不会和他人一致。你有信仰的权利，但能被证明错了。智者接受犯错。承认自己就是个不完美的人，充满了缺点。你不能总是对的。</p>\n<p><strong>“不追求完美，你将永远不能成功。”—— Salvador Dalí</strong></p>\n<p><strong>8、学习沟通。</strong></p>\n<p>提高沟通技能。（与人）互动，而不只是聊天。用语言来影响他人。如果你喜欢某人的一些事儿，把它说出来。你要能清楚地表达自我。有一半的误会是由误解而引起。在你回应前，（仔细）倾听并理解（含义）。文字就像箭头。在实践中要谨慎为之。</p>\n<p><strong>“当然，语言是被人类运用的最强效的药。”—— Rudyard Kipling</strong></p>\n<p><strong>9、每个人都是自私的。</strong></p>\n<p>没人会喂你吃他们的饭，然后自己饿着肚子去睡觉。生活不是那样。每个人不得不照顾好自己。为自己做好打算，不要依赖他人的慈善事业。照料好自己，做一个自立的人。</p>\n<p><strong>“我会照顾好自己，越是孤独，越是没有朋友，越是没有支持，我就越要尊重我自己。”—— Charlotte Brontë</strong></p>\n<p><strong>10、不要心怀期望。</strong></p>\n<p>期望别人用某种方式行事或期望世事按照自己的计划挺傻的。一切事情都以机会为基础，每个人的行动都以兴趣为基础。不要对你的家人、朋友或政府心怀期望。任何可能发生的事情，都不会按照你的意愿发生。为此做好（心理）准备。</p>\n<p><strong>“我发现期望越低，生活就越容易。”—— Bill Watterson</strong></p>\n\r\n        \r\n            <blockquote class=\"rewards\">\n        <p><strong>打赏支持我翻译更多好文章，谢谢！</strong></p>\n        <a href=\"#rewardbox\" id=\"rewards-button\" class=\"fancybox\"><span class=\"btn-bluet-blue href-style\"><i class=\"fa fa-jpy\"></i> 打赏译者</span></a>\n    </blockquote>\n\n    <div id=\"rewardbox\">\n        <h4>打赏支持我翻译更多好文章，谢谢！</h4>\n                <p>任选一种支付方式</p>\n                <p>\n                        <img src=\"http://jbcdn2.b0.upaiyun.com/2017/01/cc60538172a8003631f75028bb0348bb.png\">\n            \n                            <img src=\"http://jbcdn2.b0.upaiyun.com/2017/01/db52a6057133cc28d0d5b7e61528971d.jpg\">\n                    </p>\n    </div>\n\n    \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"110197\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"110197votetotal\">3</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"110197\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 5 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i> 2 评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/minxuaner\">李小萌</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/minxuaner\">\r\n\t\t\t<img src=\"http://jbcdn2.b0.upaiyun.com/2017/01/fc979a9646da54dc7123a724fc6325e0.jpg\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            软件行业的市场营销人，兴趣点：互联网、运营推广、创业、软件、英语。        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/minxuaner\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/minxuaner/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/minxuaner/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 12</a> · <a title=\"微博主页\" target=\"_blank\" href=\"http://m.weibo.cn/u/2036263834\"><i class=\"fa fa-weibo\"></i></a> <a title=\"QQ：597208153\" target=\"_blank\" href=\"#\"><i class=\"fa fa-qq\"></i></a> <a title=\"个人微信：minxuaner\" target=\"_blank\" href=\"#\"><i class=\"fa fa-weixin\"></i></a>         </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2012/08/advice-500x375.jpg"], "tags": "职场,建议,生活", "url_object_id": "97b68ccf558d30f612b796f4ed3e00b1", "title": "生活中该最应该了解哪些重要的事？", "comment_nums": 2, "front_image_path": "full/a78ca43b54b2fc1357e98b5c57f1b6906b14c7b2.jpg", "create_date": "2017/02/21"}
{"url": "http://blog.jobbole.com/110301/", "praise_nums": "2", "fav_nums": 1, "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"><p><script src=\"http://www.imooc.com/open/courselistrandjs\"></script><span style=\"display:block;margin-bottom:10px;\"></span></p>\n</div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a target=\"_blank\" href=\"http://www.kissyu.org/2017/02/19/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1Mysql%E6%AD%BB%E9%94%81%E6%8E%92%E6%9F%A5%E8%BF%87%E7%A8%8B/\">Young</a>   </div><h2 id=\"背景\">背景</h2>\n<p>以前接触到的数据库死锁，都是批量更新时加锁顺序不一致而导致的死锁，但是上周却遇到了一个很难理解的死锁。借着这个机会又重新学习了一下mysql的死锁知识以及常见的死锁场景。在多方调研以及和同事们的讨论下终于发现了这个死锁问题的成因，收获颇多。虽然是后端程序员，我们不需要像DBA一样深入地去分析与锁相关的源码，但是如果我们能够掌握基本的死锁排查方法，对我们的日常开发还是大有裨益的。</p>\n<p>PS：本文不会介绍死锁的基本知识，mysql的加锁原理可以参考本文的参考资料提供的链接。</p>\n<h2 id=\"死锁起因\">死锁起因</h2>\n<p>先介绍一下数据库和表情况，因为涉及到公司内部真是的数据，所以以下都做了模拟，不会影响具体的分析。</p>\n<p>我们采用的是5.5版本的mysql数据库，事务隔离级别是默认的RR（Repeatable-Read），采用innodb引擎。假设存在test表：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-58adaef89eb57292058177\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nCREATE TABLE `test` (\r\n  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,\r\n  `a` int(11) unsigned DEFAULT NULL,\r\n  PRIMARY KEY (`id`),\r\n  UNIQUE KEY `a` (`a`)\r\n) ENGINE=InnoDB AUTO_INCREMENT=100 DEFAULT CHARSET=utf8;</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb57292058177-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb57292058177-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb57292058177-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb57292058177-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb57292058177-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb57292058177-6\">6</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-58adaef89eb57292058177-1\"><span class=\"crayon-e\">CREATE </span><span class=\"crayon-i\">TABLE</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">test</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb57292058177-2\"><span class=\"crayon-h\">  </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">id</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">11</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">unsigned</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">NOT</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">NULL</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">AUTO_INCREMENT</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb57292058177-3\"><span class=\"crayon-h\">  </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">a</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">11</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">unsigned</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">DEFAULT</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">NULL</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb57292058177-4\"><span class=\"crayon-h\">  </span><span class=\"crayon-e\">PRIMARY </span><span class=\"crayon-e\">KEY</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">id</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb57292058177-5\"><span class=\"crayon-h\">  </span><span class=\"crayon-e\">UNIQUE </span><span class=\"crayon-i\">KEY</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">a</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">a</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb57292058177-6\"><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ENGINE</span><span class=\"crayon-o\">=</span><span class=\"crayon-e\">InnoDB </span><span class=\"crayon-v\">AUTO_INCREMENT</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">100</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">DEFAULT</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">CHARSET</span><span class=\"crayon-o\">=</span><span class=\"crayon-v\">utf8</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0018 seconds] -->\r\n<p>表的结构很简单，一个主键id，另一个唯一索引a。表里的数据如下：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-58adaef89eb61918611160\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nmysql&gt; select * from test;\r\n+----+------+\r\n| id | a    |\r\n+----+------+\r\n|  1 |    1 |\r\n|  2 |    2 |\r\n|  4 |    4 |\r\n+----+------+\r\n3 rows in set (0.00 sec)</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb61918611160-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb61918611160-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb61918611160-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb61918611160-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb61918611160-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb61918611160-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb61918611160-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb61918611160-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb61918611160-9\">9</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-58adaef89eb61918611160-1\"><span class=\"crayon-v\">mysql</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e \">select *</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">from </span><span class=\"crayon-v\">test</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb61918611160-2\"><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb61918611160-3\"><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">a</span><span class=\"crayon-h\">    </span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb61918611160-4\"><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb61918611160-5\"><span class=\"crayon-o\">|</span><span class=\"crayon-h\">  </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\">    </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb61918611160-6\"><span class=\"crayon-o\">|</span><span class=\"crayon-h\">  </span><span class=\"crayon-cn\">2</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\">    </span><span class=\"crayon-cn\">2</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb61918611160-7\"><span class=\"crayon-o\">|</span><span class=\"crayon-h\">  </span><span class=\"crayon-cn\">4</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\">    </span><span class=\"crayon-cn\">4</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb61918611160-8\"><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb61918611160-9\"><span class=\"crayon-cn\">3</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">rows </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">set</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">0.00</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">sec</span><span class=\"crayon-sy\">)</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0017 seconds] -->\r\n<p>出现死锁的操作如下：</p>\n<table>\n<thead>\n<tr>\n<th>步骤</th>\n<th>事务1</th>\n<th>事务2</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td></td>\n<td>begin</td>\n</tr>\n<tr>\n<td>2</td>\n<td></td>\n<td>delete from test where a = 2;</td>\n</tr>\n<tr>\n<td>3</td>\n<td>begin</td>\n<td></td>\n</tr>\n<tr>\n<td>4</td>\n<td>delete from test where a = 2; （事务1卡住）</td>\n<td></td>\n</tr>\n<tr>\n<td>5</td>\n<td>提示出现死锁：ERROR 1213 (40001): Deadlock found when trying to get lock; try restarting transaction</td>\n<td>insert into test (id, a) values (10, 2);</td>\n</tr>\n</tbody>\n</table>\n<p><a id=\"more\"></a>然后我们可以通过<code>SHOW ENGINE INNODB STATUS;</code>来查看死锁日志：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-58adaef89eb66904450122\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n------------------------\r\nLATEST DETECTED DEADLOCK\r\n------------------------\r\n170219 13:31:31\r\n*** (1) TRANSACTION:\r\nTRANSACTION 2A8BD, ACTIVE 11 sec starting index read\r\nmysql tables in use 1, locked 1\r\nLOCK WAIT 2 lock struct(s), heap size 376, 1 row lock(s)\r\nMySQL thread id 448218, OS thread handle 0x2abe5fb5d700, query id 18923238 renjun.fangcloud.net 121.41.41.92 root updating\r\ndelete from test where a = 2\r\n*** (1) WAITING FOR THIS LOCK TO BE GRANTED:\r\nRECORD LOCKS space id 0 page no 923 n bits 80 index `a` of table `oauthdemo`.`test` trx id 2A8BD lock_mode X waiting\r\nRecord lock, heap no 3 PHYSICAL RECORD: n_fields 2; compact format; info bits 32\r\n 0: len 4; hex 00000002; asc     ;;\r\n 1: len 4; hex 00000002; asc     ;;\r\n*** (2) TRANSACTION:\r\nTRANSACTION 2A8BC, ACTIVE 18 sec inserting\r\nmysql tables in use 1, locked 1\r\n4 lock struct(s), heap size 1248, 3 row lock(s), undo log entries 2\r\nMySQL thread id 448217, OS thread handle 0x2abe5fd65700, query id 18923239 renjun.fangcloud.net 121.41.41.92 root update\r\ninsert into test (id,a) values (10,2)\r\n*** (2) HOLDS THE LOCK(S):\r\nRECORD LOCKS space id 0 page no 923 n bits 80 index `a` of table `oauthdemo`.`test` trx id 2A8BC lock_mode X locks rec but not gap\r\nRecord lock, heap no 3 PHYSICAL RECORD: n_fields 2; compact format; info bits 32\r\n 0: len 4; hex 00000002; asc     ;;\r\n 1: len 4; hex 00000002; asc     ;;\r\n*** (2) WAITING FOR THIS LOCK TO BE GRANTED:\r\nRECORD LOCKS space id 0 page no 923 n bits 80 index `a` of table `oauthdemo`.`test` trx id 2A8BC lock mode S waiting\r\nRecord lock, heap no 3 PHYSICAL RECORD: n_fields 2; compact format; info bits 32\r\n 0: len 4; hex 00000002; asc     ;;\r\n 1: len 4; hex 00000002; asc     ;;\r\n*** WE ROLL BACK TRANSACTION (1)</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb66904450122-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb66904450122-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb66904450122-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb66904450122-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb66904450122-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb66904450122-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb66904450122-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb66904450122-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb66904450122-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb66904450122-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb66904450122-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb66904450122-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb66904450122-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb66904450122-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb66904450122-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb66904450122-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb66904450122-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb66904450122-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb66904450122-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb66904450122-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb66904450122-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb66904450122-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb66904450122-23\">23</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb66904450122-24\">24</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb66904450122-25\">25</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb66904450122-26\">26</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb66904450122-27\">27</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb66904450122-28\">28</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb66904450122-29\">29</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb66904450122-30\">30</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb66904450122-31\">31</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb66904450122-32\">32</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-58adaef89eb66904450122-1\"><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb66904450122-2\"><span class=\"crayon-e\">LATEST </span><span class=\"crayon-e\">DETECTED </span><span class=\"crayon-v\">DEADLOCK</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb66904450122-3\"><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb66904450122-4\"><span class=\"crayon-cn\">170219</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">13</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">31</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">31</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb66904450122-5\"><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">TRANSACTION</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb66904450122-6\"><span class=\"crayon-i\">TRANSACTION</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2A8BD</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">ACTIVE</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">11</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sec </span><span class=\"crayon-e\">starting </span><span class=\"crayon-e\">index </span><span class=\"crayon-e\">read</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb66904450122-7\"><span class=\"crayon-e\">mysql </span><span class=\"crayon-e\">tables </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">locked</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb66904450122-8\"><span class=\"crayon-e\">LOCK </span><span class=\"crayon-i\">WAIT</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">lock </span><span class=\"crayon-t\">struct</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">s</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">heap </span><span class=\"crayon-i\">size</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">376</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">row </span><span class=\"crayon-e\">lock</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">s</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb66904450122-9\"><span class=\"crayon-e\">MySQL </span><span class=\"crayon-e\">thread </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">448218</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">OS </span><span class=\"crayon-e\">thread </span><span class=\"crayon-i\">handle</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x2abe5fb5d700</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">query </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">18923238</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">renjun</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">fangcloud</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">net</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">121.41.41.92</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">root </span><span class=\"crayon-e\">updating</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb66904450122-10\"><span class=\"crayon-e\">delete </span><span class=\"crayon-e\">from </span><span class=\"crayon-e\">test </span><span class=\"crayon-i\">where</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">a</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb66904450122-11\"><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">WAITING </span><span class=\"crayon-st\">FOR</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">THIS</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">LOCK </span><span class=\"crayon-st\">TO</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">BE </span><span class=\"crayon-v\">GRANTED</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb66904450122-12\"><span class=\"crayon-e\">RECORD </span><span class=\"crayon-e\">LOCKS </span><span class=\"crayon-e\">space </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">page </span><span class=\"crayon-i\">no</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">923</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">n</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">bits</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">80</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">index</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">a</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">of </span><span class=\"crayon-i\">table</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">oauthdemo</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">test</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">trx </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2A8BD</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">lock</span><span class=\"crayon-sy\">_</span>mode<span class=\"crayon-h\"> </span><span class=\"crayon-i\">X</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">waiting</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb66904450122-13\"><span class=\"crayon-e\">Record </span><span class=\"crayon-v\">lock</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">heap </span><span class=\"crayon-i\">no</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">PHYSICAL </span><span class=\"crayon-v\">RECORD</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">n</span><span class=\"crayon-sy\">_</span>fields<span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">compact </span><span class=\"crayon-v\">format</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">info </span><span class=\"crayon-i\">bits</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">32</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb66904450122-14\"><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">len</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">hex</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">00000002</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">asc</span><span class=\"crayon-h\">     </span><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb66904450122-15\"><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">len</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">hex</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">00000002</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">asc</span><span class=\"crayon-h\">     </span><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb66904450122-16\"><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">TRANSACTION</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb66904450122-17\"><span class=\"crayon-i\">TRANSACTION</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2A8BC</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">ACTIVE</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">18</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sec </span><span class=\"crayon-e\">inserting</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb66904450122-18\"><span class=\"crayon-e\">mysql </span><span class=\"crayon-e\">tables </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">locked</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb66904450122-19\"><span class=\"crayon-cn\">4</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">lock </span><span class=\"crayon-t\">struct</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">s</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">heap </span><span class=\"crayon-i\">size</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1248</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">row </span><span class=\"crayon-e\">lock</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">s</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">undo </span><span class=\"crayon-e\">log </span><span class=\"crayon-i\">entries</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb66904450122-20\"><span class=\"crayon-e\">MySQL </span><span class=\"crayon-e\">thread </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">448217</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">OS </span><span class=\"crayon-e\">thread </span><span class=\"crayon-i\">handle</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x2abe5fd65700</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">query </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">18923239</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">renjun</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">fangcloud</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">net</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">121.41.41.92</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">root </span><span class=\"crayon-e\">update</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb66904450122-21\"><span class=\"crayon-e\">insert </span><span class=\"crayon-e\">into </span><span class=\"crayon-e\">test</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">id</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">a</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">values</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">10</span><span class=\"crayon-sy\">,</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb66904450122-22\"><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">HOLDS </span><span class=\"crayon-e\">THE </span><span class=\"crayon-e\">LOCK</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">S</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb66904450122-23\"><span class=\"crayon-e\">RECORD </span><span class=\"crayon-e\">LOCKS </span><span class=\"crayon-e\">space </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">page </span><span class=\"crayon-i\">no</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">923</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">n</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">bits</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">80</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">index</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">a</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">of </span><span class=\"crayon-i\">table</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">oauthdemo</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">test</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">trx </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2A8BC</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">lock</span><span class=\"crayon-sy\">_</span>mode<span class=\"crayon-h\"> </span><span class=\"crayon-i\">X</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">locks </span><span class=\"crayon-e\">rec </span><span class=\"crayon-e\">but </span><span class=\"crayon-st\">not</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">gap</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb66904450122-24\"><span class=\"crayon-e\">Record </span><span class=\"crayon-v\">lock</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">heap </span><span class=\"crayon-i\">no</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">PHYSICAL </span><span class=\"crayon-v\">RECORD</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">n</span><span class=\"crayon-sy\">_</span>fields<span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">compact </span><span class=\"crayon-v\">format</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">info </span><span class=\"crayon-i\">bits</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">32</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb66904450122-25\"><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">len</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">hex</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">00000002</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">asc</span><span class=\"crayon-h\">     </span><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb66904450122-26\"><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">len</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">hex</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">00000002</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">asc</span><span class=\"crayon-h\">     </span><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb66904450122-27\"><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">WAITING </span><span class=\"crayon-st\">FOR</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">THIS</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">LOCK </span><span class=\"crayon-st\">TO</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">BE </span><span class=\"crayon-v\">GRANTED</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb66904450122-28\"><span class=\"crayon-e\">RECORD </span><span class=\"crayon-e\">LOCKS </span><span class=\"crayon-e\">space </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">page </span><span class=\"crayon-i\">no</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">923</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">n</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">bits</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">80</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">index</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">a</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">of </span><span class=\"crayon-i\">table</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">oauthdemo</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">test</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">trx </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2A8BC</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">lock </span><span class=\"crayon-i\">mode</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">S</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">waiting</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb66904450122-29\"><span class=\"crayon-e\">Record </span><span class=\"crayon-v\">lock</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">heap </span><span class=\"crayon-i\">no</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">PHYSICAL </span><span class=\"crayon-v\">RECORD</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">n</span><span class=\"crayon-sy\">_</span>fields<span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">compact </span><span class=\"crayon-v\">format</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">info </span><span class=\"crayon-i\">bits</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">32</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb66904450122-30\"><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">len</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">hex</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">00000002</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">asc</span><span class=\"crayon-h\">     </span><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb66904450122-31\"><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">len</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">hex</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">00000002</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">asc</span><span class=\"crayon-h\">     </span><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb66904450122-32\"><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">WE </span><span class=\"crayon-e\">ROLL </span><span class=\"crayon-e\">BACK </span><span class=\"crayon-e\">TRANSACTION</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0122 seconds] -->\r\n<p></p>\n<h2 id=\"分析\">分析</h2>\n<h3 id=\"阅读死锁日志\">阅读死锁日志</h3>\n<p>遇到死锁，第一步就是阅读死锁日志。死锁日志通常分为两部分，上半部分说明了事务1在等待什么锁：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-58adaef89eb6a922688440\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n170219 13:31:31\r\n*** (1) TRANSACTION:\r\nTRANSACTION 2A8BD, ACTIVE 11 sec starting index read\r\nmysql tables in use 1, locked 1\r\nLOCK WAIT 2 lock struct(s), heap size 376, 1 row lock(s)\r\nMySQL thread id 448218, OS thread handle 0x2abe5fb5d700, query id 18923238 renjun.fangcloud.net 121.41.41.92 root updating\r\ndelete from test where a = 2\r\n*** (1) WAITING FOR THIS LOCK TO BE GRANTED:\r\nRECORD LOCKS space id 0 page no 923 n bits 80 index `a` of table `oauthdemo`.`test` trx id 2A8BD lock_mode X waiting\r\nRecord lock, heap no 3 PHYSICAL RECORD: n_fields 2; compact format; info bits 32\r\n 0: len 4; hex 00000002; asc     ;;\r\n 1: len 4; hex 00000002; asc     ;;</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb6a922688440-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb6a922688440-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb6a922688440-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb6a922688440-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb6a922688440-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb6a922688440-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb6a922688440-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb6a922688440-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb6a922688440-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb6a922688440-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb6a922688440-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb6a922688440-12\">12</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-58adaef89eb6a922688440-1\"><span class=\"crayon-cn\">170219</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">13</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">31</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">31</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb6a922688440-2\"><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">TRANSACTION</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb6a922688440-3\"><span class=\"crayon-i\">TRANSACTION</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2A8BD</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">ACTIVE</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">11</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sec </span><span class=\"crayon-e\">starting </span><span class=\"crayon-e\">index </span><span class=\"crayon-e\">read</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb6a922688440-4\"><span class=\"crayon-e\">mysql </span><span class=\"crayon-e\">tables </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">locked</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb6a922688440-5\"><span class=\"crayon-e\">LOCK </span><span class=\"crayon-i\">WAIT</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">lock </span><span class=\"crayon-t\">struct</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">s</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">heap </span><span class=\"crayon-i\">size</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">376</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">row </span><span class=\"crayon-e\">lock</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">s</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb6a922688440-6\"><span class=\"crayon-e\">MySQL </span><span class=\"crayon-e\">thread </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">448218</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">OS </span><span class=\"crayon-e\">thread </span><span class=\"crayon-i\">handle</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x2abe5fb5d700</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">query </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">18923238</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">renjun</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">fangcloud</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">net</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">121.41.41.92</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">root </span><span class=\"crayon-e\">updating</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb6a922688440-7\"><span class=\"crayon-e\">delete </span><span class=\"crayon-e\">from </span><span class=\"crayon-e\">test </span><span class=\"crayon-i\">where</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">a</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb6a922688440-8\"><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">WAITING </span><span class=\"crayon-st\">FOR</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">THIS</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">LOCK </span><span class=\"crayon-st\">TO</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">BE </span><span class=\"crayon-v\">GRANTED</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb6a922688440-9\"><span class=\"crayon-e\">RECORD </span><span class=\"crayon-e\">LOCKS </span><span class=\"crayon-e\">space </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">page </span><span class=\"crayon-i\">no</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">923</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">n</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">bits</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">80</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">index</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">a</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">of </span><span class=\"crayon-i\">table</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">oauthdemo</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">test</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">trx </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2A8BD</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">lock</span><span class=\"crayon-sy\">_</span>mode<span class=\"crayon-h\"> </span><span class=\"crayon-i\">X</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">waiting</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb6a922688440-10\"><span class=\"crayon-e\">Record </span><span class=\"crayon-v\">lock</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">heap </span><span class=\"crayon-i\">no</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">PHYSICAL </span><span class=\"crayon-v\">RECORD</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">n</span><span class=\"crayon-sy\">_</span>fields<span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">compact </span><span class=\"crayon-v\">format</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">info </span><span class=\"crayon-i\">bits</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">32</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb6a922688440-11\"><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">len</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">hex</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">00000002</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">asc</span><span class=\"crayon-h\">     </span><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb6a922688440-12\"><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">len</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">hex</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">00000002</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">asc</span><span class=\"crayon-h\">     </span><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0049 seconds] -->\r\n<p>从日志里我们可以看到事务1当前正在执行<code>delete from test where a = 2</code>，该条语句正在申请索引a的X锁，所以提示<code>lock_mode X waiting</code>。</p>\n<p>然后日志的下半部分说明了事务2当前持有的锁以及等待的锁：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-58adaef89eb6e557002480\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n*** (2) TRANSACTION:\r\nTRANSACTION 2A8BC, ACTIVE 18 sec inserting\r\nmysql tables in use 1, locked 1\r\n4 lock struct(s), heap size 1248, 3 row lock(s), undo log entries 2\r\nMySQL thread id 448217, OS thread handle 0x2abe5fd65700, query id 18923239 renjun.fangcloud.net 121.41.41.92 root update\r\ninsert into test (id,a) values (10,2)\r\n*** (2) HOLDS THE LOCK(S):\r\nRECORD LOCKS space id 0 page no 923 n bits 80 index `a` of table `oauthdemo`.`test` trx id 2A8BC lock_mode X locks rec but not gap\r\nRecord lock, heap no 3 PHYSICAL RECORD: n_fields 2; compact format; info bits 32\r\n 0: len 4; hex 00000002; asc     ;;\r\n 1: len 4; hex 00000002; asc     ;;\r\n*** (2) WAITING FOR THIS LOCK TO BE GRANTED:\r\nRECORD LOCKS space id 0 page no 923 n bits 80 index `a` of table `oauthdemo`.`test` trx id 2A8BC lock mode S waiting\r\nRecord lock, heap no 3 PHYSICAL RECORD: n_fields 2; compact format; info bits 32\r\n 0: len 4; hex 00000002; asc     ;;\r\n 1: len 4; hex 00000002; asc     ;;</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb6e557002480-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb6e557002480-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb6e557002480-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb6e557002480-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb6e557002480-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb6e557002480-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb6e557002480-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb6e557002480-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb6e557002480-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb6e557002480-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb6e557002480-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb6e557002480-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb6e557002480-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb6e557002480-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-58adaef89eb6e557002480-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaef89eb6e557002480-16\">16</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-58adaef89eb6e557002480-1\"><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">TRANSACTION</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb6e557002480-2\"><span class=\"crayon-i\">TRANSACTION</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2A8BC</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">ACTIVE</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">18</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sec </span><span class=\"crayon-e\">inserting</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb6e557002480-3\"><span class=\"crayon-e\">mysql </span><span class=\"crayon-e\">tables </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">locked</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb6e557002480-4\"><span class=\"crayon-cn\">4</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">lock </span><span class=\"crayon-t\">struct</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">s</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">heap </span><span class=\"crayon-i\">size</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1248</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">row </span><span class=\"crayon-e\">lock</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">s</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">undo </span><span class=\"crayon-e\">log </span><span class=\"crayon-i\">entries</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb6e557002480-5\"><span class=\"crayon-e\">MySQL </span><span class=\"crayon-e\">thread </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">448217</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">OS </span><span class=\"crayon-e\">thread </span><span class=\"crayon-i\">handle</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x2abe5fd65700</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">query </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">18923239</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">renjun</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">fangcloud</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">net</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">121.41.41.92</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">root </span><span class=\"crayon-e\">update</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb6e557002480-6\"><span class=\"crayon-e\">insert </span><span class=\"crayon-e\">into </span><span class=\"crayon-e\">test</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">id</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">a</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">values</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">10</span><span class=\"crayon-sy\">,</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb6e557002480-7\"><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">HOLDS </span><span class=\"crayon-e\">THE </span><span class=\"crayon-e\">LOCK</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">S</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb6e557002480-8\"><span class=\"crayon-e\">RECORD </span><span class=\"crayon-e\">LOCKS </span><span class=\"crayon-e\">space </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">page </span><span class=\"crayon-i\">no</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">923</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">n</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">bits</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">80</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">index</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">a</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">of </span><span class=\"crayon-i\">table</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">oauthdemo</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">test</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">trx </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2A8BC</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">lock</span><span class=\"crayon-sy\">_</span>mode<span class=\"crayon-h\"> </span><span class=\"crayon-i\">X</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">locks </span><span class=\"crayon-e\">rec </span><span class=\"crayon-e\">but </span><span class=\"crayon-st\">not</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">gap</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb6e557002480-9\"><span class=\"crayon-e\">Record </span><span class=\"crayon-v\">lock</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">heap </span><span class=\"crayon-i\">no</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">PHYSICAL </span><span class=\"crayon-v\">RECORD</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">n</span><span class=\"crayon-sy\">_</span>fields<span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">compact </span><span class=\"crayon-v\">format</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">info </span><span class=\"crayon-i\">bits</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">32</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb6e557002480-10\"><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">len</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">hex</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">00000002</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">asc</span><span class=\"crayon-h\">     </span><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb6e557002480-11\"><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">len</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">hex</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">00000002</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">asc</span><span class=\"crayon-h\">     </span><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb6e557002480-12\"><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">WAITING </span><span class=\"crayon-st\">FOR</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">THIS</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">LOCK </span><span class=\"crayon-st\">TO</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">BE </span><span class=\"crayon-v\">GRANTED</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb6e557002480-13\"><span class=\"crayon-e\">RECORD </span><span class=\"crayon-e\">LOCKS </span><span class=\"crayon-e\">space </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">page </span><span class=\"crayon-i\">no</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">923</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">n</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">bits</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">80</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">index</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">a</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">of </span><span class=\"crayon-i\">table</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">oauthdemo</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">test</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">trx </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2A8BC</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">lock </span><span class=\"crayon-i\">mode</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">S</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">waiting</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb6e557002480-14\"><span class=\"crayon-e\">Record </span><span class=\"crayon-v\">lock</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">heap </span><span class=\"crayon-i\">no</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">PHYSICAL </span><span class=\"crayon-v\">RECORD</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">n</span><span class=\"crayon-sy\">_</span>fields<span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">compact </span><span class=\"crayon-v\">format</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">info </span><span class=\"crayon-i\">bits</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">32</span></div><div class=\"crayon-line\" id=\"crayon-58adaef89eb6e557002480-15\"><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">len</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">hex</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">00000002</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">asc</span><span class=\"crayon-h\">     </span><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaef89eb6e557002480-16\"><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">len</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">hex</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">00000002</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">asc</span><span class=\"crayon-h\">     </span><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0067 seconds] -->\r\n<p>从日志的<code>HOLDS THE LOCKS(S)</code>块中我们可以看到事务2持有索引a的X锁，并且是记录锁（Record Lock）。该锁是通过事务2在步骤2执行的delete语句申请的。由于是RR隔离模式下的基于唯一索引的等值查询（Where a = 2），所以会申请一个记录锁，而非next-key锁。</p>\n<p>从日志的<code>WAITING FOR THIS LOCK TO BE GRANTED</code>块中我们可以看到事务2正在申请S锁，也就是共享锁。该锁是<code>insert into test (id,a) values (10,2)</code>语句申请的。<strong>insert语句在普通情况下是会申请排他锁，也就是X锁，但是这里出现了S锁。这是因为a字段是一个唯一索引，所以insert语句会在插入前进行一次duplicate key的检查，为了使这次检查成功，需要申请S锁防止其他事务对a字段进行修改。</strong></p>\n<p>那么为什么该S锁会失败呢？这是<strong>对同一个字段的锁的申请是需要排队的</strong>。S锁前面还有一个未申请成功的X锁，所以S锁必须等待，所以形成了循环等待，死锁出现了。</p>\n<p>通过阅读死锁日志，我们可以清楚地知道两个事务形成了怎样的循环等待，再加以分析，就可以逆向推断出循环等待的成因，也就是死锁形成的原因。</p>\n<h3 id=\"死锁形成流程图\">死锁形成流程图</h3>\n<p>为了让大家更好地理解死锁形成的原因，我们再通过表格的形式阐述死锁形成的流程：</p>\n<table>\n<thead>\n<tr>\n<th>步骤</th>\n<th>事务1</th>\n<th>事务2</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td></td>\n<td>begin</td>\n</tr>\n<tr>\n<td>2</td>\n<td></td>\n<td>delete from test where a = 2; 执行成功，事务2占有a=2下的X锁，类型为记录锁。</td>\n</tr>\n<tr>\n<td>3</td>\n<td>begin</td>\n<td></td>\n</tr>\n<tr>\n<td>4</td>\n<td>delete from test where a = 2; 事务1希望申请a=2下的X锁，但是由于事务2已经申请了一把X锁，两把X锁互斥，所以X锁申请进入锁请求队列。</td>\n<td></td>\n</tr>\n<tr>\n<td>5</td>\n<td>出现死锁，事务1权重较小，所以被选择回滚（成为牺牲品）。</td>\n<td>insert into test (id, a) values (10, 2); 由于a字段建立了唯一索引，所以需要申请S锁以便检查duplicate key，由于插入的a的值还是2，所以排在X锁后面。但是前面的X锁的申请只有在事务2commit或者rollback之后才能成功，此时形成了循环等待，死锁产生。</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"拓展\">拓展</h2>\n<p>在排查死锁的过程中，有个同事还发现了上述场景会产生另一种死锁，该场景无法通过手工复现，只有高并发场景下才有可能复现。</p>\n<p>该死锁对应的日志这里就不贴出了，与上一个死锁的核心差别是事务2等待的锁从S锁换成了X锁，也就是<code>lock_mode X locks gap before rec insert intention waiting</code>。我们还是通过表格来详细说明该死锁产生的流程：</p>\n<table>\n<thead>\n<tr>\n<th>步骤</th>\n<th>事务1</th>\n<th>事务2</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td></td>\n<td>begin</td>\n</tr>\n<tr>\n<td>2</td>\n<td></td>\n<td>delete from test where a = 2; 执行成功，事务2占有a=2下的X锁，类型为记录锁。</td>\n</tr>\n<tr>\n<td>3</td>\n<td>begin</td>\n<td></td>\n</tr>\n<tr>\n<td>4</td>\n<td></td>\n<td>【insert第1阶段】insert into test (id, a) values (10, 2); 事务2申请S锁进行duplicate key进行检查。检查成功。</td>\n</tr>\n<tr>\n<td>5</td>\n<td>delete from test where a = 2; 事务1希望申请a=2下的X锁，但是由于事务2已经申请了一把X锁，两把X锁互斥，所以X锁申请进入锁请求队列。</td>\n<td></td>\n</tr>\n<tr>\n<td>6</td>\n<td>出现死锁，事务1权重较小，所以被选择回滚（成为牺牲品）。</td>\n<td>【insert第2阶段】insert into test (id, a) values (10, 2); 事务2开始插入数据，S锁升级为X锁，类型为insert intention。同理，X锁进入队列排队，形成循环等待，死锁产生。</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"总结\">总结</h2>\n<p>排查死锁时，首先需要根据死锁日志分析循环等待的场景，然后根据当前各个事务执行的SQL分析出加锁类型以及顺序，逆向推断出如何形成循环等待，这样就能找到死锁产生的原因了。</p>\n<p>PS：<strong>上述分析都是基于经验的推断，希望其他小伙伴们能够指出当中的错误以及不足指出，谢谢！</strong></p>\n<h2 id=\"参考资料\">参考资料</h2>\n<ul>\n<li><a href=\"http://hedengcheng.com/?p=844\" target=\"_blank\" rel=\"external\">【强推】一个最不可思议的Mysql死锁分析</a></li>\n<li><a href=\"http://hedengcheng.com/?p=771\" target=\"_blank\" rel=\"external\">【强推】Mysql加锁处理分析</a></li>\n<li><a href=\"http://mysqllover.com/?p=411\" target=\"_blank\" rel=\"external\">Innodb锁系统之如何阅读死锁日志</a></li>\n<li><a href=\"http://mysqllover.com/?p=431\" target=\"_blank\" rel=\"external\">源码分析insert和delete操作的加锁</a></li>\n<li><a href=\"https://yq.aliyun.com/articles/40995\" target=\"_blank\" rel=\"external\">Innodb锁相关源码翻译</a></li>\n</ul>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"110301\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"110301votetotal\">2</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"110301\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 1 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2017/01/fd55072c4453d994a449853a84b78164.png"], "tags": "IT技术,MySQL,数据库,死锁", "url_object_id": "bf04f23149a8d62e4dba862cba6ce876", "title": "记录一次 MySQL 死锁排查过程", "comment_nums": 0, "front_image_path": "full/0680fd15f05a124d6ac8e95b032713d8839b6c92.jpg", "create_date": "2017/02/20"}
{"url": "http://blog.jobbole.com/110321/", "praise_nums": "3", "fav_nums": 4, "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"><p><script src=\"http://www.imooc.com/open/courselistrandjs\"></script><span style=\"display:block;margin-bottom:10px;\"></span></p>\n</div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a ref=\"nofollow\" target=\"_blank\" href=\"https://www.fossmint.com/greatest-programmers-of-all-time/\">fossmint</a>   译文出处：<a target=\"_blank\" href=\"https://my.oschina.net/editorial-story/blog/843053\">开源中国/局长</a>   </div><p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/3ea76645860b9c9fa75de2f515960e2b.png\" alt=\"\" width=\"650\" height=\"302\"></p>\n<p>我们常常会把那些贡献者为使我们生活变得更便利而做出的贡献看作是理所当然的，与那些给我们带来帮助的人相比，上天似乎有一种方式使得它给那些为我们带来娱乐的人的奖励要比前者更多。不过这没关系，我们知道该如何向那些带领着我们程序员和技术爱好者前进的人们致敬。</p>\n<p>在这篇文章里面，我们将会看到 12 位空前最伟大的程序员（排名不分先后），下面就开始吧！</p>\n<h3>1. Dennis Ritchie</h3>\n<p>Dennis MacAlistair Ritchie<strong>，</strong>也被称为 “dmr”（这是他在贝尔实验室的用户名称），是 C 语言之父。C 语言已发展成为被最广泛使用的编程语言之一。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/70a3d3a1d0cc7f5f59a4f95c955204fe.jpg\" alt=\"\" width=\"650\" height=\"325\"></p>\n<p>他是世界上最重要的计算机科学家之一，而且他也因为对 “数字时代” 所做的巨大贡献而广受赞誉。UNIX 操作系统，现在是 Mac OS X 等知名操作系统的核心，由 Dennis 和与他长期共事的 Ken Thompson 开发<strong>。</strong></p>\n<p>他们于 1983 年获得了由美国计算机协会颁发的图灵奖。在 1990 年，他们还获得了 IEEE 的 Hamming Medal，并于 1999 年获得了由克林顿总统颁发的国家技术奖。Dennis 在 2007 年退休，退休前担任朗讯技术公司系统软件研究部门的领导人职位。</p>\n<h3>2. Bjarne Stroustrup</h3>\n<p>1978 年，Bjarne Stroustrup 开发了另一门被广泛使用的编程语言，称作 C++。他是一位著名的研究教授并担任着许多重要的职位，包括摩根士丹利技术部门的常务董事、哥伦比亚大学计算机科学系客座教授以及德州农工大学 “杰出教授”。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/a1403e07d78dcdf302bf2fd63f8c86b0.jpg\" alt=\"\" width=\"650\" height=\"306\"></p>\n<p>他曾获得许多奖项，并创作了很多著名的书籍，包括 <em>A tour of C++，C++程序设计原理与实践，C++ 程序设计语言，C++语言的设计和演化</em> 等。</p>\n<h3>3. James Gosling</h3>\n<p>James Arthur Gosling 是加拿大的计算机科学家，也是公认的 Java 之父。各种软件系统，如 NeWS 和Gosling Emacs 的成功都归功于他的贡献。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/8d5b1fc7f993af63a95b18a0c0d02d5e.jpg\" alt=\"\" width=\"650\" height=\"306\"></p>\n<p>因为他的显着成就，被当选为美国国家工程院的外籍会员。</p>\n<h3>4. Linus Torvalds</h3>\n<p>Linus Benedict Torvalds 是出生于芬兰的美国软件工程师，在 1991 年开发了 Linux，并担任 Linux 内核项目的首席架构师与项目协调者。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/2a5e858c8c601aaba7bb5191ac1f3495.jpg\" alt=\"\" width=\"650\" height=\"306\"></p>\n<p>他还负责创造了版本控制系统 “Git” 和日志分割软件 “Subsurface”。由于他为计算机创造的开源操作系统，使得 Linux 内核被广泛使用，他也被 Technology Academy of Finland 和 Shinya Yanamaka 授予 2012 千禧年技术奖。</p>\n<h3>5. Anders Hejlsberg</h3>\n<p>Anders Hejlsberg，Turbo Pascal 的作者和 Delphi 的首席架构师，是编程语言 C# 的开发人员。他是一位著名的丹麦软件工程师，负责协同设计其他成功的编程语言和开发工具。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/de25f86ec0b6196a7fac3af4003ae7f2.jpg\" alt=\"\" width=\"650\" height=\"306\"></p>\n<p>目前他是 C# 的首席架构师和微软 Typescript 的核心开发人员。</p>\n<h3>6. Tim Berners-Lee</h3>\n<p>Tim Berners-Lee，也被称为 TimBL，是一位英国计算机科学家，他因发明万维网而闻名。</p>\n<p>在他于 1989 年 3 月为一个信息管理系统提出了建议之后，他通过互联网使用超文本传输协议（HTTP）实现了客户端 PC 和服务器之间的第一次通信，这一切都非常成功。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/c15ab6d053947a810f2145638b93584a.jpg\" alt=\"\" width=\"650\" height=\"306\"></p>\n<p>他是万维网联盟（W3C）的主席，该组织负责监督 Web 的持续发展。</p>\n<h3>7. Brian Kernighan</h3>\n<p>Brian Wilson Kernighan 是一位加拿大计算机科学家。在贝尔实验室，他与 Unix 的创造者 Ken Thompson 以及 Dennis Ritchie<strong> </strong>一起工作，同时他也是开发 Unix 的主要贡献者。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/e7b3d1c0e9f76f03fb977d737e28d240.jpg\" alt=\"\" width=\"650\" height=\"306\"></p>\n<p>他在与 Ritchie<strong> </strong>共同创作<em> C 程序设计语言 </em>一书后变得知名，还曾经合作编写 AWK 和 AMPL 编程语言。</p>\n<h3>8. Ken Thompson</h3>\n<p>Kenneth Thompson 是美国计算机科学的先驱，与 Dennis Ritchie 合作开发了 UNIX 操作系统。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/b0fa64a7a62b473b24620db565f8f8e7.jpg\" alt=\"\" width=\"650\" height=\"306\"></p>\n<p>他大部分的职业生涯是在贝尔实验室工作，在这期间他开发了 B 编程语言，也是 C 语言的主创者。</p>\n<p>他是 Plan 9 OS 的早期开发人员。在黑客圈中他被称为Ken，还在他从 2006 年开始工作的谷歌，与其他人共同开发了 Go 编程语言。</p>\n<h3>9. Guido Van Rossum</h3>\n<p>当谈到 Python 时，Guido Van Rossum 总会被提到。他是荷兰计算机科学家，负责独自创作 Python 语言。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/73ec9dde22b348a1829b92893a525aea.jpg\" alt=\"\" width=\"650\" height=\"306\"></p>\n<p>在 Python 社区，Guido Van Rossum 被人们认为是 “仁慈的独裁者（BDFL）”，因为他仍然关注并监督着 Python 的开发进程，并在必要的时刻做出决策。</p>\n<p>从 2005 年到 2012 年，他在谷歌工作，在那里他负责开发 Python 编程语言，然后在 2013 年离开谷歌在 Dropbox 工作。</p>\n<h3>10. Donald Knuth</h3>\n<p>Donald Ervin Knuth，经常被称为算法分析之父，是美国计算机科学家，数学家和斯坦福大学荣誉教授。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/6a4dd2f7675e030856aa6f6eb7f8612c.jpg\" alt=\"\" width=\"650\" height=\"306\"></p>\n<p>他于 1974 年获得图灵奖，最为人知的事迹就是他是 <em>计算机程序设计艺术 </em>一书的作者。他的成就之一是对算法的计算复杂性的深入分析及其系统化形式的数学技术，还有 TEX 排版软件和 METAFONT 字型设计软件等。</p>\n<p>值得一提的是，他还是开源代码运动最早的倡导者之一。事实上，如果没有 Donald Knuth 编程界将不会出现今天这么好的发展。</p>\n<h3>11. Richard Stallman</h3>\n<p>Richard Matthew Stallman 是最知名的自由软件爱好者和活动家，一直致力于推动用户享有学习，修改和分发软件的权利。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/676d2292620702a8243d682ac0adfd75.jpg\" alt=\"\" width=\"650\" height=\"306\"></p>\n<p>他是 GNU 项目的创始人，目标是创建一套完全自由的操作系统，后来还建立了自由软件基金会以协助 GNU 计划。他也是 GNU Emacs 的开发者。</p>\n<p>他对版权法发展的影响力巨大，特别是在涉及自由软件权利和许可的地方，最著名的是通用公共许可证（GPL）。</p>\n<h3>12. Larry Wall</h3>\n<p>Larry Wall 因两件事而闻名，作为 Perl 编程语言之父和一位讽刺的语言学家。他也是自由软件的冠军，而且他在这方面的成就已被自由软件基金会认可，并于 1998 年获得第一届自由软件奖（Free Software award）。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/57d5c8cd69b8b147eb818f2c5779bf87.jpg\" alt=\"\" width=\"650\" height=\"306\"></p>\n<p>他在自然和人工语言方面的训练背景使得他非常适合编写 Perl 编程语言相关的书籍，他是 Programming Perl（通常被称为 ”骆驼书”）的共同作者之一，也著有 Perl Cookbook 一书。</p>\n<p>BTW，“好的程序员有 3 种美德： 懒惰、急躁和傲慢（Laziness, Impatience and hubris） ” 这句话正是出自这位大牛。</p>\n<p>要介绍的大牛已经介绍完了。如果编程世界是希腊神话，那么这些人都是计算机世界的神。</p>\n<p>希望你能喜欢这篇文章，如果认为这份名单上错过了谁或是有其他问题，随意在评论区与我们分享您的想法。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"110321\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"110321votetotal\">3</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"110321\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 4 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i> 1 评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2017/02/3ea76645860b9c9fa75de2f515960e2b.png"], "tags": "职场,程序员", "url_object_id": "ba76688af4d377136b38e665e6988227", "title": "编程界 12 位祖师爷级别的 “大牛”", "comment_nums": 1, "front_image_path": "full/f8f14a26249aeab5e9a86fc94b58cc506a6bac91.jpg", "create_date": "2017/02/22"}
{"url": "http://blog.jobbole.com/110272/", "praise_nums": "2", "fav_nums": 3, "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"><p><script src=\"http://www.imooc.com/open/courselistrandjs\"></script><span style=\"display:block;margin-bottom:10px;\"></span></p>\n</div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a target=\"_blank\" href=\"http://www.cnblogs.com/catch/p/6370859.html\">twoon</a>   </div><div id=\"cnblogs_post_body\">\n<p>前段时间业务反映某类服务器上更新了 bash 之后，ssh 连上去偶发登陆失败，客户端吐出错误信息如下所示：</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/d84b7cc8abe8f00cb43e7935a7c6180e.png\"></p>\n<p>该版本 bash 为部门这边所定制，但实现上并没有改动原有逻辑，只是加入了些监控功能，那么这些错误从哪里来？</p>\n<h2 id=\"是-bash-的锅吗\">是 bash 的锅吗</h2>\n<p>从上面的错误信息可以猜测，异常是 bash 在启动过程中分配内存失败所导致，看起来像是某些情况下该进程错误地进行了大量内存分配，最后导致内存不足，要确认这个事情比较简单，动态内存分配到系统调用这一层上主要就两种方式： brk() 和 mmap(), 所以只要统计一下这两者的调用就可以大概估算出是否有大内存分配了。</p>\n<p>bash 是由 sshd 启动的，于是 strace 跟踪了一下 sshd 进程，结果发现异常发生时，bash 分配的内存非常地少，少到有时甚至只有几十字节也会失败，几乎可以断定 bash 在内存使用上没有异常，但在这期间发现一个诡异的现象，Bash 一直只用 brk 在分配小内存，brk() 失败后就直接退出了，一般程序使用的 libc 中的 malloc (或其它类似的 malloc) 会结合 brk 和 mmap 一起使用【0】，不至于 brk 一失败就分配不到内存，顺手查看了下 bash 的源码，发现它确实基于 brk 做了自己的内存管理，并没有使用 malloc 或 mmap。</p>\n<p>但那并不是重点，重点是即使是只使用 brk，也不至于只能分配几十字节的内存。</p>\n<h2 id=\"进程的内存布局\">进程的内存布局</h2>\n<p>进程的内存布局在结构上是有规律的，具体来说对于 linux 系统上的进程，其内存空间一般可以粗略地分为以下几大段【1】，从高内存到低内存排列：<br>\n1、内核态内存空间，其大小一般比较固定（可以编译时调整），但 32 位系统和 64 位系统的值不一样。<br>\n2、用户态的堆栈，大小不固定，可以用 ulimit -s 进行调整，默认一般为 8M，从高地址向低地址增长。<br>\n3、mmap 区域，进程茫茫内存空间里的主要部分，既可以从高地址到低地址延伸(所谓 flexible layout)，也可以从低到高延伸(所谓 legacy layout)，看进程具体情况【2】【3】。<br>\n4、brk 区域，紧邻数据段(甚至贴着)，从低位向高位伸展，但它的大小主要取决于 mmap 如何增长，一般来说，即使是 32 位的进程以传统方式延伸，也有差不多 1 GB 的空间（准确地说是 TASK_SIZE/3 – 代码段数据段，参看 arch/x86/include/asm/processor.h 里宏 TASK_UNMAPPED_BASE 的定义)【4】<br>\n5、数据段，主要是进程里初始化和未初始化的全局数据总和，当然还有编译器生成一些辅助数据结构等等)，大小取决于具体进程，其位置紧贴着代码段。<br>\n6、代码段，主要是进程的指令，包括用户代码和编译器生成的辅助代码，其大小取决于具体程序，但起始位置根据 32 位还是 64 位一般固定(-fPIC, -fPIE等除外【5】)。</p>\n<p>以上各段(除了代码段数据段)其起始位置根据系统是否起用 randomize_va_space 一般稍有变化，各段之间因此可能有随机大小的间隔，千言万语不如一幅图：</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/5c4d3bf1f56b5973e94dedfcc2cf2906.png\"></p>\n<p>所以现在的问题归结为：为什么目标进程的 brk 的区域突然那么小了，先检查一下 bash 的内存布局：</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/536c5bfc9554e0175da75e9bb130d178.png\"></p>\n<p>这个进程的内存布局和一般理解上有很大出入，从上往下是低内存到高内存：<br>\n<code>#1</code> 处为进程的代码段和数据段，这两个区域一般处于进程内存空间的最低处，但现在在更低处明显有动态库被映射了进来。<br>\n<code>#2</code> 处为 brk 的区域，该区域还算紧临着数据段，但是，brk 与代码段之间也被插入了动态库，而且更要命的是，brk 区域向高处伸展的方向上，动态库映射的区域贴的很近，导致 brk 的区域事实上只有很小一个空间(0x886000 – 0x7ac000)。</p>\n<p>这并不是我们想要的内存布局，我们想要的应该是长成下面这样的：</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/4bd5ea19321d97e0131cb70810a5e907.png\"></p>\n<p>看出来不同了没有，两个 bash 进程都是 64 位的，不同在于前者是 sshd 起的进程后者是我手动在终端上起起来的，手动 cat /proc/self/maps 看了下 64 位的 cat 的进程的内存布局也是正常的：</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/67eed23e6c7d6785102261c3924dd8cd.png\"></p>\n<p>那 sshd 进程呢？<br>\n<img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/4d9c524d4eb84ac49f8f9deff7536b83.png\"></p>\n<p>sshd 进程也不正常，而且意外发现 sshd 是 32 位的，于是写了个测试程序：</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/e8556f0eb6844b8542466052adddf0e7.png\"></p>\n<p>该程序编译为 32 位在目标机器上可以重现问题，而如果编译为 64 位则一切正常，另一个发现是只要是 32 位的进程，它们的内存布局都”不正常”。</p>\n<h2 id=\"操作系统的锅吗\">操作系统的锅吗？</h2>\n<p>要搞清楚这个问题得先搞明白进程在内核里启动的流程，对用户态的进程来说，任何进程都是从母进程 fork 出来后再执行 execve， execv 则主要调用对应的加载器(主要是 elf loader)来把代码段、数据段以及动态连接器(ld.so，如果需要)加载进内存空间的各个相应位置，完成之后直接跳到动态连接器的入口(这里先忽略静态链接的程序)，其它的动态库都由动态库连接器负责加载，需要注意的是，无论是内核加载 ld.so 还是 ld.so 加载其它动态库，都需要 mmap 的协助，这是用来在内存空间里找位置用的。</p>\n<p>现在我们来看看内核出了什么问题，目标系统版本如下，经过咨询系统组的人确认，该系统基于 centos 6.5: <a href=\"http://vault.centos.org/6.5/centosplus/Source/SPackages/kernel-2.6.32-431.el6.centos.plus.src.rpm\">http://vault.centos.org/6.5/centosplus/Source/SPackages/kernel-2.6.32-431.el6.centos.plus.src.rpm</a></p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/5d6a63002e7ca2a459522b90f2698286.png\"></p>\n<p>首先看看 arch/x86/mm/mmap.c: arch_pick_mmap_layout() 这个函数，它的作用是根据进程和当前系统的设置初化 mmap 相关的入口：</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/3c3cabcc5e08d4f251f6c5eda8fc97a9.png\"></p>\n<p>Exec-shield 是一类安全功能的开关，由红帽在很多年前主导搞的对 buffer overflow 攻击的一系列增强，具体可以参看这几个连接 <a href=\"https://lwn.net/Articles/31032/\">1</a>、<a href=\"http://people.redhat.com/mingo/exec-shield/docs/WHP0006US_Execshield.pdf\">2</a>，<a href=\"https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/5/html/Deployment_Guide/s3-proc-sys-kernel.html\">3</a>，<a href=\"https://lists.gnu.org/archive/html/gcl-devel/2003-11/msg00167.html\">4</a>，exec shield 在实现和使用上一直有问题，也破坏了有些旧程序的兼容性【6】，因此一直没进主干，只在 redhat 家族 6.x 及其派生系统上使用。</p>\n<p>这个功能有一个开关 /proc/sys/kernel/exec-shield，根据链接【6】上的说明，exec-shield 可以设置为 0、1、2、3，分别表示：强制关闭/默认关闭除非可执行程序指定打开/默认打开除非可执行程序指定关闭/强制打开。</p>\n<p>mm-&gt;get_unmapped_area 是进程需要进行 mmap 时调用的最终函数， arch_get_unmap_area() 用来以传统方式从低位开始搜索合适的位置，arch_get_unmapped_area_topdown() 则以 flexible layout 的方式从高位开始搜索合适的位置，关键点在于 125 ~ 129 行，exec-shield 引进了另一种专门针对 32 位进程的内存分配方式，这种方式指定如果要分配的内存需要可执行权限，那么应该从 mm-&gt;shlib_base 这里开始搜索合适的位置，shlib_base 的值为 SHLIB_BASE 加上一个小的随机偏移，而 SHLIB_BASE 的值为【7】:<br>\n<img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/d4d3581541c0b8744b9aa54c51278ea0.png\"></p>\n<p>注意到该地址位于 32 位进程的代码段之前(0x8048000)，所以这就解释了为什么 32 位的进程，它的动态库被加载到了低位甚至穿插进了 brk 和数据段之间的空隙，本来这个特殊的搜索内存空间的方式是只针对需要可执行权限的内存，但由于 elf 加载器在加载动态库时是分段(PT_LOAD)进行加载【8】，第一个段的位置由 mm-&gt;get_unmap_area() 搜索合适的位置分配，后续的段则使用 MAP_FIXED 强制放在了第一个段的后面，所以导致数据段也映射到了低位.【9】</p>\n<p>下图 1641 行展示了 mmap 时怎样从 mm 结构里获取 get_area 函数，可以看到，只要 mm-&gt;get_unmmapped_exec_area 不为空，且要分配的内存需要可执行权限，就优先使用 mm-&gt;get_unmmapped_exec_area 进行搜索。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/adf71a07d878e8e3bf8090a47396e08a.png\"></p>\n<p>上面这种针对 exec 内存的分配方式实际上很容易引起冲突，redhat 在这里也是打了不少补丁，参看<a href=\"https://patchwork.ozlabs.org/patch/42996/\">1</a>，<a href=\"https://lwn.net/Articles/372580/\">2</a>，<a href=\"http://seclists.org/dailydave/2007/q2/107\">3</a>。</p>\n<h2 id=\"问题并没有解决\">问题并没有解决</h2>\n<p>上面的解释说明了为什么 32 位进程的内存布局会异常，但是这里的问题是，为什么用 32 位进程起 64 位进程时，64 位的进程也同样受到了影响。要搞清楚这里的问题，就得看看 fs/binfmt_elf.c: load_elf_binary() 这个函数，它用来在当前进程中加载 elf 格式可执行文件并跳过去执行，此函数被 32 位的 elf 与 64 位 elf 所共用(借助了比较隐蔽的宏)，它做的事情总结起来包括如下：<br>\n1、读取和解析 elf 文件里包含的各种信息，关键信息如代码段，数据段，动态链接器等。<br>\n2、flush_old_exec()： 停止当前进程内的所有线程，清空当前内存空间，重置各种状态等。<br>\n3、设置新进程的状态，如分配内存空间，初始化等。<br>\n4、加载动态连接器并跳过去执行。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/ea526e419fce616aca145288f9807c1b.png\"></p>\n<p>现在回到我们问题，当前进程是 32 位的，在 64 位的系统上执行 32 位的进程需要内核支持，当内核发现 elf 是 32 位的程序时，会在 task 内部置一个标志，这个标志在上图 load_elf_binary() 函数里 740 行调用 SET_PERSONALITY() 才会被清除，所以在 721 行时，当前进程仍认为自己是 32 位的，flush_old_exec() 做了什么事情呢，参看：fs/exec.c: flush_old_exec()</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/5fb19d4a9cf3c45a6d6cfc81d2e8e010.png\"></p>\n<p>注意其中 1039 行，bprm-&gt;mm 表示新的内存空间(旧的还在，但马上就要释放并切换新的)，这里需要对新的内存空间进行设置，参看： fs/exec.c: exec_mmap()</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/86b607982a191c17e877670612fe17e6.png\"></p>\n<p>我们可以看到在当前进程还是 32 位的时候，内核对新的内存空间进行了初始化，导致 arch_pick_mmap_layout() 错误地将 arch_get_unmaped_exec_area 赋值给了 bprm-&gt;mm-&gt;get_unmapped_exec_area 这个成员变量，虽然图-11中 load_elf_binary() 函数在 748 行，32 位的标志被清空之后再次调用 set_up_new_exec() -&gt; arch_get_unmapped_exec_area()，但 arch_get_unmaped_exec_area() 并没有清空 mm-&gt;get_unmapped_exec_area 这个变量，导致 execv 后虽然进程是 64 位的，但仍然以 mm-&gt;shlib_base 这里作为起始地址搜索内存空间给动态库使用， oops.</p>\n<h2 id=\"解决方案\">解决方案</h2>\n<p>最直接可靠的做法是在进入 arch_pick_mmap_layout() 时，先把 mm-&gt;get_unmapped_exec_area 置为 NULL，但这就要修改内核了，用户态要规避的话有以下方式：<br>\n1、设置 ulimit -s unlimited，并设置 exec-shield 为 0 或 1，再起进程，这样一来，因为用户态的栈是无限长的，内核只能以传统的方式来对 32 位进程分配内存，不会掉进 exec-shield 的坑里。<br>\n2、把 randomize_va_space 禁掉，但这个做法只是把头埋进了沙子里。</p>\n<p>总的来说，上面两种用户态的规避方案基本是哪里疼往哪贴膏药，并非解决问题之道(且有安全隐患)，退一步来说，不要用 32 位的进程来起动 64 位进程还相对稳妥点.</p>\n<h2 id=\"参考\">参考</h2>\n<p>【0】<a href=\"https://en.wikipedia.org/wiki/C_dynamic_memory_allocation\">https://en.wikipedia.org/wiki/C_dynamic_memory_allocation</a><br>\n【1】<a href=\"https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/5/html/Tuning_and_Optimizing_Red_Hat_Enterprise_Linux_for_Oracle_9i_and_10g_Databases/sect-Oracle_9i_and_10g_Tuning_Guide-Growing_the_Oracle_SGA_to_2.7_GB_in_x86_Red_Hat_Enterprise_Linux_2.1_Without_VLM-Linux_Memory_Layout.html\">https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/5/html/Tuning_and_Optimizing_Red_Hat_Enterprise_Linux_for_Oracle_9i_and_10g_Databases/sect-Oracle_9i_and_10g_Tuning_Guide-Growing_the_Oracle_SGA_to_2.7_GB_in_x86_Red_Hat_Enterprise_Linux_2.1_Without_VLM-Linux_Memory_Layout.html</a><br>\n【2】understanding the linux kernel, page 819, flexible memory region layout: <a href=\"https://books.google.com.hk/books?id=h0lltXyJ8aIC&amp;pg=PT925&amp;lpg=PT925&amp;dq=linux+flexible+memory&amp;source=bl&amp;ots=gO7rIYb8HR&amp;sig=pirB5pswdHFHSljy57EksxS3ABw&amp;hl=en&amp;sa=X&amp;ved=0ahUKEwjpkfa-2_rRAhVGFJQKHcETDSUQ6AEITDAH#v=onepage&amp;q=linux%20flexible%20memory&amp;f=false\">https://books.google.com.hk/books?id=h0lltXyJ8aIC&amp;pg=PT925&amp;lpg=PT925&amp;dq=linux+flexible+memory&amp;source=bl&amp;ots=gO7rIYb8HR&amp;sig=pirB5pswdHFHSljy57EksxS3ABw&amp;hl=en&amp;sa=X&amp;ved=0ahUKEwjpkfa-2_rRAhVGFJQKHcETDSUQ6AEITDAH#v=onepage&amp;q=linux%20flexible%20memory&amp;f=false</a><br>\n【3】<a href=\"https://gist.github.com/CMCDragonkai/10ab53654b2aa6ce55c11cfc5b2432a4\">https://gist.github.com/CMCDragonkai/10ab53654b2aa6ce55c11cfc5b2432a4</a><br>\n【4】<a href=\"http://lxr.free-electrons.com/source/arch/x86/include/asm/processor.h#L770\">http://lxr.free-electrons.com/source/arch/x86/include/asm/processor.h#L770</a><br>\n【5】 <a href=\"https://access.redhat.com/blogs/766093/posts/1975793\">https://access.redhat.com/blogs/766093/posts/1975793</a><br>\n【6】<a href=\"https://lwn.net/Articles/31032/\">https://lwn.net/Articles/31032/</a><br>\n【7】<a href=\"https://lwn.net/Articles/454949/\">https://lwn.net/Articles/454949/</a><br>\n【8】<a href=\"http://lxr.free-electrons.com/source/fs/binfmt_elf.c#L549\">http://lxr.free-electrons.com/source/fs/binfmt_elf.c#L549</a><br>\n【9】<a href=\"http://lxr.free-electrons.com/source/fs/binfmt_elf.c#L563\">http://lxr.free-electrons.com/source/fs/binfmt_elf.c#L563</a><br>\n【10】类似问题： <a href=\"https://bugzilla.redhat.com/show_bug.cgi?id=870914\">https://bugzilla.redhat.com/show_bug.cgi?id=870914</a> <a href=\"https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=522849\">https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=522849</a></p>\n</div>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"110272\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"110272votetotal\">2</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"110272\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 3 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2015/10/008d9c47f50ab5eac3f349d238b3b6dc.jpg"], "tags": "IT技术,内存", "url_object_id": "da2ea9fdd8ff26ea923870b95c82230c", "title": "一个由进程内存布局异常引起的问题", "comment_nums": 0, "front_image_path": "full/80b4614d2c41c6d4f76f79bebe8e4d4beca33f43.jpg", "create_date": "2017/02/16"}
{"url": "http://blog.jobbole.com/110304/", "praise_nums": "2", "fav_nums": 4, "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"><p><script src=\"http://www.imooc.com/open/courselistrandjs\"></script><span style=\"display:block;margin-bottom:10px;\"></span></p>\n</div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文作者： <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/z329224946\">jason</a> 。未经作者许可，禁止转载！<br>欢迎加入伯乐在线 <a href=\"http://blog.jobbole.com/99322\" target=\"_blank\">专栏作者</a>。</div><p>由于挺多同学请求开源此项目，在这里说明一下:其实本人是想开源的，由于是本人写的第一个运维方面的系统，且写这个项目的时间时间紧，只达到了可以使用的程度，完全没有达到开源的要求，希望理解！</p>\n<h2 id=\"日常运维问题\">日常运维问题</h2>\n<p>在我日常运维工作中，代码发布可能是最普遍的一项工作之一，尤其是网页代码的更新，碎片化发布需求非常频繁。在前期开发人员比较少时，还可以由自己来上服务器通过脚本来发布代码。但随着公司项目的增多，更多的开发人员加入到公司，发布代码需求开始增多，这就占用了我大部分时间，经常的被打断其它工作来发布代码，非常地不爽，然后开始想解决方法。</p>\n<h2 id=\"尝试解决问题\">尝试解决问题</h2>\n<p>当然，发布代码肯定是运维的职责之一了，但频繁的发布导致运维大部分时间浪费在重复的操作上，非常的不值得。基于此，开始限制代码发布频率，要求把不是很紧急的更新延后到一周中的几个时间点。但实施起来效果不理想，治标不治本，原因是你不能强制把需要立即上线的更改延后。实施这样的定时发布，有可能影响项目的快速迭代。</p>\n<h2 id=\"最终解决方案\">最终解决方案</h2>\n<p>想到这样子下去也不是办法，会造成工作很被动，于是开始着手建立以Web操作方式，结合git,<a href=\"https://www.centos.bz/tag/rsync/\">rsync</a>来实现自动代码发布。公司代码管理目前用的是svn，开发人员在发布前也没有打Tag的习惯，所以想到分布式的git来完成版本的管理，rsync当然是用来同步代码到其它服务器了。附上几张代码发布系统的截图：<br>\n<img class=\"aligncenter size-full wp-image-110305\" src=\"http://jbcdn2.b0.upaiyun.com/2017/02/b78656b8d858a25e078398773d563678.jpg\" alt=\"11gitrsync\"><br>\n<img class=\"aligncenter size-full wp-image-110306\" src=\"http://jbcdn2.b0.upaiyun.com/2017/02/3d53213bee098b55819c6ac0405d1a0d.jpg\" alt=\"12gitrsync\"><br>\n<img class=\"aligncenter size-full wp-image-110307\" src=\"http://jbcdn2.b0.upaiyun.com/2017/02/3d2efc37fac8e63b04bf13b720b7c096.jpg\" alt=\"13sdfasdfs\"></p>\n<h2 id=\"开源技术使用\">开源技术使用</h2>\n<ul>\n<li>rsync:用来同步代码到服务器;</li>\n<li>git: 用来标记版本，回滚版本;</li>\n<li>tornado: <a href=\"https://www.centos.bz/category/python/\">python</a>的一个web构架，提供后台服务;</li>\n<li>angularjs: 前端的一个mvc框架，用来实现浏览器与后端的交互，使得后端不需要关心前端网页的渲染，专注后端逻辑的开发。前端和后端通过json数据来通信;</li>\n<li>bootstrap: 让运维人员写的网站后台UI也可以很专业。</li>\n</ul>\n<h2 id=\"代码发布流程\">代码发布流程</h2>\n<p><img class=\"aligncenter size-full wp-image-110308\" src=\"http://jbcdn2.b0.upaiyun.com/2017/02/f9deb995859858a4174e7b3c9ef19aef.jpg\" alt=\"14sdafasdf165\"><br>\n从流程图可以看到，我们只需要把审核发布的权限交给开发组负责人，运维只需要维护系统的稳定，之后代码发布就不需要运维来参与了。</p>\n<p><strong>以上是整体的流程，现在来说详细说下具体的逻辑实现：</strong></p>\n<ul>\n<li>1、开发人员提交代码更新，主要提交的字段包括“更新理由”，“svn代码路径”;</li>\n<li>2、后端收到请求后，把此数据插入到数据库，标记此更新单为“等待预发布环境更新”的状态;</li>\n<li>3、后台进程定时查询是否有等待预发布环境更新的更新单，如果有，读取svn路径，执行svn up更新代码操作,并标记此更新单为“预发布环境已更新，等待完成测试”;</li>\n<li>4、开发人员或者测试人员通过预发布环境的域名来测试功能是否正常，如果不正常，作代码修改后提交svn，再到web发布后台点击“返回修改”，对svn路径或者不做任何修改再点击“重新提交”，然后更新单又一次回到”等待预发布环境更新“状态。循环3、4步骤，直至预发布环境测试通过为止;</li>\n<li>5、在确认测试通过后，开发人员点击”测试通过“，这时更新单进入”等待审核状态“;</li>\n<li>6、负责人确认可以发布后，点击”审批“按钮，这时更新单进入”审核通过，等待执行发布操作“的状态。这时,开发人员得到发布代码的授权;</li>\n<li>7、开发人员点击”发布代码“按钮，更新单进入”已执行发布，等待系统完成发布“状态;</li>\n<li>8、后台进程查询状态为”已执行发布，等待系统完成发布“的更新单，执行git发布命令。git命令大概为，进入预发布代码目录，执行git add .;git commit -m “更新原因”;git tag 上一次版本号+1，再进入已发布代码的目录,执行git pull同步预发布代码目录的更改。最后调用rsync命令同步代码到生产环境。</li>\n</ul>\n<p><strong>下面是回滚流程：</strong></p>\n<ul>\n<li>1、进入web代码发布系统，选择已发布的版本，点击“申请回滚”;</li>\n<li>2、负责人审核此次回滚;</li>\n<li>3、开发人员执行回滚操作;</li>\n<li>4、后台查询“等待回滚”的记录，假如回滚的版本号为18，进入已发布代码的目录,执行git checkout -b 18 18;git checkout 18(这两条git命令作用为,以tag 18创建分支号为18的分支，并切换当前分支为18)，然后再通过rsync命令来同步代码到生产环境，这样就实现了版本的回滚。</li>\n</ul>\n<h2 id=\"最后想说的话\">最后想说的话</h2>\n<p>最后想说的是，运维工作可以是枯燥的，也可以是有趣的。枯燥是因为没有意识或者懒得把重复的操作通过制定流程来使其自动化，在不断地把各种在运维工作中占用时间比较多的重复操作通过技术来使得自动化时，我们既高效完成了工作，节省了时间，又能提高编程和解决问题的能力，只有这样，我们才能让运维工作变得既有趣又有挑战性。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"110304\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"110304votetotal\">2</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"110304\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 4 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i> 1 评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/z329224946\">jason</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/z329224946\">\r\n\t\t\t<img src=\"http://jbcdn2.b0.upaiyun.com/2015/04/8fbdaaa5ea6d3b49c8c1c825aafeb5d9.png\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            主要技术兴趣为Linux运维，作者技术博客http://www.centos.bz        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/z329224946\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/z329224946/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/z329224946/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 3</a> · <a title=\"我的网站\" target=\"_blank\" href=\"http://www.centos.bz\"><i class=\"fa fa-link\"></i></a> <a title=\"微博主页\" target=\"_blank\" href=\"http://weibo.com/zhumaohai/\"><i class=\"fa fa-weibo\"></i></a> <a title=\"Twitter主页\" target=\"_blank\" href=\"http://twitter.com/\"><i class=\"fa fa-twitter\"></i></a>         </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2017/02/b78656b8d858a25e078398773d563678.jpg"], "tags": "IT技术,运维", "url_object_id": "22b366460824692dffff382796f7d13b", "title": "代码发布系统实现", "comment_nums": 1, "front_image_path": "full/8145f7db30653f259e371f1f5373ea84faa09df3.jpg", "create_date": "2017/02/20"}
{"url": "http://blog.jobbole.com/110143/", "praise_nums": "5", "fav_nums": 6, "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"><p><script src=\"http://www.imooc.com/open/courselistrandjs\"></script><span style=\"display:block;margin-bottom:10px;\"></span></p>\n</div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a target=\"_blank\" href=\"http://www.cnblogs.com/mindwind/p/6391315.html\">mindwind</a>   </div><p>去年底看到陈皓（酷壳博主）写了篇很好的文章《<a href=\"http://blog.jobbole.com/110265/\" target=\"_blank\">技术人员的发展之路</a>》，里面提及职业发展的一定阶段，也许你会碰上一些复杂的人和事，这种情况下他写道：</p>\n<blockquote><p>这个时候再也不是 talk is cheap, show me the code! 而是，code is cheap, talk is the matter!</p></blockquote>\n<p>这里的 talk 其实就是沟通，近年来发现沟通越发成为一件重要的事。在近期的工作中也会观察到一些沟通问题，比如跨团队开会沟通时发生的一些分歧与争论。作为程序员的我感觉沟通一直是一个痛点，所以近年来一直在思考关于沟通的问题，下面就写写我的观察与思考吧。</p>\n<h2 id=\"木讷与沉默\">木讷与沉默</h2>\n<p>这两个名词似乎已变成了程序员的标签，它们形象地体现了程序员在沟通中的表现。在程序员的世界里，沟通可能包括：与产品经理沟通需求、与同行交流技术、与外行交谈，还有与同事分享工作与生活的趣闻等。</p>\n<p>有些程序员在分享趣闻与谈需求或技术时的表现大相径庭，刚才还是一个开朗的小伙突然就变得沉默不语了。沉默有时是不想说，特别在沟通需求时，程序员心里想着：与其扯那么多，哥代码都写完了。不就是一个小功能吗，默默无言，笑而不语的就接下了，想着赶快结束去写代码了。</p>\n<p>程序员写出的代码本应该是公司的资产，但现实是代码这东西是同时带有资产和负债双属性的。Linus 写的 Linux 或者 @antirez 贡献的 Redis 里面包含的代码是极好的资产，但大部分我们沟通不充分的需求，最后基于此写出来的代码都是负债大于资产。最后，往往是出来混都是要还的，不是自己还就是别人来还。</p>\n<p>程序员可能会争辩道，与人沟通本来就不是我们所擅长的，我们并不是因为热爱跟别人聊天才做软件开发这一行的。这个言论很有迷惑性，我早年一度都是这么认为的。当年毕业去找工作，外企如日中天，去了当时心中的很牛的 IBM 面试。面试过程中大部分的交谈过程我都记不清了，就一个问题至今很清晰。面试经理问我：你是喜欢多些跟人打交道呢，还是跟电脑打交道？当时的我毫不犹豫的回答喜欢跟电脑打交道，喜欢编程写代码，而且自觉我也不擅长和人打交道。</p>\n<p>然后，我就被淘汰了。后来我才明白了，其实当时的这类外企挂着招软件工程师的名义，实际需要的更多是具有技术背景和理解的售前技术支持，因为在国内它们基本就没有一个真正的研发中心。如今我认为，即便你仅仅只喜欢写代码，那么和人的沟通能力依然是你跨不过去的瓶颈。写代码本身就是一种沟通，一种书面沟通。</p>\n<blockquote><p>程序写出来是给人看的，附带能在机器上运行。<br>\n–《计算机程序的结构与解释》</p></blockquote>\n<p>沟通从来都是个问题，书面沟通同样困难。</p>\n<h2 id=\"争论与无奈\">争论与无奈</h2>\n<p>程序员产生争论的地方多半都在和同行的沟通中，想必很多人都和同行有过关于技术方案的争论。我自己就曾在过去多年的工作中和同事有过技术方案之争，得到的教训可以建议给技术经理（主管）们：不要让两个都觉得自己很牛的程序员去同时设计一个技术方案。不巧，你已经这么干了并得到了两个不同的方案，那么记住，就别再犯下一个错：让他们拿各自的方案去 PK。</p>\n<p>既然分歧已经产生了，为了避免无谓的争论，该怎么解决呢？</p>\n<h3 id=\"以理服人\">以理服人</h3>\n<p>首先，把握一个度，对事不对人，切勿意气用事。有些技术人之间的分歧点是非常诡异的，这可能和技术人自身的洁癖、口味和偏好有关。比如：大小写啦、命名规则啦、大括号要不要独立一行啦、驼峰还是下划线啦、Tab 还是空格啦，这些都能产生分歧。一旦处女座心态爆发，很可能一发不可收拾。</p>\n<p>如果你因为“该怎么做某事或做某事的一些形式问题”与他人产生分歧，那么在很多情况下，你最好先确定分歧点是否值得你去拼命维护。这时，你需要判断一个技术的「理」在什么地方，这个「理」是你值得拼命坚守的底线不，用这个「理」能否说服对方吗？</p>\n<p>我所理解的技术的「理」包括：先进性、可验证性、适配性（和团队）、时效性、成本和收益。另外一些不合适的「理」包括：风格、口味、统一、政治。</p>\n<p>不过有时候，有理也不代表就能搞定分歧，达成一致。林子大了，不讲理的人也是有的，那么下一步。</p>\n<h3 id=\"以德服人\">以德服人</h3>\n<p>分歧进入用「理」都无法搞定时，那就是应了那句古词：“剪不断，理还乱。”。这时继续理下去，不过都是互相耍混了。</p>\n<p>「理」是一个客观需要双方去认可的存在，越理越乱说明双方至少没有这种客观一致性的基础，那就找一个主观的人来做裁决吧。</p>\n<p>德，谓之德高望重，是否有一个双方都认可的人来做裁决，这个人通常就是所谓经验丰富的老司机了，比如架构师之类的。这类主观裁决也不一定能让双方都满意，有时实力相当的技术人也容易产生类似文人相轻的状况。不过看在老司机的德面上，也能勉强达成一致。</p>\n<p>老司机裁决最好站在他所认同的「理」的这个客观存在上，这是最好的，不过这也取决于老司机的工作素养和价值观了。</p>\n<h3 id=\"以力服人\">以力服人</h3>\n<p>最差的状况就会走到这一步，特别在跨大部门的沟通中。技术方案无法达成一致，也没有一个跨两个部门的有德之人可以转圜化解，就会升级到这个地步。</p>\n<p>最后就是靠粗暴的权力来裁决，看双方部门老大或老大的老大，看谁更有力或给力。一般来说非关键利益之争实在没有必要走到这一步了。</p>\n<h2 id=\"认识与改变\">认识与改变</h2>\n<p>做出改变的第一步是要能认识到，否则改变不可能发生。程序员会认识到沟通很重要，有时会比写代码更重要吗？程序员著名网站之一 StackOverflow 的两位创始人 Jeff Atwood 和 Joel Spolsky 都对此有正面的认识和见解。</p>\n<p>Jeff 说：</p>\n<blockquote><p>成为一名杰出的程序员其实跟写代码没有太大关系。<br>\n做程序员确实需要一些技术能力，当然还要有坚韧不拔的精神。<br>\n但除此之外，更重要的还是要有良好的沟通技巧。</p></blockquote>\n<p>Jole 的观点：</p>\n<blockquote><p>勉强过得去的程序员跟杰出程序员的不同之处，不在于他们掌握了多少种编程语言，也不在于他们谁更擅长 Python 或 Java。<br>\n真正关键的是，他们能不能把他们的想法表达清楚，杰出的程序员通过说服别人来达成协作。<br>\n通过清晰的注释和技术文档，他们让其他程序员能够读懂他们的代码，这也意味着其他程序员能够重用他们的代码，而不必重新写过。<br>\n要不然，他们代码的价值就大打折扣了。</p></blockquote>\n<p>按照程序员解决技术问题的习惯，就是对大问题作拆解，我们也对沟通作下拆解，它包括三个方面：</p>\n<ul>\n<li>内容</li>\n<li>方式</li>\n<li>风格</li>\n</ul>\n<p>从内容看，即使你想沟通的本质是同一样东西或事情，但你需要针对不同的人准备不同的内容。比如程序员和内行与外行谈同一个技术方案，内容就是不同的。这里需要发挥同理性和换位思考的能力。Paul Graham 曾在他的书《黑客与画家》中写到：</p>\n<blockquote><p>判断一个程序员是否具备“换位思考”的能力有一个好方法，那就是看他怎样向没有技术背景的人解释技术问题。</p></blockquote>\n<p>换位思考本质上就是沟通技巧中的一种。</p>\n<p>从方式看，沟通其实不局限于面对面的谈话，面对面交谈是一种形式，书面写作又是另外一种形式，连写代码本身都是在和未来的自己或某个你尚未谋面的程序员沟通。对于程序员确实有很多都不擅长面对面的沟通形式。</p>\n<p>面对面沟通的场景是很复杂的，因为这种沟通中交流传递的载体不仅仅是言语本身。你的眼神、姿态、行为、语气、语调高低，甚至一种很虚幻的所谓气场，都在传递着各种不同的信息。而大部分人都不具备这种同时控制好这么多传递渠道的能力，我们经常通俗的说是缺乏控场能力，这里面隐含着对你其他能力的要求，比如：机变、思维的活跃度与变化等。</p>\n<p>从风格看，交谈风格和写作风格可以是完全不同甚至对立的。比如：「小道消息」的作者 Fenng（冯大辉）的文字风格很多时候给人的感觉是简短、尖锐和犀利的，但据说（来自知乎评论）其私下的面谈风格完全与之不同。</p>\n<p>因而，沟通之难在于清晰的传递内容和观点。当你要向其他人详细解释某样东西的时候，你会惊讶地发现你有多无知，于是，你不得不开始一个全新的探索过程。这一点可以从两个方面来体会：</p>\n<ol>\n<li>你只需要尝试写点你自认为已经熟悉掌握的技术，并交给读者去阅读与评价。</li>\n<li>如果你的公司晋升采用一种述职答辩的方式（现在很多互联网公司采用），你就会体会到这一点。</li>\n</ol>\n<p>我每次写完一篇技术文章，都会发现一些漏洞或者 bug，主要出现在我总觉得我想表达的东西没有足够清晰或是有歧义，或漏了一些。但文字不像代码，你搞错了一些东西，漏了几个字符，编译器或运行环境会给你扔出几个警告或错误，或者干脆就不让你运行。所以也很难像写代码一样去反复重构和优化文字。</p>\n<p>…</p>\n<p>江山易改，本性难易，有时候我们做不到就在于这一点。</p>\n<p>如何更好的沟通对我也是一个很难的挑战。不过若能通过本文，让你了解到这种处境，即使还无法做出任何改变，但仅仅是了解了这个事实，也可能会让你感受好些。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"110143\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"110143votetotal\">5</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"110143\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 6 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i> 5 评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2017/02/8b9e3e457de6fe17e091509ffd01932d.jpg"], "tags": "职场,数据库,沟通,职场", "url_object_id": "521e8d517f26811cf7e1a711dd4190fe", "title": "程序员的沟通之痛", "comment_nums": 5, "front_image_path": "full/66cdecd30be46f7be68319905a826878eeced60c.jpg", "create_date": "2017/02/20"}
{"url": "http://blog.jobbole.com/110284/", "praise_nums": "1", "fav_nums": 0, "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"><p><script src=\"http://www.imooc.com/open/courselistrandjs\"></script><span style=\"display:block;margin-bottom:10px;\"></span></p>\n</div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a ref=\"nofollow\" target=\"_blank\" href=\"https://opensource.com/article/17/2/decline-gpl\">opensource</a>   译文出处：<a target=\"_blank\" href=\"https://www.oschina.net/news/81997/the-decline-of-gpl\">oschina/王练</a>   </div><p>前段时间，我在 RedMonk 上看到了一篇来自 Stephen O’Grady 的有趣<a href=\"http://redmonk.com/sogrady/2017/01/13/the-state-of-open-source-licensing/\" target=\"_blank\">推文</a>，介绍了开源许可证目前的状态，以及此图表：</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/bd3b92ca53b0189de575bce969e16960.png\" width=\"600\" height=\"397\"></p>\n<p>此图展示了从2010年到2017年开源许可证的使用情况。能很明显看到，GPL 2.0 的使用量已经减少了一半以上，更多的开发人员转向使用 MIT 和 Apache 许可证。而 GPL 3.0 有小幅增长。</p>\n<p>所以，为什么？</p>\n<p>当然，原因自然有很多，而我的猜测是，这主要是由于开源商业化的趋势，而 GPL 相对不具商业友好性。</p>\n<p><strong>GPL &amp; 商业</strong></p>\n<p>在开始之前，必须申明：我是一个 GPL 支持者，我所写的软件都是在 GPL 协议之下开源的。这篇文章也不是为了强调 GPL 的实用性和价值，更多的是想分享自己对于行业和许可的认知。</p>\n<p>四年前，我参加了一年一度的 Open Source Think Tank 。这是在加利福尼亚举办的一个小型的开源行业高管聚会，主要关注的是网络、建立联盟、确定和解决行业问题。聚会上有一个小组案例研究环节，参会者会被分成多个小组，并被要求推荐一个目前正被广泛使用的开源协议。我惊讶的发现，这些小组给出的建议中没有 GPL。</p>\n<p>所以说，当时业界就已经有对 Apache 和 MIT 许可证的倾向趋势了。2015年 GitHub <a href=\"http://github.com/blog/1964-open-source-license-usage-on-github-com\" target=\"_blank\" data-cke-saved-href=\"http://github.com/blog/1964-open-source-license-usage-on-github-com\">许可研究</a>也发现，MIT 许可证已成为最主要的一个选择。 在我的 XPRIZE 工作和作为社区顾问的工作中，我也看到了一个类似的现象，许多客户对于用 GPL 许可他们的代码表示不舒服。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/b4b12a3e25e86a48bcdd9317bfe554d4.png\" width=\"670\" height=\"848\" data-cke-saved-src=\"https://static.oschina.net/uploads/space/2017/0215/114215_e2pT_2896879.png\"></p>\n<p><strong>社区 &amp; 企业</strong></p>\n<p>说实话，GPL 人气不断下降并不很令人惊讶。</p>\n<p>首先，随着开源产业的发展，大家都已经清楚的发现，找到社区参与的平衡以及客户需求的商业模式极为重要。在开源早期有一个误解，“如果你建立一个开源项目，客户就会来。确实，他们会经常来使用你的软件。但在大多情况下，他们不会给你钱”。</p>\n<p>随着时间的推移，我们看到各种公司，如红帽、Automattic、Docker、Canonical、Digital Ocean 等等，都在探索不同的开源方式来实现盈利。包括分发模式，服务模式，开放核心模式等等。可以很清楚的是，传统的软件稀缺模式并不适用于开源项目，在收入和免费之间取得平衡对许多人来非常困难。</p>\n<p>GPL 虽然是开源许可证，但它基本上是一个自由软件许可证。作为自由软件许可证，对 GPL 的管理和支持大部分是由自由软件基金会推动的，他们最终的焦点都是从软件绝对必须 100% 自由的角度出发。他们没有太多的妥协空间，甚至许多公认的开源项目（例如很多 Linux 发行版）都因为一小部分二进制固件而被认为是“非自由”。很少有企业认可自由软件基金会（或类似的组织）这种纯粹的意识，因此我怀疑企业不太愿意选择一个如此纯粹的许可证。</p>\n<p>另外一个影响 GPL 使用的原因，我认为是随着增长开源的目的不再纯粹。在早期，开源项目建立的核心根本之一是关注开放性和软件自由性。 GPL 对于这类项目来说是一个非常自然的选择，如 Debian、Ubuntu、Fedora、Linux 等等。但近年来，我们已经看到了更新一代的开发形式，对他们来说自由什么的可能不太重要，开源是为了完成命令，又或者只是为了开放某个软件的一个组件。我觉得这也是为什么越来越多的使用 MIT 和 Apache 许可证的原因之一。</p>\n<p><strong>未来?</strong></p>\n<p>说到底，这对 GPL 意味着什么?</p>\n<p>我认为，GPL 将继续是一个备受欢迎的许可证，但开发人员将越来越多地将其看成是一个纯粹的自由软件许可证。 对软件自由有道德承诺的项目将优先考虑 GPL ，但对于前面讨论的需要考虑平衡的企业，还是会更愿意使用 MIT 和 Apache 许可证。</p>\n<p>无论如何，看到开源和自由软件在不断增长是非常令人兴奋的事情。虽然许可证的使用方式可能存在复杂性和变化，但对我们来说，更重要的是技术在日益变得越来越开放，每个人都可以去使用。</p>\n<p><strong>你最喜欢哪个许可证，或者你开源的项目正在使用的是哪个许可证？</strong>欢迎在下方评论区留言。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"110284\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"110284votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"110284\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i>  收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2017/02/bd3b92ca53b0189de575bce969e16960.png"], "tags": "IT技术,GPL,协议,开源", "url_object_id": "469d9c42e14c25ca9608b60d1edf24fd", "title": "为什么越来越少的开源项目使用 GPL 协议", "comment_nums": 0, "front_image_path": "full/9ce2c82364ff458caf5f469862322de1d61136c9.jpg", "create_date": "2017/02/17"}
{"url": "http://blog.jobbole.com/110247/", "praise_nums": "1", "fav_nums": 0, "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"><p><script src=\"http://www.imooc.com/open/courselistrandjs\"></script><span style=\"display:block;margin-bottom:10px;\"></span></p>\n</div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文作者： <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/bjweimengshu\">玻璃猫</a> 。未经作者许可，禁止转载！<br>欢迎加入伯乐在线 <a href=\"http://blog.jobbole.com/99322\" target=\"_blank\">专栏作者</a>。</div><p>编程究竟是文科还是理科？</p>\n<p>还用问？编程当然是理科喽！或许很多人会不屑地回答。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/fbbfc48618eb370cc81a6a960ee297d3.jpeg\"></p>\n<p>然而，情况真的如此吗？</p>\n<p>让我们先来看看一个程序员故事，或许里面有着你我的影子。</p>\n<p><strong>学习编程的小灰</strong></p>\n<p>多年以前，工科出身的小灰打算学习编程</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/e0ed9f793baee677cc40dfd4d1a061b1.jpeg\"></p>\n<p>学习编程的头一个月，小灰如鱼得水</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/a5392441ac56e025c05262f1f11ca04c.jpeg\"></p>\n<p>学习编程三个月，小灰略有疑惑</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/2027114bd308a84007533e0bf028f56c.jpeg\"></p>\n<p>求职和初入职场，海量的知识扑面而来</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/f21f67048f88f6f8035f381876ad6894.jpeg\"></p>\n<p>工作若干年，小灰又将面临新的挑战</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/52f6b4d9458169dbb756525da1712cfc.jpeg\"></p>\n<p>工作之余，小灰回想起自己编程道路上的得与失，不禁感慨道：</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/79c1e7e871e21d8d0da72a8338750889.jpeg\"></p>\n<p><strong>文科还是理科？</strong></p>\n<p>若要评判编程是文科还是理科，我们需要首先明确一下文科与理科的各自特征。</p>\n<p>文科：<strong>以知识和经验总结为主</strong>，例如历史学、法学</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/27e150cf7231679a15db48df1639b6c7.jpeg\"></p>\n<p>理科：<strong>以计算和逻辑推理为主</strong>，例如数学</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/55cb612932695ed6b1a66d7e827df9af.jpeg\"></p>\n<p>当然，绝大多数学科都不是纯粹的文科和理科，而是两者均有涉及。其中有些学科更偏重文科，但也具有少量理科成分，例如地理学。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/9c85ed808a9108d9386910179990d906.jpeg\"></p>\n<p>也有部分学科更偏重理科，但具有少量文科成分，例如化学、生物学。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/43313af88188bed8eb3480b8e3a22925.jpeg\"></p>\n<p>对于这些“混合型”学科，我们往往依照其侧重点，来划分文理科。因而毫无疑问，地理学属于文科，生物学属于理科。</p>\n<p>那么，对于“编程”这样一门学科，究竟是文科成分占主导，还是理科成分占主导呢？让我们来做一些具体分析。</p>\n<p><strong>编程中的理科部分：</strong></p>\n<p><strong>1.基本逻辑</strong></p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/95e7ca7ceb22504340aa4dccc3006558.jpeg\"></p>\n<p>这里的基本逻辑，指的是编程中所涉及的各种基本逻辑元素，比如程序中的循环控制、条件控制逻辑，比如数据库中的SQL查询逻辑，比如多线程的同步异步逻辑。</p>\n<p>诚然，<strong>逻辑是学习编程的基石，但逻辑绝不会成为一个程序员从初级走向高级的门槛。</strong>因为这些逻辑的学习成本真的不高，只要方法得当，一个十二三岁的普通孩子也可以轻松掌握。</p>\n<p><strong>2.算法</strong></p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/900d619ee0357f033da254fe17c615b8.jpeg\"></p>\n<p>如果说基本逻辑仅仅是入门的基础，那么算法就是理科编程的真正难点。可是，对于绝大多数人程序员来说，如果不是专门从事算法研究，不是ACM竞赛的参赛者，那么算法对他来说仅仅是一个大致原理的理解，仅仅是一个API的调用。<strong>算法很重要，但是相对于其他能力，算法又显得不那么关键。</strong></p>\n<p><strong>编程中的文科部分：</strong></p>\n<p><strong>1.知识</strong></p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/df0af7566d12fb17bd182f14a054a373.jpeg\"></p>\n<p>知识是一个广义的概念。在编程这个领域，<strong>知识可以是某种语言规则</strong>，比如Java中final类不能被继承；<strong>知识也可以是某个底层原理</strong>，比如Mysql中Myisam引擎的索引数据文件分离；<strong>知识也可以是某种设计原则</strong>，比如面向对象的开放封闭原则，比如系统设计的CAP原则。</p>\n<p>或许有人会说，编程当中的知识不需要像文科那样死记硬背，最重要的是“理解”。可是，理解与记忆原本就是密不可分的，不去记忆，谈何理解？历史事件需要理解，法律法规也需要理解，但历史学与法学，并未因此而脱离“文科”这一属性。</p>\n<p><strong>2.经验总结</strong></p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/a276d25da8450cae916fe0e10ad431b7.jpeg\"></p>\n<p>如果说编程知识是一条一条清晰的文字，那么编程经验则显得抽象而模糊，很难直接用语言表达。</p>\n<p>深厚的编程经验可以让你写出可扩展性更强的代码，可以让你快速定位出线上的bug，也可以让你设计出高可用的系统。知识由书本得来，经验则是在一次次的采坑中逐渐总结和积累获得。可以说，经验的作用还在知识之上。<strong><br>\n</strong></p>\n<p>总结起来，在逻辑、算法、知识、经验四个方面，绝大多数程序员花费几个月的时间掌握了编程的基本逻辑，却需要花费五年甚至更长的时间来学习大量编程知识，总结编程经验。算法虽然学习成本很高，但因为过于“专业化”，而居于次要地位。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/b1d8ac19f469d6edd236be36f49a60c5.jpeg\"></p>\n<p>由此可见，<strong>编程虽然有着一定的理科元素，但更多的特征仍旧偏向文科，足以把整体定位成文科。</strong></p>\n<p><strong>如何学好这门文科？</strong></p>\n<p>无论编程的真面目是文是理，作为一个程序员，我们都需要热爱自己的职业。算法和设计思想是天马行空的艺术，项目研发则是脚下泥泞坎坷的道路。做好程序员，最重要的是踏实和耐心，希望各位亲们都能一步一个脚印，走出属于自己的路。</p>\n\r\n        \r\n            <blockquote class=\"rewards\">\n        <p><strong>打赏支持我写出更多好文章，谢谢！</strong></p>\n        <a href=\"#rewardbox\" id=\"rewards-button\" class=\"fancybox\"><span class=\"btn-bluet-blue href-style\"><i class=\"fa fa-jpy\"></i> 打赏作者</span></a>\n    </blockquote>\n\n    <div id=\"rewardbox\">\n        <h4>打赏支持我写出更多好文章，谢谢！</h4>\n                <p>\n                        <img src=\"http://jbcdn2.b0.upaiyun.com/2016/10/2df4a3ede6e684f78858dfde0e7b118f.jpeg\">\n            \n                    </p>\n    </div>\n\n    \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"110247\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"110247votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"110247\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i>  收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i> 1 评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/bjweimengshu\">玻璃猫</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/bjweimengshu\">\r\n\t\t\t<img src=\"http://jbcdn2.b0.upaiyun.com/2016/09/7ce4028f2cece3294efcb3e5caa73af1.jpeg\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            互联网公司的码农一枚，喜欢算法和面向对象设计。个人微信号：13522239721 个人订阅号：dreamsee321欢迎一起交流讨论！        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/bjweimengshu\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/bjweimengshu/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/bjweimengshu/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 76</a> · <a title=\"个人微信：bjweimengshu\" target=\"_blank\" href=\"#\"><i class=\"fa fa-weixin\"></i></a>         </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2017/02/fbbfc48618eb370cc81a6a960ee297d3.jpeg"], "tags": "趣文小说,趣文", "url_object_id": "e79b6692b01244541a9830c18b6a7e15", "title": "趣文：编程其实是文科", "comment_nums": 1, "front_image_path": "full/4618179bca44b1d4bf37354316ea854179e59006.jpg", "create_date": "2017/02/17"}
{"url": "http://blog.jobbole.com/110255/", "praise_nums": "1", "fav_nums": 1, "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"><p><script src=\"http://www.imooc.com/open/courselistrandjs\"></script><span style=\"display:block;margin-bottom:10px;\"></span></p>\n</div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文作者： <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/ityouknow\">纯洁的微笑</a> 。未经作者许可，禁止转载！<br>欢迎加入伯乐在线 <a href=\"http://blog.jobbole.com/99322\" target=\"_blank\">专栏作者</a>。</div><div>\n<p>多年前，又是周六客服打电话过来，平台官网不能访问，app完全无法打开，客户在QQ群和微信群中各种反馈，说平台是不是跑路了？客服的多条400热线完全被打爆，电话已经接不过来…</p>\n<h2 id=\"前言\">前言</h2>\n<p>一直以来总是想以什么方式去记录下自己在互金行业的这段经历，趁着自己还记得清楚，还能找到一些资料原型，一方面可以分享出来供大家参考，但是更重要就是多年以后我可以根据这些文章回忆起来自己的那段激情岁月。</p>\n<p>想了很久但一直没有实施，后来觉得应该从架构的角度来梳理一篇文章，就写《<a href=\"http://blog.jobbole.com/110234/\" target=\"_blank\">从零到百亿互联网金融架构发展史</a>》这篇文章；最后认为只有实战出来的东西以及解决问题的过程，才是工作中最宝贵的经验，应该把它分享出来，在梳理的过程中觉得有三起事故比较有代表性就整理出了下面这三篇文章，本篇文章从整体来回忆一下一路走过来所经历过的救火故事。</p>\n<ul>\n<li><a href=\"http://blog.jobbole.com/110152/\" target=\"_blank\">一次生产事故的优化经历</a></li>\n<li><a href=\"http://blog.jobbole.com/110165/\" target=\"_blank\">一次 DNS 缓存引发的惨案</a></li>\n<li><a href=\"http://blog.jobbole.com/110225/\" target=\"_blank\">一个脚本引发的血案</a></li>\n</ul>\n<p>作为一个互联网金融平台，涉及到用户资金，任何的服务（资金）差错用户都是不可容忍的，用户不懂什么是数据库，不知道什么网络不通，就是一会看不到钱在app里面展示都会觉得不安。在已经有很多P2P公司跑路的前提下，用户个个已经被锻炼成为福尔摩斯侦探，每天打开app查看收益，监控着平台一切，甚至半夜升级断网十分钟，也会被用户察觉，直接就发到群里面，更有甚者直接在QQ群或者微信群中你们的技术行不行!</p>\n<p>我们常说的互联网工作经验，一方面是开发经验，但其实更重要的是处理问题的能力。那么处理问题的能力怎么来呢，就是不断的去解决问题，不断的去总结经验，其中处理生产环境中问题的经验更甚,因为在处理生产环境中对个人的压力和临危应变的能力要求最高，你不但需要面临千万个用户反馈，客服不时得催促而且旁边可能就站了N个领导在看着你，一副你行不行的样子要求立刻马上解决问题！这个时候你的操作就非常重要，稍有不慎便会引发二次生产事故。</p>\n<p>说了这么多，只是想说明，生产事故对技术综合能力要求颇高，更是锻炼处理问题能力最佳时机！下面给大家介绍我们从零开发到现在百亿交易量所遇到的几次关键事故，有大有小挑出一些比较有代表性的事件来分享。</p>\n<h2 id=\"并发满标\">并发满标</h2>\n<p>公司系统刚上线的时候，其实没有经历过什么大量用户并发的考验，结果公司做了一个大的推广，涌入了一批用户来抢标，共1000万的标的几乎都在10秒之内搞定，大概会有上万左右的用户会同时去抢标，平均每秒大概有千人左右的并发，满标控制这块没有经过大的并发测试，上来之后就被打垮了，导致得结果是什么呢，1000万的标的，有可能到一千零几万满标，也有可能会九百多万就满标，也就说要不就是多了一些，要不就是少了一些，就满标了。</p>\n<p>这就会很尴尬，因为借款用户就借款一千万整，那么多出来的钱既不能给用户退回了，因为用户好不容易才抢上了，无端退了用户也闹；少了也是问题，用户借款一千万，少了几十万也不行，如果短得少了可以想办法找一些有钱的客户直接给买了，多了就必须重新放出来让用户投资，非常影响士气，这个问题困扰了我们有一段时间。</p>\n<p>购买标的流程图，不知道大家是否能根据此图发现问题呢？</p>\n<p><img src=\"http://www.ityouknow.com/assets/images/2017/optimize/buy.png\" alt=\"\"></p>\n<p><strong>超募</strong></p>\n<p>为何会产生超募？在最早前的版本中没有使用乐观锁来控制，如果在最后购买的用户一单出现并发，就会出现超募，比如最后剩余30000份的购买份额，因为并发量特别大，可能同时会有十几个用户拿到了剩余30000份余额的可购买额度，有的买1000份、有的买上3000份、有的买上20000份都会驱动满标，所以最后导致了超募。</p>\n<p>针对这个问题，主要是引入了memcached乐观锁的概念（底层主要是<code>cas</code>、<code>gets</code>两个命令），在发标的时候存入标的总份额，当用户购买的时候首先去锁定用户购买的份额，因为乐观锁的原因，如果同时有两个用户拿到份额的时候保证只有一个最后可以更新成功（锁定份额），（锁定份额）失败直接返回，这样就保证了在入口的时候就直接屏蔽了部分并发的请求。</p>\n<p><strong>少募</strong><br>\n为何产生少募？少募是可能1000万的标的突然到980万就给满标了，这是因为在超募情况下我们完善了代码，用户一进来首先就是锁定购买份额，只有锁定购买份额才能进行下面的流程，如果锁定购买份额失败直接返回，这样虽然保证了在1000万份额在购买初期必须每一个用户只能锁定一份，但是在高并发的情况下，因为购买流程中有十几个分支，每一个分支失败就会退回锁定的份额，这样就会导致这样的现象，就是可能是并发一上来，马上就满标了，过了一会进度就回退回来了。</p>\n<p>少募主要是因为分支失败回退导致的，一方面我们分析了容易导致回退热点，因为在用户抢标的时候会给用户实时的展示标的进度，在很早的版本中直接就是存入到一个标的进度表里面，并且采用了乐观锁，如果并发一高就频繁的更新失败导致回退，因此优化了标的进度这块，直接去掉了标的进度表，实时根据查询来展示标的进度（可以有延迟，有缓存）；另一方面在回退份额的时候在次判断试下memcached的份额和标的的状态，如果份额不为零并且标的状态是满标，马上自动更新状态保证后续用户可以立即购买再次驱动满标。</p>\n<p><em>做了以上的两种优化后，我们还遇到了其它的一些小问题，在不断的优化过程中，终于稳定下来；在后期版本中将考虑使用MQ队列或者redis队列来处理抢标更合理对用户也更公平一些。</em></p>\n<h2 id=\"黑客攻击\">黑客攻击</h2>\n<p>2015年应该是互联网行业受黑客攻击最多的一年吧，各互金公司都深受其害，其中我就记得网贷之家有一段时间被黑客攻击的太厉害，连续几天网站都无法打开。当然了我们也未能幸免，什么DDOS攻击、SQL注入、寻找系统漏洞等都几乎都经历过了，有的黑客还比较好，应该是出于善意或者展示自己，将漏洞放到乌云上面或者漏洞盒子里面让厂商来修复。但更多的是一些黑产完全就是威胁、敲诈想捞一笔钱，先看看下面这位吧：</p>\n<p><img src=\"http://www.ityouknow.com/assets/images/2017/optimize/hacker.png\" alt=\"\"></p>\n<p>这个家伙潜伏到我们公司的客户群里面，冒充我们的客户代表将头像和资料替换成一样，然后给群里所有的客服让他们发送我们内部的后台地址，想通过这种方式来寻找突破口，当然了这个算是里面的小菜鸟吧。</p>\n<h3 id=\"ddos攻击\">DDOS攻击</h3>\n<p>DDOS攻击我们也是遇到了很多次，确实也没有比较好办法，最后都是通过一些笨办法来尽量的避免，先说说我们的经历吧。有一次我正在敲代码，客服QQ又闪烁了起来，还没来得及打开查看信息，客服的经理电话就直接打了过来，我立刻就有一种不祥的预感，说官网打不开了，后台也登录不了。</p>\n<p>挂了电话，我在本机进行了测试果然不行，立刻准备登录VPN查看服务器各项指标，结果登录不上去，马上上楼找运维经理，他也登录不上，刚准备给机房打电话的时候，机房来电话了，说我们的一个IP正经历着1G多的流量访问，问我们是否正在做什么活动，刚话没有说完就说流量已经到5G，不到一分钟之后流量已经到达18G之多。因为我们的机房和集团公用了一个宽带入口，结果陆续的集团上面反馈他们的网站、服务也都出现了问题，机房方面害怕引起更大的冲击，直接把我们官网对外的IP封掉，集团的其它业务也才慢慢都恢复了过来，我们也紧急的更换了外网IP，重新切换了域名解析才恢复。</p>\n<p>事后我们根据apache分析了日志，流量来自N多个不同的IP地址根本无法应对，也正式因为这次攻击也才让我们领导重视了起来，将我们公司的机房网络层和公司集团彻底分离，这样的话不管那方受到大流量攻击都不会相互影响，我们也想了一些笨办法，因为上次我们更换了外网IP之后攻击也就停止了，那么我们认为肯定是针对我们外网来攻击的，所有我们就多准备了6个外网IP，当监控到对某一个外网进行攻击的时候马上切换到另一个外网地址，就这样跟他们玩，可以起到非常有限的一点作用，如果黑客真的想跟我们玩，这个办法就像是小孩子捉迷藏。</p>\n<p><strong>周年庆的DDOS攻击</strong></p>\n<p>还有一次我们正在做周年庆活动，突然有人在QQ群里面给我们客服说了一句，叫你们的技术负责人来找我，然后我们的网站就挂了，我还保留了当时的一个截图如下：</p>\n<p><img src=\"http://www.ityouknow.com/assets/images/2017/optimize/hacker02.png\" alt=\"\"></p>\n<p>完了之后客服就来找我，然后按照往常的策略处理完之后，我根据客服给我的QQ号码加上了那个人，开口就来吓我，我依稀记当年的对话如下：</p>\n<blockquote><p>黑客：你是平台的技术负责人吗？<br>\n我：算是吧<br>\n黑客：你信不信我可以让你们官网在5秒之内挂掉?<br>\n我：…（沉默，还真害怕又把官网搞挂了）<br>\n黑客：你们的官网漏洞很大<br>\n我：如果有好的建议请您赐教<br>\n黑客：你们的服务器是不是什么防护软件都没有装？<br>\n我：…（继续沉默，这会在想不会是那个安全厂商来推广产品的吧，当然我们基础的防护肯定有）<br>\n黑客：我们有非常多的肉鸡，想攻击谁，几秒之内肯定搞定<br>\n我：…<br>\n黑客：我们已经给很多互联网金融行业做了渗透测试，花点钱帮买你们平安，保证以后不会在出事情<br>\n我：…<br>\n黑客：免费的策略也有很多，比如360、百度云的安全产品可以免费低档10G左右的流量</p>\n<p>……(中间省略)</p>\n<p>黑客：我说了这多，你们也是不是给包烟钱，表示表示。</p>\n<p>……</p></blockquote>\n<p><em>后来也和领导进行了商议，坚决不能给他们钱，不能助涨这种嚣张气焰，实在不行就报警！</em></p>\n<p>曝光一下当年使用的假QQ号，刚查了下变了个头像和描述，如下：</p>\n<p><img src=\"http://www.ityouknow.com/assets/images/2017/optimize/hacker01.jpg\" alt=\"\"></p>\n<p>后来我一直在想为什么DDOS攻击总是喜欢根据外网IP来攻击呢，慢慢好像是理解了如果针对域名来攻击的话，那不就是攻击到域名商的服务器了吗,一般域名商比较强大，黑客不太搞的定，也确实没有必要。当然记的前一段时间，某著名域名服务商被攻击，导致国外twitter等著名的互联网公司访问不断到达半天以上，还是很严重的。但是对于我们这些小公司，倒不至于搞这么大的动作。</p>\n<p>到底如何正确的防止DDOS攻击：</p>\n<blockquote>\n<ul>\n<li>第一种方案，隐藏服务器外网地址，服务器前端加CDN中转，免费的有百度云加速、360网站卫士、加速乐、安全宝等，如果资金充裕的话，可以购买高防的盾机，用于隐藏服务器真实IP，域名解析使用CDN的IP，所有解析的子域名都使用CDN的IP地址。此外，服务器上部署的其他域名也不能使用真实IP解析，全部都使用CDN来解析。</li>\n</ul>\n</blockquote>\n<blockquote>\n<ul>\n<li>第二种方案，买一些安全产品来进行流量清洗，主要是阿里云、腾讯云这种大厂商提供的一种服务。</li>\n</ul>\n</blockquote>\n<blockquote>\n<ul>\n<li>第三种方案，有很多的防火墙产品声称可以防止Ddos攻击，但是我个人使用感觉效果非常有限。</li>\n</ul>\n</blockquote>\n<h3 id=\"sql注入\">SQL注入</h3>\n<p>我们的官网使用的是PHP开发，因为框架比较老旧的原因，存在着一些SQL注入的点，我们发现了一些进行了修补，没想到还是被一些黑客找到了突破点，这块还是比较感谢这些黑客的在漏洞盒子上面提交了bug(如下图)，最后我们根据提示进行了紧急修复，后来我们也在WAF防火墙配置了一些拦截SQL注入的策略，起到双保险的作用。</p>\n<p><img src=\"http://www.ityouknow.com/assets/images/2017/optimize/sql.jpg\" alt=\"\"></p>\n<p>我一直在想为什么PHP一般比较容易出现SQL注入呢，而Java较少的暴漏出来SQL漏洞的情况，我估摸着有两方面的原因：第一，PHP一般会在前端使用的较多，受攻击的机会更多一些，Java一般做为后端服务攻击的可能性会比较少；第二，PHP框架较多而且很多早期的框架并没有特别考虑SQL注入的情况，Java大量普及了mybaits\\hibernate这种orm框架，框架本身对常见的SQL注入有防止的功能，但不是说mybaits/hibernate框架就没有被sql注入的可能，大部分场景下是OK的。另外参数化查询可以有效的避免SQL注入。</p>\n<p>通过一段时间的学习，我发黑客一般先使用工具对网站做整体的扫描类似Acunetix，在根据扫描出来的漏洞做个大概的分析，但是比较深入的漏洞都需要根据网站的业务在进行调整，比如sql注入会根据页面的查询使用sqlmap等工具来进一步的渗透。当然我对这方面还是外行，描述的可能不够清晰。</p>\n<p><strong>其它攻击</strong></p>\n<p>其它方面的攻击，主要是在业务方面，比如我们当初有一个很小的失误，有一个程序员在H5的小网页中将发送短信验证码返回了前端，最后被haker发现了，利用这个漏洞可以给任意的用户重置登录密码；短信攻击，现在的网站几乎都有发送短信或者短信验证码的功能，如果前端不做校验，haker会随便写一个for循环来发短信，一般系统的短信会进行全方位的防控，比如：1、前端加验证（字符验证码，有的是拖拽的动画）;2、后端根据用户或者IP加限制，比如用户一分钟只可以发送一条短信，忘记密码的短信一天只能发送10条、一个IP地址限制每天只能发送100条短信等。</p>\n<h2 id=\"bug\">BUG</h2>\n<h3 id=\"重复派息\">重复派息</h3>\n<p>15年的某一天看到一个新闻说是陆金所的一个用户发现自己银行里面突然多了很多钱，没过多久又被扣走了，然后收到陆金所那边的解释，说是给用户还本派息的时候程序出现了问题导致还本派息两次，当他们程序员发现了此问题后紧急进行了处理，用户当然闹了呀，就上了新闻，当然陆金所通道能力确实比较强可以直接从用户卡里面扣，当大家都兴致勃勃的谈论这个话题的时候，我却有一股淡淡的忧伤，为什么呢?因为这个错误我们也犯过，具体说就是我搞的，大家可不知道当时的心里压力有多大！</p>\n<p>事情是这样子的，我们使用的第三方支付的扣款接口不是特别的稳定，于是我们前期就对接了两种不通的扣款接口，平时前端投资的时候走一个接口，后端派息或者还本的时候走另外的一个接口，在初期的时候扣款接口不稳定，因此在给用户跑批的时候经常会有个别用户失败，需要手动给失败的用户二次派息。做为一个有志向的程序员当然觉得这种方式是低效的，于是将程序改造了一下，在后端派息的时候当第一种扣款失败的时候，自动再次调用第二种扣款接口进行扣款，当时想着这种方式挺好的，各个环境测试也没有问题，上线之后监控过一段时间也运行稳定。</p>\n<p>当我感觉一切都很美妙的时候，事故就来了，突然有一天客服反馈说有的用户说自己收到的利息感觉不对，好像是多了（真的是太感谢这个用户了），我登录后台看了一下派息的流水复核了一遍，果然利息被重复派了，一股冷水从头而下，把当天所有的用户派息记录和到期记录都进行了检查，影响了70多个用户，导致多派息了6万多元，幸亏只是派息出了问题，如果是到期的话金额会翻N倍，其中70多个人里面有几个进行了提现、几个进行了再次投资，绝大部分用户在我们发现的时候还不知情，金额也没有动。</p>\n<p>怎么处理呢，当然不能直接就动用户的钱了，给每个重复派息的用户打电话，说明原因赠送小礼物，请求谅解后我们把重复派过的利息在次调回来。大部分用户进行了核对之后都还是比较配合的，但是肯定有一些用户不干了，当然也不能怪客户，都是我的原因，有的客户需要上门赔礼道歉，有的客户需要公司出具证明材料，我们的老板亲自给客户打了N个电话被客户骂了N遍，我心里压力可想而知，其中有一个客户特别难缠，各种威胁说既然到了我的账户里面肯定是我的，你们的失误不应该让他来承担，折腾了很久，还是不能怪客户。可能会说有的互联网公司经常出现这种问题后就送给客户了，哎，我们是小公司呀！这个噱头玩不起。</p>\n<p>到底是什么原因呢，事后进行了复盘也给领导做了汇报，平时都是首先进行派息的定时任务，过一个小时之后进行到期的定时任务，当天的派息标的比较多，跑了一个半小时，就导致了派息和到期的两个定时任务同时进行，转账有了并发，第三方支付的接口不稳定给我们返回的失败，其实有的是成功的，就导致了我们进行了二次的扣款尝试引发了此问题。这个事情给我带来了非常大的教训，对于金融扣款的这种事情一定需要谨慎，哪怕付款引发报警之后在人工处理，也不能盲目重试可能引发雪崩效应。</p>\n<h3 id=\"杂七杂八\">杂七杂八</h3>\n<p>还有就是其它一些零碎的问题了，记的有一次对用户的登录过程进行优化，导致有一块判断少了一个括号结果用户在那两个小时内，只要输入账户，任意密码就可以登录了，幸好及时发现这个问题，正是这个问题才导致了我们正式确立了规范的上线流程，为以后的上线制度建定了基础。</p>\n<p>还有一次我们在模拟用户投资一种标的时候，留了一个入口通过http就可以调用，测试也没有问题，有一天正好给领导演示呢，就在次用http请求的方式在浏览器执行了一下，前端就会看到自动投标的过程，因为生产的数据有点多，投标的过程有点长，我们为了加快进度，找了好几个人同时来执行这http请求，导致最后出现了问题，最后发现写测试脚本的这个同事根本就没有考虑并发的情况，才导致出现了问题。</p>\n<p>也做了很多的活动，记得做一个网贷之家的一个活动的时候，活动上线比较紧张，我们团队曾经连续工作超过30个小时（一天一夜再一天），当天晚上我2点左右写完程序，测试从2两点测试到早上9点，最终确认没有任何问题，才进行投产。半夜公司没有暖气，我们实在冻的不行了，就在办公室跑步，从这头跑到那头，第二天上线之后，又害怕出现问题，监控了一天，确认没有任何问题，才到下午正常下班回家，那时候真是激情满满呀。</p>\n<p>说到做活动肯定少了羊毛党，说哪一家互金公司没有遇到过羊毛党那很少见，而且现在的羊毛党规模简直逆天了，我们用户里面就有一个羊毛党在两三天之内邀请了六七千位用户，如果说邀请一个用户送1元，那这个用户就可以搞几千块一次，而且有很多专业的网站、QQ群、微信公共账号都是他们的聚集地，那天那个平台有活动门清，他们写的淘羊毛操作手册有时候比我们官网的帮助文档还清晰，所以做活动的时候要考虑特别周全，各种限制，有封定、有预案、讲诚信，只要是符合我们活动规则的坚决按照流程走。</p>\n<p>还有一个有趣的事情，app推送，一次我在公交车上就看到xx盒子app弹出hhhhh的推送，这个事情我们也搞过，因为在调试的时候生产和测试就差了一个参数，有时候开发人员不注意就把生产参数部署到uat环境了，测试一发送就跑到生产了，这方面只能严格流产管理来防止了。</p>\n<p>其实还很多问题：mongodb集群和mysql的同步出现的一些状况、后台大量数据查询下的sql优化、golang使用mapreduce碰到的问题… 限于篇幅这里就不一一清晰的描述了。</p>\n<p>其实每次的出现问题都是对团队一次非常好的锻炼机会，通过发现问题，定位问题，解决问题，再次回过头来反思这些问题；重新梳理整个环节， 举一反三避免下次再次出现类似的问题。正是因为经历这些种种的困难、考验才让团队变的更强大更稳定，也更体现了流程的重要性，更是避免再次发生类似问题。</p>\n<h2 id=\"总结\">总结</h2>\n<p>古代对将军的要求是，心有万马奔腾而过，而面平静如湖水可照镜，在互联网行业对大牛的要求也同如此，特别是技术的负责人，在面对生产事故的时候，一定首先是安抚同事，静下下心来找到问题本质在去解决，而不是不断去施加压力催促解决，重压之下很多心里承受能力稍弱的队友，更加慌乱而不利于解决问题或者引发二次事故。</p>\n<p>在看淘宝双十一视频中，有一段特别受到感触，在双十一初期，虽然技术团队做了很多的准备，但是在零点过后流量瞬间涌入，服务被打垮，部分用户投诉刷新不出网页，紧接着隔壁同事也都反馈网站打不开，在大家都在慌乱中，xx一拍桌子大喊一声，大家都别动，三分钟之后再说，过了几分钟之后服务慢慢部分恢复了正常。后来回忆说，当时虽然服务瘫痪，但是监控还是有部分得业务成功，说明系统并没有被压垮，而此时的任何操作都有可能引发更大的问题，从此之后此人一战成名，成为阿里大将。</p>\n<p>互联网平台发展大抵都会经历三个阶段：</p>\n<ul>\n<li>1、上线初期，此阶段问题最为繁多，生产事故不断，系统快速迭代优化。有人说为什么不测试到完全没有问题在投产吗？说实话在互联网行业这个很难，第一小公司很难做到生产环境和测试环境一致，成本太高；时间紧迫，一般都是很短的时间内要求上线，上线之后在快速迭代。另外互联网本就是一个快速试错的行业，错过半年时间可能风口早过；</li>\n<li>2、发展期，此阶段主要业务模式已经得到验证，系统出现问题的频繁度较少，低级错误减少，但此时是用户量和交易量不断爆发的时候，对系统性能、高并发的要求又上来了，所以此时出现的问题大多都是性能的问题；</li>\n<li>3、成熟期，发展期过后系统相对比较平稳，用户量和交易量都已经慢慢稳定下来，生产问题越来越少，出现问题几乎都是细小的bug，这个阶段也是公司最忽略技术得阶段，恰好我们公司就处于这个阶段，在这个阶段就需要静下心里，组织架构升级，补齐在初期和发展起所欠的技术债务，做好公司在升下一个量级的技术准备。</li>\n</ul>\n<blockquote><p>所有的这些问题几乎都集中在14年底到15年初的这个阶段，15年后半年开始到现在平台慢慢稳定了下来，到现在几乎没有再出现过类似的问题，也因为几乎都是两年前的事情，有很多记的不是特别清楚了，写的比较粗糙望见谅。</p></blockquote>\n<div><!-- 多说评论框 end --> <!-- 多说公共JS代码 start (一个网页只需插入一次) --> <!-- 多说公共JS代码 end --></div>\n</div>\n\r\n        \r\n            <blockquote class=\"rewards\">\n        <p><strong>打赏支持我写出更多好文章，谢谢！</strong></p>\n        <a href=\"#rewardbox\" id=\"rewards-button\" class=\"fancybox\"><span class=\"btn-bluet-blue href-style\"><i class=\"fa fa-jpy\"></i> 打赏作者</span></a>\n    </blockquote>\n\n    <div id=\"rewardbox\">\n        <h4>打赏支持我写出更多好文章，谢谢！</h4>\n                <p>任选一种支付方式</p>\n                <p>\n                        <img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/bdbb2fd2100937012521bcca7666214a.png\">\n            \n                            <img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/4d73722317836066abc1944476af6821.jpg\">\n                    </p>\n    </div>\n\n    \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"110255\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"110255votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"110255\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 1 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/ityouknow\">纯洁的微笑</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/ityouknow\">\r\n\t\t\t<img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/7a2dae804fcc41edb889ce67f7973c58.jpg\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            一个热爱程序的人        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/ityouknow\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/ityouknow/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/ityouknow/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 13</a> · <a title=\"我的网站\" target=\"_blank\" href=\"http://www.ityouknow.com/\"><i class=\"fa fa-link\"></i></a> <a title=\"微博主页\" target=\"_blank\" href=\"http://weibo.com/ityouknow\"><i class=\"fa fa-weibo\"></i></a> <a title=\"QQ：863865929\" target=\"_blank\" href=\"#\"><i class=\"fa fa-qq\"></i></a> <a title=\"GitHub主页\" target=\"_blank\" href=\"https://github.com/ityouknow\"><i class=\"fa fa-github\"></i></a>         </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2012/05/Security-logo.jpg"], "tags": "IT技术,安全", "url_object_id": "4d2861df39e731258f243c6a4d0f35d8", "title": "百亿互金平台救火故事", "comment_nums": 0, "front_image_path": "full/1ef0c99044632a162ca37b8246f9136048574deb.jpg", "create_date": "2017/02/20"}
{"url": "http://blog.jobbole.com/110287/", "praise_nums": "2", "fav_nums": 13, "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"><p><script src=\"http://www.imooc.com/open/courselistrandjs\"></script><span style=\"display:block;margin-bottom:10px;\"></span></p>\n</div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a target=\"_blank\" href=\"http://www.jianshu.com/p/dc859753a035\">fuck两点水</a>   </div><h1>一、前言</h1>\n<blockquote><p>2017年1月27日19:05:28，今天是年三十，首先祝大家新年快乐，之前对自己要求过，每星期一篇面试题的博客，虽然今天心里有一万个不愿意写，也还是得写。这篇博客是 2016 腾讯软件开发面试题中不定项选择题集合中的 1 -12 题，其中后面的 13-25题在下周的博客中写，说明一下，这篇博客跟以往的每周一题有点不同，因为如果选择一两题，博客的边幅有点少，而且选择题相对来说，难度没那么大，更主要的是为了让大家全面的感受一下腾讯的面试题。</p></blockquote>\n<h1>二、2016 腾讯软件开发面试题（不定项选择题【1-12】）</h1>\n<blockquote><p>1、已知一棵二叉树，如果先序遍历的节点顺序是： ADCEFGHB ，中序遍历是： CDFEGHAB ，则后序遍历结果为：（ ）</p>\n<p>A. CFHGEBDA<br>\nB. CDFEGHBA<br>\nC. FGHCDEBA<br>\nD. CFHGEDBA</p></blockquote>\n<p><strong>知识点</strong></p>\n<p>对于二叉树的遍历方式一般分为三种先序、中序、后序三种方式：</p>\n<ul>\n<li>先序遍历（根左右）<br>\n若二叉树为空，则不进行任何操作：否则<br>\n1、访问根结点。<br>\n2、先序方式遍历左子树。<br>\n3、先序遍历右子树。</li>\n<li>中序遍历 （左根右）<br>\n若二叉树为空，则不进行任何操作：否则<br>\n1、中序遍历左子树。<br>\n2、访问根结点。<br>\n3、中序遍历右子树。</li>\n<li>后序遍历 （左右根）<br>\n若二叉树为空，则不进行任何操作：否则<br>\n1、后序遍历左子树。<br>\n2、后序遍历右子树。<br>\n3、放问根结点。</li>\n</ul>\n<p>因此，根据题目给出的先序遍历和中序遍历，可以画出二叉树：</p>\n<div>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/6c1c614f9592504fde0da0c47f3a7a8e.png\"></p>\n<div>二叉树遍历.png</div>\n</div>\n<p>最后结果选择： D</p>\n<hr>\n<blockquote><p>2、下列哪两个数据结构，同时具有较高的查找和删除性能？（ ）</p>\n<p>A. 有序数组<br>\nB. 有序链表<br>\nC. AVL 树<br>\nD. Hash 表</p></blockquote>\n<p><strong>知识点</strong></p>\n<div>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/efc7df47045fe8a29fdfcb2a2da04693.png\"></p>\n<div>几种常见的数据结构操作性能.png</div>\n</div>\n<p>平衡二叉树的查找，插入和删除性能都是 O(logN) ，其中查找和删除性能较好；哈希表的查找、插入和删除性能都是 O(1) ，都是最好的。所以最后的结果选择： CD</p>\n<hr>\n<blockquote><p>3、下列排序算法中，哪些时间复杂度不会超过 nlogn？（ ）</p>\n<p>A. 快速排序<br>\nB. 堆排序<br>\nC. 归并排序<br>\nD. 冒泡排序</p></blockquote>\n<p><strong>知识点</strong></p>\n<div>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/775d4eb0006d3068acf65313c6d951ff.png\"></p>\n<div>几种常见的排序算法对比.png</div>\n</div>\n<p>根据上图，观察平均情况，最好最差情况的时间复杂度基本可以知道答案了，最后结果选择： BC</p>\n<hr>\n<blockquote><p>4、初始序列为 1 8 6 2 5 4 7 3 一组数采用堆排序，当建堆（小根堆）完毕时，堆所对应的二叉树中序遍历序列为：（ ）</p>\n<p>A. 8 3 2 5 1 6 4 7<br>\nB. 3 2 8 5 1 4 6 7<br>\nC. 3 8 2 5 1 6 7 4<br>\nD. 8 2 3 5 1 4 7 6</p></blockquote>\n<p>初始化序列：1 8 6 2 5 4 7 3,，小根堆就是要求结点的值小于其左右孩子结点的值，左右孩子的大小没有关系，那么小根堆排序之后为：1 2 4 3 5 6 7 8；</p>\n<p>中序遍历：左根右，故遍历结果为：8 3 2 5 1 6 4 7</p>\n<p>故最后选择的结果： A</p>\n<hr>\n<blockquote><p>5、当 n = 5 时，下列函数的返回值是：（ ）</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-58ad9f02b72fc424993565\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n[cpp] view plaincopy\r\nint foo(int n)  \r\n{  \r\n    if(n&lt;2)return n;  \r\n    return foo(n-1)+foo(n-2);  \r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-58ad9f02b72fc424993565-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58ad9f02b72fc424993565-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-58ad9f02b72fc424993565-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58ad9f02b72fc424993565-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-58ad9f02b72fc424993565-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58ad9f02b72fc424993565-6\">6</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-58ad9f02b72fc424993565-1\"><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">cpp</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">view </span><span class=\"crayon-e\">plaincopy</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58ad9f02b72fc424993565-2\"><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">foo</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">n</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\">  </span></div><div class=\"crayon-line\" id=\"crayon-58ad9f02b72fc424993565-3\"><span class=\"crayon-sy\">{</span><span class=\"crayon-h\">  </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58ad9f02b72fc424993565-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">if</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">n</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">)</span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">n</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\">  </span></div><div class=\"crayon-line\" id=\"crayon-58ad9f02b72fc424993565-5\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">foo</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">n</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">+</span><span class=\"crayon-e\">foo</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">n</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\">  </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58ad9f02b72fc424993565-6\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0012 seconds] -->\r\n<p>A．5<br>\nB．7<br>\nC．8<br>\nD．1</p></blockquote>\n<p>这题只需把数代进去，就可以知道结果了，所以最后结果选： A</p>\n<div>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/deb22b0fb477b79b1fd14d762bdfa49d.png\"></p>\n<div>递归.png</div>\n</div>\n<hr>\n<blockquote><p>6、 S 市 A ，B 共有两个区，人口比例为 3：5 ，据历史统计 A 区的犯罪率为 0.01% ，B 区为 0.015% ，现有一起新案件发生在 S 市，那么案件发生在 A 区的可能性有多大？（ ）</p>\n<p>A．37.5%<br>\nB．32.5%<br>\nC．28.6%<br>\nD．26.1%</p></blockquote>\n<p>这道题首先得了解犯罪率是什么？犯罪率就是犯罪人数与总人口数的比。因此可以直接得出公式：( 3 <em> 0.01% ) / ( 3 </em> 0.01% + 5 * 0.015% ) = 28.6%</p>\n<p>当然如果不好理解的话，我们可以实例化，比如 B 区假设 5000 人，A 区 3000 人，A 区的犯罪率为 0.01%，那么 A 区犯罪人数为 30 人，B 区的犯罪率为 0.015% ，那么 B 区的犯罪人数为 75 人 ，求发生在 A 区的可能性，就是说 A 区的犯罪人数在总犯罪人数的多少，也就是 30/(30+75)=0.2857</p>\n<p>当然，也可以回归到我们高中遗忘的知识：</p>\n<p>假设C表示犯案属性<br>\n在A区犯案概率：P(C|A)=0.01%<br>\n在B区犯案概率：P(C|B)=0.015%<br>\n在A区概率：P(A)=3/8<br>\n在B区概率：P(B)=5/8<br>\n犯案概率：P(C)=（3/8<em>0.01%+5/8</em>0.015%)<br>\n根据贝叶斯公式：P(A|C) = P(A,C) / P(C) = [P(C|A) P(A)] / [ P(C|A) P(A)+ P(C|B) P(B) ] 也可以算出答案来</p>\n<p>故，最后结果选择为： C</p>\n<hr>\n<blockquote><p>7、Unix系统中，哪些可以用于进程间的通信？（ ）</p>\n<p>A．Socket<br>\nB．共享内存<br>\nC．消息队列<br>\nD．信号量</p></blockquote>\n<p><strong>知识点</strong></p>\n<ol>\n<li>管道（Pipe）及有名管道（named pipe）：管道可用于具有亲缘关系进程间的通信，有名管道克服了管道没有名字的限制，因此，除具有管道所具有的功能外，它还允许无亲缘关系进程间的通信；</li>\n<li>信号（Signal）：信号是比较复杂的通信方式，用于通知接受进程有某种事件发生，除了用于进程间通信外，进程还可以发送信号给进程本身；linux除了支持Unix早期信号语义函数sigal外，还支持语义符合Posix.1标准的信号函数sigaction（实际上，该函数是基于BSD的，BSD为了实现可靠信号机制，又能够统一对外接口，用sigaction函数重新实现了signal函数）；</li>\n<li>报文（Message）队列（消息队列）：消息队列是消息的链接表，包括Posix消息队列system V消息队列。有足够权限的进程可以向队列中添加消息，被赋予读权限的进程则可以读走队列中的消息。消息队列克服了信号承载信息量少，管道只能承载无格式字节流以及缓冲区大小受限等缺点。</li>\n<li>共享内存：使得多个进程可以访问同一块内存空间，是最快的可用IPC形式。是针对其他通信机制运行效率较低而设计的。往往与其它通信机制，如信号量结合使用，来达到进程间的同步及互斥。<br>\n信号量（semaphore）：主要作为进程间以及同一进程不同线程之间的同步手段。</li>\n<li>套接口（Socket）：更为一般的进程间通信机制，可用于不同机器之间的进程间通信。起初是由Unix系统的BSD分支开发出来的，但现在一般可以移植到其它类Unix系统上：Linux和System V的变种都支持套接字。</li>\n</ol>\n<p>故最后选择的结果为： ABCD</p>\n<hr>\n<blockquote><p>8、静态变量通常存储在进程哪个区？（ ）</p>\n<p>A．栈区<br>\nB．堆区<br>\nC．全局区<br>\nD．代码区</p></blockquote>\n<p>静态变量的修饰关键字：static，又称静态全局变量。故最后选择的结果为： C</p>\n<hr>\n<blockquote><p>9、查询性能（ ）</p>\n<p>A． 在Name字段上添加主键<br>\nB． 在Name字段上添加索引<br>\nC． 在Age字段上添加主键<br>\nD． 在Age字段上添加索引</p></blockquote>\n<p>结果选: B</p>\n<hr>\n<blockquote><p>10、IP地址131.153.12.71是一个（B）类IP地址。</p>\n<p>A．A<br>\nB．B<br>\nC．C<br>\nD．D</p></blockquote>\n<p><strong>知识点</strong></p>\n<div>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/8a89274df809ca4820a309c13dccdc9a.png\"></p>\n<div>IP地址分类.png</div>\n</div>\n<p>故将 131 转为二进制 ：10000011，因此为 B 类 IP 地址，结果选 B</p>\n<hr>\n<blockquote><p>11、下推自动识别机的语言是：（C）</p>\n<p>A．0型语言<br>\nB．1型语言<br>\nC．2型语言<br>\nD．3型语言</p></blockquote>\n<p><strong>知识点</strong></p>\n<p>这是有关编译原理的。</p>\n<p>乔姆斯基体系是计算机科学中刻画形式文法表达能力的一个分类谱系，是由诺姆·乔姆斯基于1956年提出的。它包括四个层次：</p>\n<ul>\n<li>0-型文法（无限制文法或短语结构文法）包括所有的文法。该类型的文法能够产生所有可被图灵机识别的语言。可被图灵机识别的语言是指能够使图灵机停机的字串，这类语言又被称为递归可枚举语言。注意递归可枚举语言与递归语言的区别，后者是前者的一个真子集，是能够被一个总停机的图灵机判定的语言。</li>\n<li>1-型文法（上下文相关文法）生成上下文相关语言。这种文法的产生式规则取如 αAβ -&gt; αγβ 一样的形式。这里的A 是非终结符号，而 α, β 和 γ 是包含非终结符号与终结符号的字串；α, β 可以是空串，但 γ 必须不能是空串；这种文法也可以包含规则 S-&gt;ε ，但此时文法的任何产生式规则都不能在右侧包含 S 。这种文法规定的语言可以被线性有界非确定图灵机接受。</li>\n<li>2-型文法（上下文无关文法）生成上下文无关语言。这种文法的产生式规则取如 A -&gt; γ 一样的形式。这里的A 是非终结符号，γ 是包含非终结符号与终结符号的字串。这种文法规定的语言可以被非确定下推自动机接受。上下文无关语言为大多数程序设计语言的语法提供了理论基础。</li>\n<li>3-型文法（正规文法）生成正规语言。这种文法要求产生式的左侧只能包含一个非终结符号，产生式的右侧只能是空串、一个终结符号或者一个非终结符号后随一个终结符号；如果所有产生式的右侧都不含初始符号 S ，规则 S -&gt; ε 也允许出现。这种文法规定的语言可以被有限状态自动机接受，也可以通过正则表达式来获得。正规语言通常用来定义检索模式或者程序设计语言中的词法结构。</li>\n</ul>\n<p>正规语言类包含于上下文无关语言类，上下文无关语言类包含于上下文相关语言类，上下文相关语言类包含于递归可枚举语言类。这里的包含都是集合的真包含关系，也就是说：存在递归可枚举语言不属于上下文相关语言类，存在上下文相关语言不属于上下文无关语言类，存在上下文无关语言不属于正规语言类。</p>\n<p>四种类型的文法的主要特点：</p>\n<div>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/8da8f268cf91b9801f4cb9bfac5da381.png\"></p>\n<div>四种类型的文法的主要特点.png</div>\n</div>\n<p>因此答案选择：B</p>\n<hr>\n<blockquote><p>12、下列程序的输出是：（ ）</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-58ad9f02b730c266544739\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-mac print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n[cpp] view plaincopy\r\n#define add(a+b) a+b  \r\nint main()  \r\n{  \r\n    printf(“%dn”，5*add(3+4));  \r\n    return ;  \r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-58ad9f02b730c266544739-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58ad9f02b730c266544739-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-58ad9f02b730c266544739-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58ad9f02b730c266544739-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-58ad9f02b730c266544739-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58ad9f02b730c266544739-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-58ad9f02b730c266544739-7\">7</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-58ad9f02b730c266544739-1\"><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">cpp</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">view </span><span class=\"crayon-v\">plaincopy</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58ad9f02b730c266544739-2\"><span class=\"crayon-p\">#define add(a+b) a+b  </span></div><div class=\"crayon-line\" id=\"crayon-58ad9f02b730c266544739-3\"><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">main</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\">  </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58ad9f02b730c266544739-4\"><span class=\"crayon-sy\">{</span><span class=\"crayon-h\">  </span></div><div class=\"crayon-line\" id=\"crayon-58ad9f02b730c266544739-5\"><span class=\"crayon-h\">    </span><span class=\"crayon-e\">printf</span><span class=\"crayon-sy\">(</span>“<span class=\"crayon-o\">%</span><span class=\"crayon-i\">dn</span>”，<span class=\"crayon-cn\">5</span><span class=\"crayon-o\">*</span><span class=\"crayon-e\">add</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">3</span><span class=\"crayon-o\">+</span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\">  </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58ad9f02b730c266544739-6\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\">  </span></div><div class=\"crayon-line\" id=\"crayon-58ad9f02b730c266544739-7\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0009 seconds] -->\r\n<p>A．23<br>\nB．35<br>\nC．16<br>\nD．19</p></blockquote>\n<p>因为我主要是 java 开发的，可是毕竟 c 和 c++ 都是大学的必修课，因此还是有点了解的。这里主要看清楚 define ，#define 的本质就是一个代换，题目 <code>#define add(a+b) a+b</code>表明了 add(a+b) 替换成 a+b ，因此代码输出的那一行其实是 <code>printf(“%dn”，5*3+4);</code> ,所以最后的结果选择 D</p>\n<h1>三、祝福</h1>\n<blockquote><p>2017年1月27日20:17:36 终于写完了，最后还是祝福大家，新年快乐，心想事成。哈哈，可以去玩耍了。</p></blockquote>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"110287\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"110287votetotal\">2</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"110287\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 13 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i> 5 评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2016/05/4948ccb1834e8e6c428160f801eea04d.jpg"], "tags": "职场,面试", "url_object_id": "71acdc4ac6f4055b56e31c70cfa8248d", "title": "2016 腾讯软件开发面试题（部分）", "comment_nums": 5, "front_image_path": "full/99851886bb0ea92c5c3369561f2b2d7adb684b2f.jpg", "create_date": "2017/02/18"}
{"url": "http://blog.jobbole.com/110280/", "praise_nums": "3", "fav_nums": 3, "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"><p><script src=\"http://www.imooc.com/open/courselistrandjs\"></script><span style=\"display:block;margin-bottom:10px;\"></span></p>\n</div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a target=\"_blank\" href=\"http://www.jianshu.com/p/58962c334a35\">董泽润</a>   </div><div>\n<p>2012年初入职赶集，当时处在流量讯猛增长的阶段，3年DBA生涯收获坡多，其实坑更多(泪… 后来在做开发时，慢慢体会到 ”运维“ 和 “开发” 确实存在沟通问题：知识不对称。如何解决呢？先总结下这三年吧</p>\n<hr>\n<h4>DBA职责</h4>\n<p>市面上招聘 JD 一大堆，随变找几个，马上能找出共性</p>\n<ul>\n<li>数据库系统的规划、设计、管理、迁移</li>\n<li>数据库的日常维护、备份、优化及恢复</li>\n<li>Master-Slave架构搭建、维护</li>\n<li>业务系统上线支持，数据库设计评审，提供架构方案</li>\n</ul>\n<p>数据库不局限于 MySQL, Oracle, 如果分的不细，还会有 Redis, MongoDB 等一系列 NoSQL。工作内容都一样，首先是高可用稳定性，不能今天抖动明天宕机，涉及工作很多。第二个是数据安全，比如备份及恢复，14年赶集审计，移动端的活跃用户数就是从备份中恢复来的，可见备份的有效性是重中之重。最后一个当然是为业务服务，对接业务需求，不能因个人生活被打断就罢工，有一次刚看电影就被叫回去处理DB报警，骂娘的心都有了。</p>\n<h4>悲惨案例</h4>\n<p>先举一些悲惨案例，让看官们高兴一下~ 由于公司早就不在了，这里没有顾忌。</p>\n<h5>1. delete 删全表</h5>\n<p>二手车同学的锅，SQL 拼错不带 where 条件，编写线下脚本时出错… 最后DBA根据 row binlog 恢复。至少2次:(</p>\n<p>反思：rd 新手一茬又一茬，规范讲再多也没用。最彻底的解决方式只有一个，接入 proxy, 限制一切非法 sql。另外 rd 上线验证也不到位，代码 review 肯定有缺失</p>\n<h5>2. 大卖家问题</h5>\n<p>房产在14年开通免费端口，短短几个月时间房产商业表爆涨到 100G，个别中介帐号发贴超过10W，导致数据库异常抖动，威哥临时清理过多发贴记录解决。最后耗时三个月对这张表进行瘦身，拆分 text 字段。</p>\n<p>反思：DBA 对大表监控不足</p>\n<h5>3. 大量子查询打跨主库</h5>\n<p>主站主库有一次被子查询打跨，事后排查，由于 RD 大量子查询导致。此类问题不是个案，有很多 RD 把本本该读 slave 的请求写到 master 上，只不过没有引起事故而已</p>\n<p>反思：赶集 DB 典型 1 主 N 从，没有 proxy 保护的怀况下，经常出现此类问题，只靠规范制度基本解决不了</p>\n<h5>4. 报表 olap 库问题</h5>\n<p>RP 库我和文武背锅，年底的绩效垫底。文武接手前的 RD 一个人开发中介商家报表系统，所有计算都是基于 DB，当免费端口开放后数据量爆涨，MyISAM 读写锁导致大量请求阻塞，听说公司因为报表连续问题赔商家300W。</p>\n<p>反思：这个事故得站在高处去看，免费端口开放太突然，项目技术负责人考滤不全。报表系统没有经过设计，完全由一个新人RD去搞，也就大学毕设水平，回头再看，hadoop spark 完全搞定。最后 DBA 没有及时对大表进行跟踪，没有提前发现。</p>\n<h5>5. 50G的Redis</h5>\n<p>房产业务 Redis 眼看从 20G 爆涨到 50G，我离开后也一直没优化掉。后来某次故障，数据清空了？</p>\n<hr>\n<h4>我的工作</h4>\n<p>大部份时间和开发沟通感情聊人生，后来 automan 上线很少有人找我了~ 每个阶段都有成长，都有感谢的人和事，赶集让我有平台去做感兴趣的事，很开心。</p>\n<p>刚到赶集时，SQL 上线还走的 jira，半自动化由运维开发同学做的，经常在技术大群里被艾特，很简单的建表或是DML 都要由 DBA 人工介入，很烦索。另外很多建表语句不规范，打回让 RD 修改，他们对此很有意见，认为无所谓的修改，这就在 RD和 DBA之间产生了沟通成本，诗展在的时候还会定期做数据库开发培训，然后就没有然后了。</p>\n<p>14年中着手 automan 平台开发，从前台页面到后端消息队列，到 sql parser 解析，从无到有，在刘军先河同学的帮助下最终上线完成。由平台去审核开发的 SQL，经过 sim 模拟环境，再到线上自动执行备份，比人工高效的多。</p>\n<p>这个系统原理和市面上其它工具差不多，扔有很大改进的地方。后来在数据库大会分享了一次，诚惶诚恐没有被喷。</p>\n<h4>DBA 心得</h4>\n<ul>\n<li>夯实基础：DB 的基础自然是稳定，稳定，再稳定。实例数一多，基本每天都会遇到各种故障。主挂了就用 MHA 切换(最新的有gtid)，slave 挂掉就由 lvs 自动摘掉读流量。还有一个就是备份，全量增量，定期备份有效性检测，每一块都需要人力的投入。</li>\n<li>硬件优先：DB扩容有 scale up 和 scale out 两种，一般优先堆硬件。buffer 不够加内存，128G 不够就 192G，磁盘阵列卡性能不行就上 SSD，再不行就上 flash 板卡。总之优先考滤硬件，争取架构优化的时间。</li>\n<li>未雨绸缪：慢 SQL 优化，定期出报表让 RD 调优，一般出问题都是索引没加，99%的大SQL都是这样，少部份因为表设计不合理(没有自增主键，或是频烦修改)。大表监控，该瘦身的瘦身，字段该拆的拆，横竖两刀，过期数据定期归档，基本上就这些事。</li>\n<li>结合业务：有些优化 DBA 累的半死，不如 RD 修改一行代码。DBA 也要多和业务接触，了解业务实现，不求给业务贡献多少，不背锅就好… 开玩笑。了解业务，就能站在更高的角度去思考，很有意义。</li>\n<li>学会拒绝：这个拒绝不是罢工不干活，而是要分清哪些需求的合理性与紧急性，不合理也不紧急的直接干掉，紧急但不合理的可以临时通过，快速解决问题，事后再确掉也可以。比如 olap 跑在了线上库，count(*) 计数 SQL 完全可以异步走计数器，Redis 是好东西。</li>\n<li>学会沟通：工作也有些年头了，这一点仍然在学习，也犯过不少错。沟通好权责，定下时间表。</li>\n<li>踏实学习：回头看当年DBA做的不够好，有些原因在于没有开发能力，很多想法止步于此。运维人员一定要有开发功力，并且要比业务 RD 更精，才能做好运维。</li>\n</ul>\n<h4>运维RD的矛与盾</h4>\n<p>KPI 不同，关注点自然也不同，一线的同学经验也都有欠缺，特别是刚工作1~2年的，造成了信息与知识的不对称。解决这个问题也不难：</p>\n<ul>\n<li>新人要有导师带，对新人放手不管最不负责。这方面感觉 nice 做的不错。该夸还是要夸的。</li>\n<li>支撑团队要有足够的 wiki 业务文档说明。</li>\n<li>自动化用技术来约束，而不是人工。同比业务接口强约束，现在服务化都用 thrift 了。</li>\n</ul>\n<hr>\n<p>对赶集的记忆已经越来越模糊了，唯有…</p>\n<p>总结写了一部份后，原同事都说遗漏了一些，那就一齐追加到后面，版权不归我:)</p>\n<hr>\n<p>20170214 下面内容来自原同事： 李瑞</p>\n<p>回忆下赶集的dba生活</p>\n<p>总结下就是各种故障多，随时候命，需要处理，这些直到automan出来，强制rd通过平台上线后，稍微好点。</p>\n<ol>\n<li>因为raid0的问题，至少遇到4-5次master硬盘的问题，需要紧急处理。<br>\ntg 遇到1次，ms 切过次，貌似也是磁盘的问题。<br>\n其他slave 备份机，硬盘出故障更是多，最多一周需要处理4起磁盘的问题。而赶集的mysqldb 普遍都大至少100G，数据报表库的磁盘有2.3T，没法通过备份的方式重架从库，我用了2-3周才搞定</li>\n<li>im 的swap 问题<br>\nIm 的swap问题，肯定是sql的问题，主要的查询sql 是通过order by，count 来获取数据，这个问题，从我进去赶集到出来一直是无法解决。只能是手动lvs切流量，重启slave，再lvs回切流量 解决swap的问题。1周几乎需要1-2次。告诉过im同事几次im sql问题，希望对count查询可以自己做个计数器，不过最后也没下文了。关闭swap 又怕服务器会经常oom。 最后还是赵慎举同学来了后，开启了预热innodb_buffer_pool的参数后，可以直接重启slave，而不怕因为预热的问题load突增。其他赵慎举同学改了numa限制内存，不过im的swap是最后也没解决。</li>\n<li>备份<br>\n备份的问题，1是磁盘空间的问题，1个还是raid0的问题。。<br>\n最后你们走后，有1个月我独立支撑，直到毕常奇来了，6台，还是7台备份机，硬盘坏的是此起彼伏。 Log库，emp，还有王绪峰组,我忘记了业务线的名称了，暴涨到800G的数据，备份机坏了，再加上空间不足。我索性停了备份，最后只保证了ms，hp,tg,tc一些大库的备份，这个58同事接手后估计会被他们鄙视坏了。<br>\n这个其实后来华为32T的备份机来了以后，备份机制应该变通的，怪我<br>\n还有异机备份，每2个月 4个2T盘就会保存满了，更换，挪盘，手动做raid挂盘，手动excle做记录。最后还真有次要用到这些盘查找数据。</li>\n<li>磁盘问题<br>\nHp 俩个大表，需要定期清理数据。Ms 磁盘每天10G的增长速度，而且ms需要用pcie卡，最后终于可以从800 扩到1200。可以消停几个月。Ms 有几个台机器，最后就差10G 左右就要满了。各种删日志，各种挪数据，东墙补西墙，（搞的我知道400G 的ssd 做xfs 要比ext4 能省20G 的空间，刚刚好够给ms用），而且磁盘的增长，伴随着备份机，磁盘空间不足，sim机（提供只读服务给开发的我忘记叫什么了）空间不足。还有report库，想申请磁盘，服务器，机柜没有位置了，就那样挺着单库跑了很久。</li>\n<li>还有就是王绪峰组 和tc 的 通过框架生成的sql<br>\n生成多余的子表，varchar 类型的字段条件不加单引，再加上上线建表不加索引，定期需要检查sql，进行优化。</li>\n<li>痛苦的hp，主库拆分。<br>\n历时1年多，没有分拆完整 。最后听毕常奇说，瓜子二手车从这些库里拆分。自上而下，强行拆分。1-2天拆分了。</li>\n<li>php的短连接，连接数满<br>\n这个最后的最后，你们走了后，偶尔在分析hp全日志，发现hp每1-2次连接，伴随着一次空连接。Connect 什么都不做 quit。这个问题不知道什么有的，改了后，hp的连接数问题好了。</li>\n</ol>\n<hr>\n<p>总结，在赶集，因为数据的暴涨，只是一味的应对，没有快刀斩乱麻，进行分拆。还有就是有个dba的平台真是很必要，管理监控，提交审核sql，这个直到后来在完美一天的时候我才能够模仿着automan勉强写了个。</p>\n</div>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"110280\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"110280votetotal\">3</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"110280\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 3 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2017/02/37433daa9b8fa35dfbc1ed88829327aa.png"], "tags": "IT技术,DBA,数据库", "url_object_id": "f987a8eb6f7a91a4db4875adcd856a44", "title": "赶集网三年 DBA 总结", "comment_nums": 0, "front_image_path": "full/b1af1c27a7789e3f7d669d01ee3e476d0449d952.jpg", "create_date": "2017/02/16"}
{"url": "http://blog.jobbole.com/109987/", "praise_nums": "3", "fav_nums": 3, "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"><p><script src=\"http://www.imooc.com/open/courselistrandjs\"></script><span style=\"display:block;margin-bottom:10px;\"></span></p>\n</div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a target=\"_blank\" href=\"https://www.zhihu.com/question/26190832/answer/146259979\">沈万马</a>   </div><p>【伯乐在线转注】：本文源自「沈万马」对《<a href=\"https://www.zhihu.com/question/26190832/answer/146259979\" target=\"_blank\">Cache 和 Buffer 都是缓存，主要区别是什么？</a>》的回答分享，伯乐在线已获转载授权。</p>\n<p>Buffer常见的是这个：</p>\n<p style=\"text-align: center;\"><img id=\"pic\" class=\"aligncenter\" src=\"http://wx1.sinaimg.cn/large/63918611gy1fcz17hj7dpj20e80ao75m.jpg\"><br>\n（来源：<a class=\" wrap external\" href=\"http://www.cepolina.com/train-stop-buffer-bumper.html\" target=\"_blank\" rel=\"nofollow noreferrer\">train stop buffer bumper<i class=\"icon-external\"></i></a>）</p>\n<p>对，就是铁道端头那个巨大的弹簧一类的东西。作用是万一车没停住，撞弹簧上减速慢，危险小一些。叫<b>缓冲</b>。</p>\n<p>Cache常见的是这个：</p>\n<p><img id=\"pic\" class=\"aligncenter\" src=\"http://wx2.sinaimg.cn/large/63918611gy1fcz17bykuqj20go0ciabu.jpg\"></p>\n<p style=\"text-align: center;\">（来源：<a href=\"https://upload.wikimedia.org/wikipedia/commons/6/68/Bear_caches.jpg\" target=\"_blank\">维基百科</a>）</p>\n<p>没错，就是一种保管箱。看到右边那个被锈掉的Food Cache没？这是部署在森林里的存应急物资的保管箱。功能是把你需要用的东西放在更容易拿到的地方。虽然常用准确翻译叫<b>缓存</b>，但个人以为意思表达的不对，丢了一半的功能。台湾的翻译更好，叫<b>快取</b>。</p>\n<p>相信看完这些应该不用我说区别了？</p>\n<p>哎呀还是卖弄一下吧。</p>\n<p>简单说，Buffer的核心作用是用来缓冲，缓和冲击。比如你每秒要写100次硬盘，对系统冲击很大，浪费了大量时间在忙着处理开始写和结束写这两件事嘛。用个buffer暂存起来，变成每10秒写一次硬盘，对系统的冲击就很小，写入效率高了，日子过得爽了。极大缓和了冲击。</p>\n<p>Cache的核心作用是加快取用的速度。比如你一个很复杂的计算做完了，下次还要用结果，就把结果放手边一个好拿的地方存着，下次不用再算了。加快了数据取用的速度。</p>\n<p>所以，如果你注意关心过存储系统的话，你会发现硬盘的读写缓冲/缓存名称是不一样的，叫write-buffer和read-cache。很明显地说出了两者的区别。</p>\n<p>当然很多时候宏观上说两者可能是混用的。比如实际上memcached很多人就是拿来读写都用的。不少时候Non-SQL数据库也是。严格来说，CPU里的L2和L3 Cache也都是读写兼用——因为你没法简单地定义CPU用它们的方法是读还是写。硬盘里也是个典型例子，buffer和cache都在一块空间上，到底是buffer还是cache？</p>\n<p>不过仔细想一下，你说拿cache做buffer用行不行？当然行，只要能控制cache淘汰逻辑就没有任何问题。那么拿buffer做cache用呢？貌似在很特殊的情况下，能确定访问顺序的时候，也是可以的。简单想一下就明白——buffer根据定义，需要随机存储吗？一般是不需要的。但cache一定要。所以大多数时候用cache代替buffer可以，反之就比较局限。这也是技术上说cache和buffer的关键区别。</p>\n<p>——————</p>\n<p>补充1：不要误解Buffer就是用来写的，Cache就是用来读的。读可以用Buffer吗？当然可以，比如你想一批一批地处理读取而非有啥处理啥的时候，就可以用读buffer。写当然也可以用cache，比如你的写入有很高的随机性的时候。具体什么场景用Buffer什么场景用Cache要根据场景的具体需要决定。</p>\n<p>补充2：不要误解Cache或Buffer就一定是内存或者存在什么高速媒介上的东西。只要相对高速即可。我完全可以在硬盘上存Cache，比如有些游戏会在运行时建立预编译的shader（暴露年龄），这本质上就是一种cache，它存在速度缓慢的硬盘上，因为读硬盘依旧比重新编译要快。Buffer也同理，例如NTFS文件系统自己就有Logging Buffer，这个甚至明确拒绝放在任何易失缓存里。</p>\n<p>俩英文单词，不先看看本义吗？虽然都是抽象单词，但在各个地方都有具象的应用。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"109987\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"109987votetotal\">3</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"109987\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 3 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_url": ["http://wx1.sinaimg.cn/large/63918611gy1fcz17hj7dpj20e80ao75m.jpg"], "tags": "IT技术,Buffer,Cache,缓存", "url_object_id": "1d52f2f4fa0513dc7189b201fec976e0", "title": "看过这两张图，就明白 Buffer 和 Cache 之间区别", "comment_nums": 0, "front_image_path": "full/564ac0ad9bb2b8f6285cb4eed90dada33dc975e8.jpg", "create_date": "2017/02/22"}
{"url": "http://blog.jobbole.com/110226/", "praise_nums": "8", "fav_nums": 18, "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"><p><script src=\"http://www.imooc.com/open/courselistrandjs\"></script><span style=\"display:block;margin-bottom:10px;\"></span></p>\n</div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a target=\"_blank\" href=\"http://mp.weixin.qq.com/s?__biz=MjM5MDE0Mjc4MA==&amp;mid=2650993991&amp;idx=1&amp;sn=36334ea8ba4807714c740cd0ae80fe52&amp;scene=0#wechat_redirect\">王咏刚</a>   </div><p>【伯乐在线转注】：本文转载自公众号<strong>「半轻人」（</strong><strong>ID：ban-qing-ren）</strong>，伯乐在线已获作者「<strong>王咏刚</strong>」的授权。原标题：《不装逼地说，在 Google 到底能学到啥？》</p>\n<hr>\n<h3>前言</h3>\n<p>这个问题是提给自己的，算是对我 Google 十年的一个小结。</p>\n<p>强调“不装逼”，主要是提醒自己不要陷入下列俗套：</p>\n<ul>\n<li>离职后靠黑前雇主、八卦前雇主、揭秘前雇主搏出位（这条是恶行）</li>\n<li>满足大众猎奇心理</li>\n<li>吹嘘自己，贬低他人</li>\n</ul>\n<p>我 2006 年 3 月加入 Google，2016 年 9 月离开。离开时的头衔/职位是 Staff Software Engineer / Manager。前后 10.5 年，大致分三期：</p>\n<ul>\n<li>前两年关注 Linux 桌面搜索产品和 Google 的开源项目。</li>\n<li>中间三年花了许多力气在 Google 中国相关的产品上，诸如输入法、谷歌音乐之类。</li>\n<li>后面四五年大致都在 Knowledge Graph 的范畴内工作，这些工作和 Google 搜索、Google Now 最近几次大幅度的变革密不可分。</li>\n</ul>\n<p>其间，代码写了不少，团队也带过好几个。除此以外，这些年还长期在 Google Doodles 团队作为 20% 的开发人员帮忙开发那些好玩的首页涂鸦——嗯，这是真的，好多好玩的 Doodle 里面，都有我的一点小贡献。</p>\n<p>学到了啥？嗯，很多，很杂，拣最重要的三四条来说说：</p>\n<h3>1.第一次真实地生活在一个差异化的世界里</h3>\n<p>国内教育氛围向来是不喜欢差异化的，个人爱好、冒险精神、特立独行之类的语词，总会让家长、老师乃至领导、官员操碎了心。从小到大，我基本生活在一个试图将所有孩子圈养在尺子、框子、笼子里的世界；可以想象，像我这样的 70 后一脚踏入 Google 时，会有怎样的感慨。</p>\n<p>Google、Apple、Facebook、Twitter……对雇员来说，这些公司本身就是一种鼓励差异化生存的大家庭、大社会。其中，Google 又总是扮演引领者的角色，这是在 Google 工作很值得骄傲的一件事。</p>\n<p><strong>差异化的最大好处，就是你有机会认识形形色色的神奇人物</strong>，然后，当你和人生观、生活方式、个人爱好乃至行为习惯差异巨大的人一起工作时，你会真真切切地感受到，自己生活的这个世界一点儿也不单调，这里有太多好玩的人、好玩的事等着你去发现。</p>\n<p><img class=\"alignnone\" src=\"http://wx1.sinaimg.cn/mw690/63918611gy1fcrgjdl5qjj20qe0btmyq.jpg\" width=\"690\" height=\"309\"></p>\n<p>在 Google，看见什么样的差别都不该奇怪。</p>\n<p>往小了说，身边既有缩在角落里闷头写代码，讨厌和人交流的社交恐惧症患者，也有精神焕发的社交明星。办公室里，有带狗上班的爱心族，有重视家庭的好爸好妈，有整夜整夜奋斗的梦想家，有痴迷奇特爱好的技术极客……</p>\n<p>就拿爱好来说，跟我一起工作过的同事里，说起来好玩的爱好就包括：天天在车库里打造奇形怪状的自行车，休一个无薪假期去帮别人竞选总统，每个周末都跑到一个从没去过的地方留下到此一游照，研究古音韵学，出远海调查海洋生物，长期倒卖二手摄影器材，写科幻小说，尝试大气层外跳伞并打破世界纪录……</p>\n<p>当然，要尊重差异化，你就没法阻止任何人从早睡到晚然后每天只花两个小时干完别人十二个小时才能干完的活儿。</p>\n<p><strong>往大了说，Google 对 LGBT 群体的支持众所皆知。</strong>我当初更多地将这种支持理解为“政治正确”层面的东西。没过多少时间，我就知道我的理解有多么肤浅。有一次，Google 旧金山办公室一对男同在公司餐厅的浪漫求婚视频广为传播，感动了许多同事。事后我才想起，自己曾在硅谷一次会议上，见过那对幸福恋人中的一个。</p>\n<p>另有一次，自己所在的整个团队收到了一位高管宣布自己性别改变的邮件，说从那天开始，大家需要称呼他为“她”。与许多人理解的相反，这些发生在身边的事情并没有时时提醒你 LGBT 群体的存在，反之，经历愈多，你会愈加淡化对他们的注意——他们或她们就是人类的普通成员，与你我并没有太大的分别。</p>\n<p>去年在 YouTube 上追看 Google 推介的纪录片 HUMAN 时，我已经很清楚，Diversity 这个词早已是自己血液的一部分，我的大脑与纪录片制作者的大脑之间，完全没有任何隔阂。那时，我会对着屏幕上一张张陌生的面孔陷入冥想。</p>\n<p>我觉得，这个世界最可笑的一件事就是人类进化明明得益于基因与性格的差异，许多人竟会嘲笑别人与自己的不同之处，并竭力迫使他人改变，恨不得全世界的人都如自己一般固执、愚昧。性取向如此，恋爱、婚姻、家庭、工作、事业无不如此。</p>\n<p>Google 员工经常面临一个典型的两难困境：因为许多同事早早离开 Google 去融资、创业、上市、发财，像我这样安心在 Google 工作了十年的普通工程师就变成了另类——当面问我“为什么还没离开 Google”的人，他们眼睛里鄙夷的目光藏都藏不住；反过来，在家人眼中，我打算离开 Google 的举动无异于自己砸碎金饭碗，放着稳定的收入和丰厚的福利不要，非要和不确定性为伍。</p>\n<p>其实，如果懂得“多样性”的重要，这种左右两难的困局就不再成立。既然有人选择快节奏和世俗生活，为什么我就不能辞了职，慢悠悠地随着自己的兴趣，由着性子，从不同的角度理解这个世界与自我的关系？为什么“慢生活”就必须是一种逃避？</p>\n<p><strong>宇宙很大，人很渺小。安全感是扯淡，特立独行地活着才最重要。</strong></p>\n<h3>2. 看技术的心态完全不同了</h3>\n<p>这个主要是说我自己。到 Google 以前，我在国内做银行业的业务软件研发，给工行、中行之类的大企业做软件。这和 Google 这种面向最终用户的互联网背景是有天壤之别的。</p>\n<p>以前看待技术，觉得是身外之物，是工具，是砖木，是用来解决用户需求的必需品。这个心态其实也没什么错，但不自觉地就把自己放在技术追随者的位置上了。</p>\n<p>那时的我，很多时间都拼命在了解、学习和追赶新技术，生怕落伍。从这个语言追到那个语言，从这个框架追到那个框架，从这个模式追到那个模式，从这个平台追到那个平台……根本停不下来。</p>\n<p>那时的我只是个技术的“用户”，就像搬砖盖房子，如果不天天关心今年流行什么材质的砖，明年流行什么样的房子架构，后年流行什么样的房子外观，那肯定被客户和其他程序员骂“老土”。</p>\n<p>到 Google 撸胳膊挽袖子一忙活，才发现以前的自己狭隘了，小气了，井底之蛙了。原来以前追的好多顶尖技术，根本就是 Google 工程师主导或参与鼓捣出来的。而且，Google 内部还藏着许多外界不大知道的神奇玩意儿。最最重要的不同是——自己现在是引领技术潮流的大团队中的一员了。</p>\n<p>以前是不断学别人怎么设计房子，看别人推荐什么材料盖房子。现在，最顶尖的房屋设计专家、材料专家就在身边，自己也很快就能和他们一样指导别人盖房子了。这种感觉，就像跳进了一个大宝藏，还清楚地知道自己并非盗贼，而是宝藏的主人。盗窃宝藏 vs. 创建宝藏，这两者间的差别很微妙。</p>\n<p><strong>心态一下子大不一样了，从技术的“用户”变成了技术的“主人”。</strong></p>\n<p>比如，有段时间要解决 C++ 的 ABI 相关问题，猛想起 C++ 标准委员会的相当一部分人都是在 Google 工作的，有一年的全体大会还是在 Google 总部开的——那直接拉着既是同事也是 C++ 权威决策人的家伙一起开会讨论不就是了？</p>\n<p>类似的，Linux 内核的维护者、Python 的发明人、UNIX 的元老、Google Brain 的创建者……跟那么多牛人在一个公司里工作，你肯定不好意思只是单方面地跟人讨教，但凡有机会，你总会希望自己也像那些牛人一样，为技术发展做点儿贡献，哪怕只是一丁点儿。</p>\n<p>再比如，像 MapReduce、Bigtable、TensorFlow 之类由 Google 原创、对业界影响深远的技术，在 Google 内部可不仅仅是身外的工具，它们都是 Google 工程师这个大集体的作品和骄傲。因为大家都是主人，对哪些东西不爽，可以去鼓捣源代码，可以去提交自己的补丁或者新功能，甚至推翻重做。</p>\n<p>别小瞧这推翻重做，虽然很难很难，因为你得一边说服老板和用户，一边找到足够的开发人手，但事实上， Google 内部重新发明一遍、两遍、三遍的框架、工具、库、接口、服务比比皆是。一言不合就动手做个新版本、新系统，这毛病既带来数不清的流程混乱，也带来一山又比一山高的良性竞争——表面的混乱之下，良性竞争引发的技术飞跃常常超出想象。</p>\n<p><strong>在 Google，工程师有好几万，不能说每个人都渴望做技术的主人，但踌躇满志的大有人在。</strong>因为 Google 走在技术最前沿，有追求的工程师确实没脸当个纯粹的技术追随者。当然，我的意思不是说 Google 里没人去做那些不那么酷的“苦力活儿”，而是说大多数人都有个争强好胜的心态，即便是做相对简单的技术工作，也时常会想想怎么能做出世界一流的效果来。</p>\n<p>拿面试来说，有个工程师想出了一道与月球相关的面试题，把算法、编程、设计、维护问题放在太阳系的大背景下，层层追问。我在一次内部面试技术培训时拿这道题当过样例。结果，参加讨论的工程师表达了截然相反的两种意见，有人说这题设计精妙如天马行空，另一些人则批评这题目远离实际如镜花水月。</p>\n<p><strong>其实，Google 的技术宅们几乎每天都在深入实际与憧憬未来这两个极端的对位、矛盾、转化中工作。</strong>常说的“仰望星空、脚踏实地”远不能形容 Google 工程师的两面性。</p>\n<p>一方面，工程师们深知自己的代码是如何参与了这个地球乃至这个星系里最前卫、最大胆的计算机系统，如何为诸如十年后的搜索引擎、拥有人工智能的手机或机器人、量子计算机、基因工程、无人驾驶汽车等贡献力量；</p>\n<p>另一方面，工程师们“极客”和“宅”的一面常常在外人难以注意的工作细节里表露无遗——这里有十数年如一日致力于优化编译器的语言高手，有设计最好的代码审读系统的工具专家，有亲自动手实现软硬件原型的技术总监，有坚持为地球上每一种人类语言提供输入输出解决方案的国际化团队……</p>\n<p>这是心态的差别，或者说，是技术境界的差别，烙在 Google 工程师的基因里，旁人想学也未必学得到。</p>\n<h3>3. “管理”二字的意义完全不同了</h3>\n<p>在 Google，有时候工程师很难管理，因为大多数人都想法新、主意多、眼光高、个性强。在 Google，有时候工程师也很容易管理，只要鼓励他们把一件看似普通的事儿做出世界级的水准，他们自己就有足够优秀的执行力，用不着督促。</p>\n<p><strong>在 Google 做技术经理带团队，和我以前在其他公司带团队，完全是两码事。</strong>这也许和技术团队的平均水平有关，但<strong>根本还是管理境界的问题。</strong></p>\n<p>记得以前在别的公司，花大力气搞开发流程管理，现在想想，大多是繁文缛节，程式化，教条化，最极端的像 ISO9000 之类的流程认证，弄得所有人筋疲力尽，效果未必有多好。</p>\n<p><img class=\"alignnone\" src=\"http://wx4.sinaimg.cn/mw690/63918611gy1fcrgjhwo3mj20gi0ayt9c.jpg\" width=\"594\" height=\"394\"></p>\n<p>到了 Google，发现一个秘诀，<strong>再多的规章制度，再多的流程，不如一套好用的工具来得有效。</strong>比如 Code Style 和 Code Review，以前能把技术经理烦死，三令五申也执行不下去，顶多三天热度之后，大家就阳奉阴违了。在 Google，这件事不完全是个制度的问题。</p>\n<p>刚进来的工程师没有过 Readability Review，他就没法方便地自主提交代码，这是代码管理工具设置的硬性限制。这直接把工程师们送到评审委员会那里接受“再教育”，没错，真的是“再教育”，连 Python 之父 Guido van Rossum 也花了挺大力气才通过了 Python 语言代码的 Readability Review。</p>\n<p>接下来，提交新代码前，各种静态、动态检查工具自动运行，帮你报出一系列风格错误、编译错误、单元测试错误和简单的逻辑错误，你得先依着工具的提示，把这些低级别错误改一遍，然后才进入 Peer Review 的环节。整个 Code Review 都在非常方便的网页工具里完成，写代码的和审阅代码的人可以方便地交互、讨论，甚至在线修改代码。</p>\n<p><strong>工具的“强制性”保证了制度的执行，工具的“便捷性”最大程度减轻了工程师执行制度的负担，二者相辅相成。</strong>当然，Google 内部也不乏对制度敷衍了事的，但相对其他公司，Google 的确做得更好些。</p>\n<p>说到管理，在 Google 带技术团队的其实都苦哈哈的。我就先后两次把团队交给别人带，自己乐得去做些单纯的代码工作。道理很简单，头衔是 Manager，可你没法高高在上指手画脚，Google 最好的团队带头人都是冲在第一线带着大家一起干，除了主动包揽大家不想干的脏活、累活、杂活之外，还要做管理者必须的非技术工作，比如给每个人写评语、定奖金，帮每个人申请升职，跟心理负担重的谈心……</p>\n<p>一个人做两份工，吃力不讨好，对团队成员的晋升也没有决定权（这事儿也挺神的），这种 Manager 的活儿，谁愿意干谁干去，我是不大喜欢干的。不过，不喜欢归不喜欢，Google 这种挺不一样的管理既显着混乱无序，又运行良好，确实很神奇。</p>\n<p><strong>严格地说，聪明人在一起，只需要激励，不需要管理，Google 的办法主要也是强调这一点。</strong></p>\n<p>必须坦白，我加入 Google 时，工程师才三千人上下，无序管理、自发管理、扁平管理占主流。Google 越来越大以后，大公司病也如约而至。流程越来越复杂，层级越来越多，职权重叠和模糊越来越严重，不同团队之间管理风格的差异也越来越大。</p>\n<p>但即便如此，Google 基因里那种蔑视陈规、抵制办公室政治、抗拒繁文缛节的管理风格还是能在许多团队带头人的身上找到——这是 Google 肌体里的健康因素，活力因子，弥足珍贵。</p>\n<p>顺便说一句，最近中文圈子热传不写代码/不会写代码的 CTO 一事，许多 Google 工程师出身的 CEO/CTO 都在朋友圈里晒自己写的代码，以表明态度。我自己对技术管理者写不写代码没啥倾向，写不写都可以是好的管理者，但如果“不会写代码”还以此为荣，就完全没法接受，这个是底线。</p>\n<p>我在 Google 面试了不少 Manager 和 Director 的候选人，都考过对方写代码或者至少讨论一段代码的能力——不是要他一定在管理过程中写代码，而是怕他和 Google 工程师没法交流，和 Google 技术基因没法共存。</p>\n<p>在 Google 做技术管理，学不到啥成文的规矩，能学到的其实主要靠“悟”。</p>\n<h3>4. 看待职业生涯的心态也完全不同了</h3>\n<p>这个要因人而异，很多人来 Google 还是奔着一份优越的薪资待遇来的。所以，这里只谈我自己。</p>\n<p>有一种感觉是我开始在 Google 工作才有的。而且，那感觉越来越清晰，越来越吸引人，以至于十年下来，我几乎把这种感觉视为我工作时的第一推动力了。怎么说呢，这种感觉可能很多人都有，描述出来大概是：</p>\n<p><strong>在整个职业生涯里，至少要有一部分（哪怕是一小部分）时间，可以比较纯粹地为了开心而工作。</strong>一家公司是否适合自己，主要就是看这家公司能不能，或者在多大程度上能满足这个需求。</p>\n<p>我在 Google 做不同项目，有时很吃力，有时很痛苦，有时很紧张，当然有时也会开心。但普通项目没法让我比较纯粹地享受那种开心、愉悦的幸福感，于是乎，我在最近五六年里，把我的 20% 时间，都投入到了 Google Doodles 这个既有趣，也适合我的项目里。</p>\n<p>Doodle，嗯，首页涂鸦，纯粹为了让用户开心而设立的项目。这项目既需要画画的艺术家，也需要写动画、音效和游戏代码的成员，不但好玩，还特别有品，特别有文化。因为参与其中，我有机会跟 Google 总部那些厉害的艺术家一起合作，真的开心。</p>\n<p>有一次做 Google 生日的 Doodle，大家选中的是美国小孩子在生日常玩的一种叫 Piñata 的游戏。在电脑里实现这样的游戏，需要简洁的美术风格，支持 JavaScript 的物理引擎，还有平滑、高效的动画引擎，这些是技术细节，不展开谈。</p>\n<p>可在技术之外，我们这群追求开心的人硬是嚷着要亲自玩一次现实里的 Piñata。那次在 Mountain View，就在 Google 总部有一只霸王龙骨架的那片空地上，我们把一个真的 Piñata 挂在树上，轮流用竹竿去打，直到打出一地的糖果来。十几个艺术家和工程师开心得像小孩子。</p>\n<p>就是很纯粹的，很简单的，很开心的那种体验。无论工作里有多少烦恼，至少要给自己保留这样一块空间，叫心情家园也好，叫随便什么名字也好，哪怕再小，也得有那么一个。</p>\n<p>对我来说，在参与 Doodles 项目的过程里，可以和 Doodles 纪念的伟大科学家、艺术家们跨时空交流，可以和正在设计、制作的小动画、小游戏随时互动，可以预测到最终用户看到每个 Doodle 时的快乐，这的确是一件超赞的事。</p>\n<p>很幸运，Google 可以为我这样追求开心的人提供合适的机会。很不幸，（我确切地知道）不少公司从不考虑员工的这种需求。这大概也是公司基因决定的事，没法强求。正因为有了在 Google 的十年工作经历，我才会毫不犹豫地将职业生涯中最重要的追求定义为“开心”。</p>\n<p><img class=\"alignnone\" src=\"http://wx1.sinaimg.cn/mw690/63918611gy1fcrgjlvj66j20zk0npdk0.jpg\" width=\"690\" height=\"460\"></p>\n<p><strong>十年职业生涯，除了快乐，还有历史的厚重感。</strong>特别是 Google 中国这十年，我有幸亲历历史，可算人生里的大风浪。不幸，许多历史是不能详尽言说或评价的，所谓春秋笔法，绝不仅仅是史官的政治妥协，更多情况下也是从更高维度审视历史的一种大智慧。</p>\n<p>Google 与中国那些事儿，写得太感情用事了，褒贬就缺乏力量；太直白了，话语权就容易被粗暴剥夺；太详尽了，就难免掉进结果论与动机论对立的死循环。</p>\n<p>许多年以后，当互联网这个词不再具有产业先导精神，当获取信息如呼吸空气般自由，那时的人类史家和人工智能史学机器人一定会一起编撰诸如《互联网信息审查史》、《科技产业自由竞争和地区保护史》、《网络政治生态与网民意识形态史》、《信息交流史》、《禁毁网络文章和敏感网络关键词从考》、《网络经济与政治壁垒》、《互联网背景下的政府行为》、《维基百科的诞生和消亡》、《社交网络的全球化历程》等学术著作。</p>\n<p>只有节奏慢下来了，才有足够的清醒程度，可以从不同视角审视历史。今天哪怕是板上钉钉的史论，交给子孙后代时，许多也会有新的争议和不同角度的阐发吧？</p>\n<p>那时，我的后代也许可以用极为八卦的口吻悠悠地对子孙辈说，在某年某月某日某公司与某国政府无法就互联网审查达成一致的那个历史性时刻，我们家族的祖上是有人在现场目击历史的。有时，真的很想穿越到未来，只为了评估一下，今天我们极为看重的事情是不是早已被子孙们淡忘。</p>\n<p>总的说来，我喜欢一种本质上不是消极避世的“慢生活”，“快乐”和“多样化”是这种生活的力量源泉。离开 Google 后，我坚信这种生活就是自己的未来。</p>\n<p>想法渐多，身心渐老。下一个十年，请慢一些到来吧。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"110226\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"110226votetotal\">8</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"110226\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 18 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i> 8 评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_url": ["http://wx1.sinaimg.cn/mw690/63918611gy1fcrgjdl5qjj20qe0btmyq.jpg"], "tags": "职场,Google,职场", "url_object_id": "ea262a65a4f2ba5cb38ff9971ca52fd5", "title": "在 Google 工作 10 年，到底能学到啥？", "comment_nums": 8, "front_image_path": "full/c82fab36e8ea884a6e2bf9db2864226f1ec08e92.jpg", "create_date": "2017/02/16"}
{"url": "http://blog.jobbole.com/110310/", "praise_nums": "2", "fav_nums": 0, "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"><p><script src=\"http://www.imooc.com/open/courselistrandjs\"></script><span style=\"display:block;margin-bottom:10px;\"></span></p>\n</div>\n\t\t\r\n\t\t<p><img id=\"pic\" class=\"\" src=\"http://wx3.sinaimg.cn/large/63918611gy1fcz2wtwp5yj20fk0aeq3m.jpg\"></p>\n<p>【伯乐在线转注：】本文源自知乎问答帖：《硬盘写到一半断电时文件系统发生了什么？》。原题主的问题补充：</p>\n<blockquote><p>断电时文件系统发生了什么？硬盘又发生了什么？下一次开机时写到一半的文件在系统层面还在吗？在底层还在吗？</p>\n<p>更进一步的, 文件系统如何保证事务性, 会不会存在某种极端情况导致例如最后几个bit还没写完, 文件系统却认为它成功了的情况?</p>\n<p>回答不限任何文件系统，谢谢！</p></blockquote>\n<h3><a href=\"https://www.zhihu.com/question/55711728/answer/146213360\" target=\"_blank\">下面是「北极」的回复分享</a>，伯乐在线已获授权：</h3>\n<p>断电的一瞬间，很多事情是无法确定的：</p>\n<p>1. 你无法确定你试图向设备驱动发送的写指令是否成功，<b>驱动程序本身一般都有缓存</b>；</p>\n<p>2. 即使写指令正常返回，你也无法确定设备实际上是否写成功，因为<b>设备本身可能也有缓存</b>。目前没有设备能保证写指令返回的情况下，<b>所有数据一定成功</b>的保存在介质上（但部分厂商能保证少量数据一定能成功写入），对存储设备的<b>flush操作并非绝对可靠</b>；</p>\n<p>3. 哪些成功哪些失败<b>可能是乱序的</b>，换句话说，如果先发送写请求A，再发送写请求B，并且都成功返回，掉电时请求A可能丢失，但B成功（<b>NCQ功能</b>）；</p>\n<p>4. 机械式磁盘可能会出现丢失半截数据的情况（比如，一个512字节扇区只写入了100字节，也就是题主说的bit级错误），但这种一般都会通过校验位检测出来。</p>\n<p>因为有以上这么多的限制，实际上文件系统一般没办法保证数据一定不丢失，甚至哪些丢失哪些能恢复也是不确定的。</p>\n<p>一般来说，文件系统有以下的几种策略：</p>\n<p>1. 完全不管错误的事情，错了就错了；</p>\n<p>2. 打标记位的方式，如果怀疑有错，通过磁盘检测功能恢复；</p>\n<p>3. 在设计上保证文件系统结构上可恢复，但不保证用户数据可恢复；</p>\n<p>4. 能在用户数据层面上保证数据的绝对正确。</p>\n<p>第一种和第二种策略现在比较少见，FAT文件系统算是属于这类；主流文件系统基本上都能保证第三种，比如NTFS之类的；第四种比较难，一般都要配合存储驱动一起，多见于Flash介质的专属文件系统。</p>\n<p>保证数据不损坏，具体的方案一般有：</p>\n<p><b>方案1：Copy-On-Write</b>，写数据的时候不在原来的位置写，而是先读一份，然后写到另外一个位置，当确认写成功时，把文件系统的指针指向新的位置。如下图：</p>\n<p><img id=\"pic\" class=\"\" src=\"http://wx3.sinaimg.cn/large/63918611gy1fcz2qabfejj20go0es74t.jpg\"></p>\n<p>实际应用中，比这个情况复杂，因为Data2写入的过程中，File1本身的一些信息（修改时间等）也发生了变化，所以CopyOnWrite产生的影响不止这一个块，而是很多。</p>\n<p><b>方案2：日志（Journal）技术</b>。使用日志记录meta-data甚至是数据块的变化情况（NTFS就是这种策略），一旦出现掉电情况，在日志中反推到一个正确的状态上，就可以保证meta-data不损坏。</p>\n<p>常见的方案就这两种，当然还有别的更复杂的技术，可以参考这个链接（<a class=\" wrap external\" href=\"https://link.zhihu.com/?target=https%3A//en.wikipedia.org/wiki/Comparison_of_file_systems\" target=\"_blank\" rel=\"nofollow noreferrer\">Comparison of file systems<i class=\"icon-external\"></i></a>），但不管用什么方案，本质上都是以牺牲性能为代价换取结构上的稳定。</p>\n<p>最后回到题主的问题，文件系统如何保证数据的正确性？如果是指文件的数据部分，是无法保证的，因为文件系统无法确定数据到底写没写进去，绝大多数文件系统只能保证自身结构是正确的，但这个正确可能是回滚之后的状态，具体回滚多少内容，文件系统自己也不能保证。</p>\n<p>这事说起来挺复杂的，不同文件系统，不同设备，不同介质，效果都是有区别的。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"110310\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"110310votetotal\">2</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"110310\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i>  收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_url": ["http://wx3.sinaimg.cn/large/63918611gy1fcz2wtwp5yj20fk0aeq3m.jpg"], "tags": "IT技术,硬盘", "url_object_id": "42b0e45ce3488ceddec61bfeeb5abd34", "title": "硬盘写到一半时断电，文件系统里会发什么？", "comment_nums": 0, "front_image_path": "full/055507fb28ac7ac8228b811c71f9ffdec4eb1748.jpg", "create_date": "2017/02/22"}
{"url": "http://blog.jobbole.com/110265/", "praise_nums": "6", "fav_nums": 20, "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"><p><script src=\"http://www.imooc.com/open/courselistrandjs\"></script><span style=\"display:block;margin-bottom:10px;\"></span></p>\n</div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a target=\"_blank\" href=\"http://coolshell.cn/articles/17583.html\">酷壳/陈皓 </a>   </div><p><img class=\"alignnone\" src=\"http://wx4.sinaimg.cn/mw690/63918611gy1fcsema1o5fj20m80fb45o.jpg\" width=\"400\" height=\"285\"></p>\n<p>2012年的时候写过一篇叫《<a href=\"http://coolshell.cn/articles/8790.html\" target=\"_blank\">程序算法与人生选择</a>》的文章，我用算法来类比如何做选择，说白了就是怎么去计算，但是并没有讲程序员可以发展的方向有哪些。 所以，就算是有这些所谓的方法论，我们可能对自己的发展还是会很纠结和无所事从，尤其是人到了30岁，这种彷徨和迷惑越来越重。虽然我之前也写过一篇《<a href=\"http://coolshell.cn/articles/10688.html\" target=\"_blank\">编程年龄和编程技能</a>》的文章，但是还是有很多做技术的人对于自己能否在年纪大时还能去做技术感到没有信心。我猜测，这其中，最大的问题的是，目前从事技术工作的种种负面的经历（比如经常性的加班，被当成棋子或劳动力等等），让人完全看不到希望和前途，尤其是随着年纪越来越大，对未来的越来越没有信心。</p>\n<p>同时，也是因为在GIAC的大会被问到，程序员老了怎么办？而在年底这段时间，也和几个朋友在交流中不断地重复谈到个人发展的这个话题。我的人生过半，活到“不惑”的年纪，自然经常性的对什么事都会回头看看总结归纳，所以，在交谈过程中和交谈过后，自己也有一些思考想记录下来。因为我本人也是在这条路上的人，所以，谈不上给他人指导，我同样也是在瞎乱折腾同样每天在思考自己要去哪儿的“一尘世间迷途老生”。况且，我的经历和眼界非常有限，因此，下面的这些关于个人发展的文字和思考必然是受我的眼界和经历所局限的。也欢迎大家补充和指正。</p>\n<p>这些东西不一定对，也不一定就是全部，期许可以让你在年底的时候有所思考，在明年的时候有所计划。</p>\n<h2>一个重要阶段和标志</h2>\n<p>在讲个人发展之前，我需要先说一下人生中的一个非常重要的阶段——<strong>20到30岁！</strong></p>\n<p><strong>这个阶段的首要任务，就是提升自己学习能力和解决难题的能力。</strong><strong>这是一个非常非常关键的时间段！这个时间段几乎决定着你的未来。</strong></p>\n<p>30岁以前，这个时间段，应该是人学习和积累的时间段，这个时间段，就是努力学习的时间段。这个时间段，你一定要把时间花在解决问题的技能上。就是说，你一定要练就成的技能是——你能解决大多数人不能解决的问题。使蛮力埋头加班苦干，当一个搬砖老黄牛的是肯定没有前途的。如果你不幸呆在了一个搬砖的地方，天天被业务压得喘不过气来，我建议你宁可让你的项目延期被老板骂，也要把时间挤出来努力学习基础知识，多掌握一些技术（很多技术在思路上是相通的），然后才能有机会改变自己目前的状况。因为，比起你的个人未来，项目延期被老板骂、绩效不好拿不到奖金，都不是什么事儿。</p>\n<p>总结一下，你在30岁前，工作5-7年，你需要拥有：</p>\n<ul>\n<li><strong>高效的学习能力</strong>。这意味着——基础知识扎实、触类旁通、读英文文档不费劲、有寻找前沿知识的能力、能够看到问题和技术的本质、善于思辩、能独立思考。</li>\n</ul>\n<ul>\n<li><strong>解决问题的能力</strong>。这意味着——你要高效的学习能力、见过很多的场景、犯过或是处理很多错误、能够防火而不是救火。</li>\n</ul>\n<p>如果你拥有这两个能力的现象是—— <strong>在团队或身边的人群中的显现出Leadership</strong>。</p>\n<p>Leadership并不是当领导和经理，而是一种特征，这种特征有如下两个简单的表象：</p>\n<ul>\n<li><strong>帮人解问题</strong>。团队或身边中大多数人都在问：“这问题怎么办？”，而总是你能站出来告诉大家这事该怎么办？</li>\n</ul>\n<ul>\n<li><strong>被人所依赖</strong>。团队或身边中大多数人在做比较关键的决定时，都会来找你咨询你的意见和想法。</li>\n</ul>\n<p>一但你在在30岁之间出现了Leadership这样的特征，那么，你会进入一个正循环的阶段：</p>\n<ul>\n<li>因为你学习能力强，所以，你会有更多的机会解决难题。</li>\n<li>你有更多的机会解决难题，你就会学更多的东西，于是你就会更强。</li>\n<li>上面这个循环，只要循环上几年，就会让你人生的各种可能性大大的增加。</li>\n</ul>\n<p><strong>【 注意 】</strong></p>\n<ul>\n<li>要达到这样的特质，需要找到自己的长处、以及适合自己的环境。就像鱼的特长是呆在水里，让鱼儿去追求陆上动物的刺激生活并不靠谱。</li>\n</ul>\n<ul>\n<li>一般说来，有这样的潜质的人，在学校中就应该要出现。如果你在大学中还没有出现这样的潜质，那么，你在工作当中要加倍努力了（注：所谓的加倍努力，不是让你使蛮力加班，而是让你多学习成长，使蛮力拼命是弥补不了能力、思维、眼界上的缺陷的）。</li>\n</ul>\n<ul>\n<li>Leadership也有范围的，比如，身边的朋友，工作中的团队/部分，圈内，整个行业。Leadership的范围越大，你的个人发展的选择性就越高。反之则越小。</li>\n</ul>\n<ul>\n<li>如果已到了30岁左右，还是没有出现这样的特征。那么，可能未来你也很难有这样的Leadership了。而你的个人发展的可能性可能也就不多了（sigh…）</li>\n</ul>\n<p><strong>读到这里，我必需要说一下，如果你已开始显现出你的Leadership，那么你才谈得上个人发展，这篇文章后续的内容也可能才会对你有意义</strong>。</p>\n<h2>个人发展的三个方向</h2>\n<p>以我个人短浅的经历和视野，目前只看到的人的发展有如下三个大方向（他们之间可能会有重叠）：</p>\n<p>1）<strong>在职场中打拼</strong></p>\n<p>2）<strong>去经历有意义有价值的事</strong></p>\n<p>3）<strong>追求一种自由的生活</strong></p>\n<p>这三个方向，我个人或多或少都体验过，我也见过身边的很多人走这三个方向走的比较成功。也许还有别的方向，没办法，现在，我的视野就这么大，所以，我在这里，我主要就是谈谈这三个方向。Again，<strong>人有资格去走这三个方向的前提是——已有了上面我说的Leadership那种特质！</strong></p>\n<h2>一、在职场中发展</h2>\n<p>在职场中发展应该是绝大多数人的选择。通过加入公司来达到人生的发展。</p>\n<p>我们经常可以看到很多所谓的“职业规划”，但是大多数职业规划只不过人力资源搞出来的东西，和实际其实是有很大出入的。我的人生经历中，有18年左右是在公司中度过的，在过银行，小公司，大公司，民营公司，外国公司，传统IT公司，互联网公司，不同的公司完全有不同的玩法和文化，我的经历还算丰富，但也不算特别成功，这里只分享一些我在职场中的心得（不一定对，仅供参考）。</p>\n<h3>1、去顶尖公司</h3>\n<p><strong>去顶尖公司的一个目的就是让你的Leadership的范围的可能性扩大</strong>。</p>\n<p>因为公司和公司的差距也不小，所以，就算你在低端公司里是骨干份子，但在高端公司里可能只是一个普通员工（就像中国足球队的主力到了英超可能都无法入选）。所以，在职场中，如果你要让你的个人价值最大化的话，你一定要去顶尖的公司。因为顶尖公司里有非常不错的工作方法和场景，这并不是能看书或是交流得来的，这是必需要去亲身体验的。所以说，在顶尖公司掌握的技能，开阔的眼界，通常来说都会比低端公司的要多得多。</p>\n<p>另外，每个公司的工作级别都是有相互对标的，比如：阿里的P几对应于百度的T几。国内的一线公司职位还相当，但是如果和国外一线公司的比，那就有差距了，而且差距还很大。比如，Google或Facebook的某个高级工程师，可能就对应于阿里的P8/P9甚至更高。</p>\n<p>是的，对于职场来说，如果你在顶尖公司是骨干，那么，你去低端公司，则有很大机会会成为他们高管和核心。就好像你在Facebook里干三五年成为他们的技术骨干，那么你到BAT去成成为高管概率是非常大的。反过来，如果你毕业主去了BAT成为了一个螺丝钉，在天天加班中度过你的青春，你干个十年能成为BAT的高管的概率可能会非常的低。</p>\n<h3>2、去真正的创业公司</h3>\n<p>去顶尖公司和去创业公司在某些时候并不冲突。不过，这里我想讲的是，一个技术能力强的人在大公司可能会被埋没掉。因为大公司业务成功后，</p>\n<ul>\n<li>成功的公司在招聘各种高级技术人才都不会成为问题，于是少你一个不少，多你一个不多。</li>\n</ul>\n<ul>\n<li>成功的公司其整个技术体系已经完成，Legacy的问题也比较多，所以，可以供你发挥的余地不大。</li>\n</ul>\n<ul>\n<li>成功的公司更多的可能会想要稳定的系统，稳定必然会产生保守，而保守则产生不思进取。</li>\n</ul>\n<p>所以，对于中高级人才来说，在大公司里的能产生的个人价值，可能远远不如那些求贤若渴、没有包袱、可以尽情施展、相对更为灵活和自由的创业型公司。</p>\n<p>不过，去创业公司需要小心仔细的挑选和评估，创业公司的不确定因素很多，也和创始人的因素太大了，所以，你需要小心了解创始人和他们的业务情况，想法和理念差不多才能更好的共事。</p>\n<p>好多创业公司其实并不是真正的创业公司，他们创业有很大的侥幸和驱利心理，要小心甄别。因为那不是真正的创业公司。</p>\n<h3>3、职业生涯的发展阶段</h3>\n<p>首先，有一个不争事实——<strong>整个社会是会把最重要的工作交给30岁左右的这群人的。也就是说，30岁左右这群人是这个社会的做事的中坚力量。</strong></p>\n<p>所以，这是一个机遇！如果你有了Leadership，你就一定能在这个时间段内赶得上这个机遇——公司和领导对你寄于信任和厚望，并把重要的团队和工作交给你。</p>\n<p>于是，你的30岁到40岁就成了一个职业生涯的发展期，也就是你的事业上升期。如果你到40岁都没有赶上，那么你的职业生涯也就这样了，老有所成的人是少数。</p>\n<p>在你事业的上升期，你需要更多的软技能，比如：</p>\n<ul>\n<li>带领产品和业务的发展的能力</li>\n<li>推行自己喜欢的文化的能力</li>\n<li>项目管理的能力——在任务重、时间紧中求全</li>\n<li>沟通和说服别人的能力</li>\n<li>解决冲突的能力</li>\n<li>管理和发展团队的能力</li>\n<li>解决突发事件的应急能力</li>\n<li>…… ……</li>\n</ul>\n<p>另外，你还要明白在职场里的几个冷酷的事实：</p>\n<ul>\n<li><strong>你开始要关心并处理复杂的人事</strong>。尤其在大公司，大量的人都是屁股决定脑袋，利益关系复杂，目标不一致，每个人心里都有不一样的想法。这个时候再也不是 talk is cheap, show me the code！而是，code is cheap，talk is the matter。你需要花大量的时间去思考和观察形形色色的人。需要耗费大量的精力在不同的人之间周旋，而不是花时间去创造些什么有价值的东西。</li>\n</ul>\n<ul>\n<li><strong>你要开始学会使用各种政治手段</strong>。办公室政治不可避免，越大的公司越重，自从你开始成为一线的leader的那一天起，你就开始成为“里外不是人”的角色，需要在下属和领导，员工和公司之间周旋。随而你的级别越来越高，你需要使用更多的政治手段，你会学会审时度世的站队，学会迎合员工和领导，学会用官员的语言说话，学会此一时彼一时，学会妥协和交换，学会忍气吞声，学会在在适当的时机表现自己，学会波澜不惊，学会把自己隐藏起来，甚至你还会迷失自我，开始学会一些厚黑学，比如不得不在适当的时机在背后捅人刀子……你可能会成为一个你自己都讨厌的人。</li>\n</ul>\n<p>听上去真的好无聊，所以，你现在也明白为什么高层们都看上去很忙很累，而且抽不出时间来关心细节问题，因为，他们更多的是要协调整个组织和系统来运转，甚至还要四处周旋，各种博弈，没办法，这是职场的必需的东西！听起来是不是感觉人类很愚蠢？这真是没办法的事。如果你不想或是也没有能力玩这些东西，那么你需要去那些可以让技术人员安安心心做技术的公司。这类的公司，我见过Microsoft、Google、Amazon或是一些创业公司里都有。国内的大公司中也有让技术人员成长的职业成长线，但老实说，表面上看似是一个让人专心做技术的升职成长线，但其实还是管理岗位。</p>\n<p>所以，<strong>技术人员在职场中的归宿有两条路 —— 到真正的技术公司成为一个专心做技术的人，或是在成为一个职业的经理人</strong>。</p>\n<h2>二、追求人生的经历</h2>\n<p>先说三个故事，</p>\n<ul>\n<li>第一个，是在阿里的时候，有一天在内网里看到一个贴子，一个做产品的女孩说自己准备离职要去法国学烘培厨艺，引得大家热评。</li>\n</ul>\n<ul>\n<li>第二个，是在亚马逊的美国老板，他每年都要去报个培训班学一个技能，比如：厨艺、开双翼飞机、夜总会里的DJ……、甚至去华盛顿去学当一个政客。</li>\n</ul>\n<ul>\n<li>第三个，是在汤森路透工作时，一个英国的同事，有一天他说他离职了，和自己的老婆准备用余生去周游世界，我问他是不是有足够多的钱了？他和我说，钱不够，他俩口子的计划是，边旅游边打工，打工打够到下一站的钱就走。他还说，那种用假期去另一个城市的旅游太没意思了，如果你不在那个地方生活上一段时间 ，你怎么能算是好的旅游体验呢？好吧，无法反驳。</li>\n</ul>\n<p>我是觉得他们把自己的人生过得如此有意思，令我很佩服。虽然跨界跨得有点猛，但是 Why Not？</p>\n<p>在这里，我想说，去追求一种和众人不一样的人生经历也是一件挺好的事，我个人感觉，比起在职场里有趣地多多了。如果你厌倦了职场，其实为什么不去追求一下不同的人生经历呢。就算你不想去追求跨度比较大的人生经历，那么，在技术圈里，也有很多有价值有意思的经历也可以去的。<strong>追求刺激有意义的与众不同的经历的人，其实也能算是一种人生的成功，不是吗？</strong></p>\n<p>如果只说技术方面，我个人看到的去追求经历的人，有两种追求的人其实也很成功的：</p>\n<ul>\n<li><strong>到技术创新的发源地去经历创新</strong>。计算机互联网各种技术的创新引擎，基本上来说，就是在美国了。我们赶上了这个时代，也选对了这个时代最火热的行业，那么，有什么理由不去这个时代的技术发动机那里去经历呢？在美国硅谷湾区，无论是大公司，还是创业公司，都在迸发着各式各样的创新，如果有能力有机会，为什么不努力去经历一下呢？不经历一下，老了不会觉得错过了是一种后悔吗？</li>\n</ul>\n<ul>\n<li><strong>去经历下一个热点技术的发展</strong>。从IT，到互联网、再到移动互联网、云计算、大数据，再到未来的AI，VR，IoT……，技术创新的浪潮一波接一波的过来，你是想在那继续搬砖搬下去，是想迎浪而上去经历浪潮，还是想成为一个随波逐流的人？</li>\n</ul>\n<p>打工也好，创业也好，在国内也好，在国外也好，这些都是形式，不是内容。内容则是你有没有和有想法的人去经历有意义有价值事？人生苦短，白驹过隙，我们技术人员最大的幸运就是生在这样一个刺激的时代，那么，你还有什么理由不去追逐这些前沿刺激的经历呢？</p>\n<h2>三、追求自由的生活</h2>\n<p>我相信“自由”这个事，是所有人的心中都会想去追求的。“生命诚可贵，爱情价更高，…… ”（哈哈）</p>\n<p>但一说起自由，绝大多数人都想到的是“财富自由”或是“财务自由”，其实，并不完全是这样的，在自由的通路上，我个人的经历告诉我，其实，你会有很多的不同类型的自由。下面，是我对几个层次的“自由”的理解。</p>\n<p><strong>第一层自由——工作自由</strong>。人的第一层自由的境界是——“工作自由”，我到不是说你在工作单位上可以很自由，虽然有特例，但并不普遍。我想说的“工作自由”是——你不会有失业危机感了。也就是说，你成了各个公司的抢手货，你不但不愁找不到工作，而且你是完全不愁找不到好工作。试想一下，如果是工作来找你，一方面，你就有真正意义上的工作选择权了，另一方面，你都不愁工作了，你完全就可以随时离职去干你想干的事了。此时，你就达到了“工作自由”。</p>\n<p><strong>第二层自由——技能自由</strong>。工作自由已是不错，不过前提是你还是需要依赖于别人提供的工作机会。而技能自由则是你可以用自己的技能养活自己，而不需要去公司里工作。也就是所谓的自由职业者了，社会上，这样的人也不少，比如，一些健身体育教练、设计师、翻译者、作者……这些都可以算是自由职业者，程序员这个职业中只要不是搬砖的，有想法的，就有可以成为自由积业者的潜质，想一想，你拥有的编程能力，其实是一种创造的能力，也就是创造力，只要你Make Something People Want（YC创业公司的slogan），你是完全可以通过自己的技能来养活自己的。如果你通过某些自动化的东西，或是你在App上做了一个软件个体户，让自己的收入不断，甚至你做了一个开源软件，社区每个月都给你捐款捐到比你打工挣的还多，那么你就真正的有了技能自由了。</p>\n<p><strong>第三层自由——物质自由。</strong>我把财务自由换了一种说法。我个人觉得，除了有个好爸爸之外这种特例的情况，如果你想有物质自由的话，本质上来说，你一定要学会投资，投资不一定是你的钱，时间也是一种财富，年轻更是，你怎么投资你的时间还有你的青春？你要把你的投资投到什么样的事，什么样的人？对于投资这个事，风险也比较大。但是，人生不敢冒险可能才是最大的冒险。这个世界有很多技术不是你能看书学来的，而要只能在实战中学会的，比如：游泳。投资可能也是一种。只有真正懂投资的人，或是运气非常好的人，才可能实现物质自由。</p>\n<p>追求自由的生活，其实也是个人发展道路上的一个不错的选择。通常来说，自由的人，能力都不差，钱也不会少。因为，他们懂得投资。</p>\n<p>也就是说，拥有追求自由能力的的人，</p>\n<ul>\n<li>不但有领导力和创造力（也可指导大多数人并走在大多数人前面）</li>\n<li>同时他还懂得怎么投资（知道时间和精力和金钱应该投在什么地方）</li>\n</ul>\n<p>（注：这里我没有提精神自由，老实说，精神上的自由我也不清楚是什么东西，因为我还没有见过，眼界有限，所以先按不表了，不然真成鸡汤文了）</p>\n<h2>总结</h2>\n<p>无论是在职场中打拼，还是追求精彩的经历，还是去实现自由，我觉得都是不错的个人发展的方向。</p>\n<p>他们都有重叠，比如：</p>\n<ul>\n<li>你可以在职场中去追求那些刺激的经历的公司。</li>\n<li>同样也可以通过加入有潜力高速发展的公司来达到自由。</li>\n<li>你也可以通过追寻不一样的经历来达到人生的自由。</li>\n<li>……</li>\n</ul>\n<p><strong>总之，这里的逻辑是——</strong></p>\n<ul>\n<li><strong>能够去规划自己的个人发展的人，通常都是有很多机会和可能性的人</strong>。</li>\n</ul>\n<ul>\n<li><strong>有很多机会和可能性的人，通常都是有Leadership，喜欢冒险的人。</strong></li>\n</ul>\n<ul>\n<li><strong>有Leadership喜欢冒险的人，通常都是学习能力强，思维活跃，喜欢折腾，懂得“投资”的人。</strong></li>\n</ul>\n<ul>\n<li><strong>学习能力强思维活跃的人，通常来说，都是喜欢看书，喜欢实践和新鲜事物，不怕艰难和挑战，用智力而不是使蛮力的人。</strong></li>\n</ul>\n<ul>\n<li><strong>懂得“投资”的人，通常来说，他们更多的关注的是未来和长远的成长，而不是当下的KPI、奖金和晋升。</strong></li>\n</ul>\n<p><img class=\"aligncenter\" src=\"http://wx3.sinaimg.cn/large/63918611gy1fcsemf9t5dj20jg08y7ah.jpg\" width=\"700\" height=\"322\"></p>\n<p></p><center>插图来自电影《飞屋环游记》</center><strong>最后祝大家新年快乐，来年大展鸿图。</strong>\n<p>（全文完）</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"110265\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"110265votetotal\">6</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"110265\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 20 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i> 8 评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_url": ["http://wx4.sinaimg.cn/mw690/63918611gy1fcsema1o5fj20m80fb45o.jpg"], "tags": "职场,程序员,职场", "url_object_id": "946a16972dbe0084c77144b696ece5e6", "title": "技术人员的发展之路", "comment_nums": 8, "front_image_path": "full/bf57e46678f23d08fc33c6d03517d237f331544b.jpg", "create_date": "2017/02/16"}
{"url": "http://blog.jobbole.com/110297/", "praise_nums": "2", "fav_nums": 1, "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"><p><script src=\"http://www.imooc.com/open/courselistrandjs\"></script><span style=\"display:block;margin-bottom:10px;\"></span></p>\n</div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文作者： <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/thoughtworkschina\">ThoughtWorks</a> 。未经作者许可，禁止转载！<br>欢迎加入伯乐在线 <a href=\"http://blog.jobbole.com/99322\" target=\"_blank\">专栏作者</a>。</div><p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/02/1-bus.jpeg\" alt=\"\"></p>\n<blockquote><p>“看，车来了！不过貌似咱赶不上这趟车了吧？”</p>\n<p>“啊！那快点跑，错过这趟就得再等半个小时！”</p>\n<p>……</p></blockquote>\n<p>好无奈，可是真的赶不上也没有办法，这个场景很多人都经历过。</p>\n<blockquote><p>“这个release又是一定包就开始上hotfix，四天跟了四个，我根本没时间做回归测试！” QA小静同学抱怨道。</p>\n<p>“每次都是定包后就开始无休止的上hotfix，咱们还不如改成每周发布一次！”Dev大鹏同学也被hotfix折磨苦了。</p></blockquote>\n<p>这是发生在蓝鲸项目中一次真实而平常的对话，跟前面赶公交车的场景有什么关系呢？</p>\n<h3>发车间隔与发布周期</h3>\n<p><strong>发车间隔的不同带给乘客的感受会完全不同。</strong></p>\n<p>有些公交车很少，每半个小时一趟，有时候眼看着一辆车来了又走了，没赶上会无比懊恼，下一趟还得等上半个小时，实在着急的可能会考虑叫一辆快车赶紧走。</p>\n<p>而有些公交车发车间隔非常短，几分钟一趟，就算错过一趟也无需等待太久，只要不是着急去救火，乘客一般不会太在乎。</p>\n<p><strong>项目的不同发布周期带给客户的感受也是类似的。</strong></p>\n<p>蓝鲸项目的发布周期跟第一种公交车发车间隔非常类似，是四周发布一次。如果功能没能在这次上线，或者有导致功能无法正常工作的缺陷，得再等一个月才能再次上线。一个月，那是多少白花花的银子啊！对于那些特别重要的功能，客户着急就会要求上hotfix，于是就出现了前面小静和大鹏的对话场景。</p>\n<p>Hotfix是否真的能解决软件交付过程中的问题呢？其实不然。</p>\n<p>Hotfix的引入带来很多额外的工作，影响新功能的按时交付，会打乱交付节奏，有形成恶性循环的趋势。既然这样，大家一定希望能把问题解决，而且通过公交车的例子很容易想到前面大鹏说的那个方案。</p>\n<p>如果发布周期缩短，比如说缩短为一周甚至更短，这次没上的功能也不用那么着急的通过hotfix来上线，就能解决问题。那么蓝鲸项目为什么不一周发布一次呢？</p>\n<h3>如何才能缩短发布周期？</h3>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/02/3-publish.png\" alt=\"\"></p>\n<h4>1. 合适的迭代计划和合理的需求切分</h4>\n<p>半个小时一趟的公交车，就算车子足够大、能够承载半个小时到达的乘客数，也会导致乘客等待时间过长，造成很多不便。要解决这种情况，可以把大型公交车换成多辆小型车，增加发车次数，缩短发车间隔。发车间隔缩短到多少，车子换成多大都是需要仔细分析和考虑的问题。</p>\n<p>映射到蓝鲸项目，要缩短发布周期，就得有相应的小规模需求正好能够乘坐小发布周期那样的小车，因此要做好发布计划和需求切分。</p>\n<p>这样对需求源的要求很高，需要客户那头的紧密配合。要想缩短发布周期，首先必须得有足够的、粒度合适的功能需求，能够正好安排到较短的发布周期上线。如果需求范围不能提前确定好，就没法提前做好短周期发布计划，不可能把发布周期缩短。</p>\n<h4>2. 强大的开发能力</h4>\n<p>在把乘客的需求分析清楚之后，缩短发车间隔非常关键的一点就是要有足够的安全的车和靠谱的司机。如果这一点满足不了，其他都免谈。</p>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/02/4-road-1024x678.jpg\" alt=\"\"></p>\n<p>对应到蓝鲸项目，安全的车子和靠谱的司机组成了拥有强大开发能力的团队，包括架构支撑和人员技能。</p>\n<p>车子就是对持续交付友好的技术架构，需要减少模块间的依赖，比如采用微服务。蓝鲸项目是一个七年之久的老项目，很多陈年依赖已经形成，要拆分不是一时半会的事情，团队正在朝着这个方向努力。</p>\n<p>司机就是我们的开发团队，除了要有必要的开发技能外，要做到靠谱就得透彻理解持续交付的精髓，需要团队中人人都有质量意识，人人都有发布周期的紧迫感，并且能够做到高效合作，从需求划分、代码质量、测试保障等做好各个环节的工作，做好缺陷的预防和监控，不让严重缺陷流入后面阶段。</p>\n<p>蓝鲸项目由于新人较多、人员流动大等原因，质量意识和紧迫感都有待提高。不过，在各位QA的影响下，这些问题都在改善，新人的技能也在不断的学习和实践中得到提高，但仍然不能放松警惕，需要时刻保持向前的精神面貌。</p>\n<h4>3. 充分必要的测试支撑</h4>\n<p>有了足够的安全的车和足够靠谱的司机，还得保证路况够好，这样才能做到不管到达哪个站，间隔都是相同的。</p>\n<p>要想蓝鲸项目的持续交付能够顺利前行、一路畅通，需要严格做好质量内建工作，各层都有充分必要的自动化测试保护，减少新功能开发过程中对老功能的破坏；同时持续集成流水线也要健全，不能耽误代码提交和出包，以防影响开发和测试的进度。</p>\n<p>蓝鲸项目开发年限已久，复杂度很高，在持续交付的路上行走的有些坎坷。目前团队正在这些方面努力采取改进措施，取得了不少进展，但确实还有不少提高的空间。</p>\n<h3>前景堪忧？</h3>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/02/4-sulphur-bottom.jpg\" alt=\"\"></p>\n<p>过去七年，蓝鲸的持续交付之路有些坎坷，但不应因此而失去信心。</p>\n<p>通过跟公交系统进行对比，我们可以看到蓝鲸项目要缩短发布周期、杜绝hotfix，需要从需求切分、迭代规划、技术架构、团队能力建设和测试策略调整等多方面进行优化，才能保证持续、快速的发布节奏，这是一个系统的问题。</p>\n<p>七年之痒已经平安度过，蓝鲸团队正在采取相应的改进措施，一旦做好了上述各方面的优化，在下一个七年，一周发布一次或者更短的发布周期都将不是梦！</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"110297\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"110297votetotal\">2</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"110297\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 1 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i> 2 评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/thoughtworkschina\">ThoughtWorks</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/thoughtworkschina\">\r\n\t\t\t<img src=\"http://tp3.sinaimg.cn/1774908135/180/0/1\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            ThoughtWorks是一家全球IT咨询公司，追求卓越软件质量，致力于科技驱动商业变革。擅长构建定制化软件产品，帮助客户快速将概念转化为价值。同时为客户提供用户体验设计、技术战略咨询、组织转型等咨询服务。        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/thoughtworkschina\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/thoughtworkschina/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/thoughtworkschina/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 34</a> · <a title=\"我的网站\" target=\"_blank\" href=\"http://insights.thoughtworkers.org/\"><i class=\"fa fa-link\"></i></a> <a title=\"微博主页\" target=\"_blank\" href=\"http://weibo.com/thoughtworkschina\"><i class=\"fa fa-weibo\"></i></a>         </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_url": ["http://insights.thoughtworkers.org/wp-content/uploads/2017/02/1-bus.jpeg"], "tags": "IT技术,发布,测试", "url_object_id": "be818fb6fcaadecc367e77a51182d8f1", "title": "为什么不能每周发布一次？", "comment_nums": 2, "front_image_path": "full/787600816505f8f1cebb16eb081173ce08bf0d08.jpg", "create_date": "2017/02/21"}
{"url": "http://blog.jobbole.com/110123/", "praise_nums": "1", "fav_nums": 0, "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"><p><script src=\"http://www.imooc.com/open/courselistrandjs\"></script><span style=\"display:block;margin-bottom:10px;\"></span></p>\n</div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文由 <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/snowhere\">孙腾浩</a> 翻译，<a href=\"http://www.jobbole.com/members/liuchang\">刘唱</a> 校稿。未经许可，禁止转载！<br>英文出处：<a target=\"_blank\" href=\"https://dev.to/0x13a/the-art-of-defensive-programming\">Diego Mariani</a>。欢迎加入<a target=\"_blank\" href=\"http://group.jobbole.com/category/feedback/trans-team/\">翻译组</a>。</div><p>为什么开发者不编写安全的代码？我们在这并不是要再一次讨论「整洁代码」。我们要从纯粹的实用观点出发，讨论软件的安全性和保密性。是的，因为不安全的软件不仅无用，而且还可怕。我们来看看什么是不安全的软件。</p>\n<ul>\n<li>1996年6月4日，欧洲航天局的 Ariane 5 Flight 501 在起飞后 40 秒被引爆。因为导航软件里的一个 bug，这个价值 10 亿美金的运载火箭不得不自毁。<br>\n<img class=\"alignnone\" src=\"http://ww2.sinaimg.cn/mw690/7cc829d3gw1f6r1wqy5zdj20b408cwem.jpg\" width=\"400\" height=\"300\"></li>\n<li>1991年2月25日，MIM-104 Patriot（爱国者）里的一个软件错误使它的系统每一百小时有三分之一秒的时钟偏移，导致定位拦截入侵导弹失败。结果伊拉克的飞毛腿导弹击中宰赫兰（沙特阿拉伯东北部城市）的一个美军军营，28 人死亡，100 多人受伤。</li>\n<li>其他案例，请参见《<a class=\"archive-title\" title=\"Bug 引发的 18 次重大事故\" href=\"http://blog.jobbole.com/104583/\" target=\"_blank\"><span data-rel=\"title\">Bug 引发的 18 次重大事故</span></a>》。</li>\n</ul>\n<p>这应该能够说明编写安全软件的重要性了，尤其在特定的环境中。当然也包括其他用例中，我们也应该意识到我们的软件 bug 会导致什么后果。</p>\n<h2>防御性编程初窥</h2>\n<p>为什么我认为在特定种类的工程中，防御性编程是解决这些问题好办法？</p>\n<blockquote><p>抵御那些不可能的事，因为看似不可能的事也会发生。</p></blockquote>\n<p>防御性编程中有很多防御方式，这也取决于你的软件项目所需的「安全」级别和资源级别。</p>\n<blockquote><p>防御性编程是防御式设计的一种形式，用来确保软件在未知的环境中能继续运行。防御性编程的实践往往用于需要高可用性、安全性、保密性的地方。—— 维基百科</p></blockquote>\n<p>我个人相信这种方法适合很多人参与的大型、长期的项目。例如，一个需要大量维护的开源项目。</p>\n<p>我们来探索一下我提出的关键点，来完成一个防御性编程的实现。</p>\n<h2>永远不要相信用户输入</h2>\n<p>设想你总是获取到你不想要的东西。因为像我们说过的，我们预期的是异常情况的出现，（所以）要时刻防备用户输入以及通常会传入你系统的东西，这是你成为一个防御性程序员的方法。试着做到尽可能的严格，确保输入的值就是你所期望的值。</p>\n<p><em><img class=\"alignnone aligncenter\" src=\"https://res.cloudinary.com/practicaldev/image/fetch/s--Pic7qAkP--/c_limit,f_auto,fl_progressive,q_auto,w_725/https://medium2.global.ssl.fastly.net/max/2000/1%2AwJBEFQ8XcNR7RzlMnTF_fw.png\" width=\"489\" height=\"350\"></em></p>\n<p style=\"text-align: center;\"><em>进攻是最好的防守</em></p>\n<p>设置白名单而不是黑名单。举个例子，当你验证图像扩展名时，不要检查非法的类型，而是检查合法的类型并排除其他类型。在 PHP 有无数的开源校验库可以让你的工作变简单。</p>\n<p>进攻是最好的防守。共勉</p>\n<h2>数据库抽象化</h2>\n<p>在 <a href=\"https://www.veracode.com/directory/owasp-top-10\">OWASP Top 10 Security Vulnerabilities</a> 排首位的是注入攻击。这意味着有些人（很多人）还没有使用安全的工具来查询数据库。请使用数据库抽象包或库。在 PHP 里你可以使用 <a href=\"http://php.net/manual/en/book.pdo.php\">PDO</a> 来<a href=\"http://stackoverflow.com/questions/134099/are-pdo-prepared-statements-sufficient-to-prevent-sql-injection\">确保基本的注入攻击防范</a>。</p>\n<h2>不要重复发明轮子</h2>\n<p>你不用框架（或微框架）吗？好吧恭喜你，你喜欢毫无理由地做额外的工作。这并不仅跟框架有关，也意味着你可以方便地<a href=\"https://packagist.org/\">使用已经存在的、经过测试的、受万千开发者信任的、稳定的</a>新特性，而不是你只为了自己从中受益而制作的东西。你自己创建方法的唯一原因是你需要的东西不存在，或存在但不符合你的需求（性能差、缺失特性等等）。</p>\n<p>这就是所谓的智能代码重用。拥抱它吧。</p>\n<h2>不要相信开发者</h2>\n<p>防御性编程与防御性驾驶相关联。在防御性驾驶中，我们假设周围的每个人都可能犯错。所以我们要留意别人的行为。相同概念也适用于防御性编程，我们作为开发者不要相信其他开发者的代码。我们同样也不要相信我们的代码。</p>\n<p>在很多人参与的大型项目中，我们有许多方式编写并组织代码。这也导致混乱甚至更多的 bug。这也是我们需要加强规范代码风格和代码检查的原因，让生活更轻松。</p>\n<h2>编写符合 SOLID 原则的代码</h2>\n<p>这是（防御性）编程最困难的部分——<a href=\"https://medium.com/web-engineering-vox/how-to-write-solid-code-that-doesnt-suck-2a3416623d48\">编写不糟糕的代码</a>。这也是很多人知道并一直在讨论的，但没有人真正关心或将注意力和精力放在实现符合 SOLID 原则的代码上。</p>\n<p>让我们看一些糟糕的例子</p>\n<blockquote><p>避免：未初始化的属性</p></blockquote>\n<p></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-58adaad739708625014226\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n&lt;?php\r\n\r\nclass BankAccount\r\n{\r\n    protected $currency = null;\r\n    public function setCurrency($currency) { ... }\r\n    public function payTo(Account $to, $amount)\r\n    {\r\n        // sorry for this silly example\r\n        $this-&gt;transaction-&gt;process($to, $amount, $this-&gt;currency);\r\n    }\r\n}\r\n\r\n// I forgot to call $bankAccount-&gt;setCurrency('GBP');\r\n$bankAccount-&gt;payTo($joe, 100);</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-58adaad739708625014226-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739708625014226-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739708625014226-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739708625014226-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739708625014226-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739708625014226-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739708625014226-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739708625014226-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739708625014226-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739708625014226-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739708625014226-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739708625014226-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739708625014226-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739708625014226-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739708625014226-15\">15</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-58adaad739708625014226-1\"><span class=\"crayon-o\">&lt;</span><span class=\"crayon-sy\">?</span><span class=\"crayon-e\">php</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739708625014226-2\"> </div><div class=\"crayon-line\" id=\"crayon-58adaad739708625014226-3\"><span class=\"crayon-t\">class</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">BankAccount</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739708625014226-4\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-58adaad739708625014226-5\"><span class=\"crayon-h\">    </span><span class=\"crayon-m\">protected</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">currency</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">null</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739708625014226-6\"><span class=\"crayon-h\">    </span><span class=\"crayon-m\">public</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">setCurrency</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">currency</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-58adaad739708625014226-7\"><span class=\"crayon-h\">    </span><span class=\"crayon-m\">public</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">payTo</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">Account</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-st\">to</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">amount</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739708625014226-8\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-58adaad739708625014226-9\"><span class=\"crayon-h\">        </span><span class=\"crayon-c\">// sorry for this silly example</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739708625014226-10\"><span class=\"crayon-h\">        </span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-v\">transaction</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">process</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-st\">to</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">amount</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-v\">currency</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-58adaad739708625014226-11\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739708625014226-12\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-58adaad739708625014226-13\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739708625014226-14\"><span class=\"crayon-c\">// I forgot to call $bankAccount-&gt;setCurrency('GBP');</span></div><div class=\"crayon-line\" id=\"crayon-58adaad739708625014226-15\"><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">bankAccount</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">payTo</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">joe</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">100</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0020 seconds] -->\r\n<p>在这个例子中，我们需要牢记签发付款前要先调用 setCurrency。这是很糟糕的事情，一个像这样的改变状态的操作（签发付款）不应该分两步来完成，且使用两个公开的方法。我们还可以用很多方法付款，但我们必须只有一个公开的方法来改变状态（对象不应该存在不一致的状态）。</p>\n<p>在这个例子中，我们把它改进，将未初始化的属性封装进 Money 对象。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-58adaad739713294619033\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n&lt;?php\r\n\r\nclass BankAccount\r\n{\r\n    public function payTo(Account $to, Money $money) { ... }\r\n}\r\n\r\n$bankAccount-&gt;payTo($joe, new Money(100, new Currency('GBP')));</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-58adaad739713294619033-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739713294619033-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739713294619033-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739713294619033-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739713294619033-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739713294619033-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739713294619033-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739713294619033-8\">8</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-58adaad739713294619033-1\"><span class=\"crayon-o\">&lt;</span><span class=\"crayon-sy\">?</span><span class=\"crayon-e\">php</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739713294619033-2\"> </div><div class=\"crayon-line\" id=\"crayon-58adaad739713294619033-3\"><span class=\"crayon-t\">class</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">BankAccount</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739713294619033-4\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-58adaad739713294619033-5\"><span class=\"crayon-h\">    </span><span class=\"crayon-m\">public</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">payTo</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">Account</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-st\">to</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Money</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">money</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739713294619033-6\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-58adaad739713294619033-7\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739713294619033-8\"><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">bankAccount</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">payTo</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">joe</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Money</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">100</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Currency</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">'GBP'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0015 seconds] -->\r\n<p>使它万无一失。不要使用未初始化的对象属性。</p>\n<blockquote><p>避免：在类的作用域外泄露状态</p></blockquote>\n<p></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-58adaad739717302894315\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n&lt;?php\r\n\r\nclass Message\r\n{\r\n    protected $content;\r\n    public function setContent($content)\r\n    {\r\n        $this-&gt;content = $content;\r\n    }\r\n}\r\n\r\nclass Mailer\r\n{\r\n    protected $message;\r\n    public function __construct(Message $message)\r\n    {\r\n        $this-&gt;message = $message;\r\n    }\r\n    public function sendMessage(\r\n    {\r\n        var_dump($this-&gt;message);\r\n    }\r\n}\r\n\r\n$message = new Message();\r\n$message-&gt;setContent(\"bob message\");\r\n$joeMailer = new Mailer($message);\r\n\r\n$message-&gt;setContent(\"joe message\");\r\n$bobMailer = new Mailer($message);\r\n\r\n$joeMailer-&gt;sendMessage();\r\n$bobMailer-&gt;sendMessage();</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-58adaad739717302894315-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739717302894315-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739717302894315-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739717302894315-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739717302894315-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739717302894315-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739717302894315-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739717302894315-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739717302894315-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739717302894315-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739717302894315-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739717302894315-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739717302894315-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739717302894315-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739717302894315-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739717302894315-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739717302894315-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739717302894315-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739717302894315-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739717302894315-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739717302894315-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739717302894315-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739717302894315-23\">23</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739717302894315-24\">24</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739717302894315-25\">25</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739717302894315-26\">26</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739717302894315-27\">27</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739717302894315-28\">28</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739717302894315-29\">29</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739717302894315-30\">30</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739717302894315-31\">31</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad739717302894315-32\">32</div><div class=\"crayon-num\" data-line=\"crayon-58adaad739717302894315-33\">33</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-58adaad739717302894315-1\"><span class=\"crayon-o\">&lt;</span><span class=\"crayon-sy\">?</span><span class=\"crayon-e\">php</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739717302894315-2\"> </div><div class=\"crayon-line\" id=\"crayon-58adaad739717302894315-3\"><span class=\"crayon-t\">class</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Message</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739717302894315-4\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-58adaad739717302894315-5\"><span class=\"crayon-h\">    </span><span class=\"crayon-m\">protected</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">content</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739717302894315-6\"><span class=\"crayon-h\">    </span><span class=\"crayon-m\">public</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">setContent</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">content</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-58adaad739717302894315-7\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739717302894315-8\"><span class=\"crayon-h\">        </span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-v\">content</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">content</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-58adaad739717302894315-9\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739717302894315-10\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-58adaad739717302894315-11\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739717302894315-12\"><span class=\"crayon-t\">class</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Mailer</span></div><div class=\"crayon-line\" id=\"crayon-58adaad739717302894315-13\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739717302894315-14\"><span class=\"crayon-h\">    </span><span class=\"crayon-m\">protected</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">message</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-58adaad739717302894315-15\"><span class=\"crayon-h\">    </span><span class=\"crayon-m\">public</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">__construct</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">Message</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">message</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739717302894315-16\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-58adaad739717302894315-17\"><span class=\"crayon-h\">        </span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-v\">message</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">message</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739717302894315-18\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-58adaad739717302894315-19\"><span class=\"crayon-h\">    </span><span class=\"crayon-m\">public</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sendMessage</span><span class=\"crayon-sy\">(</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739717302894315-20\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-58adaad739717302894315-21\"><span class=\"crayon-h\">        </span><span class=\"crayon-e\">var_dump</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-v\">message</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739717302894315-22\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-58adaad739717302894315-23\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739717302894315-24\"> </div><div class=\"crayon-line\" id=\"crayon-58adaad739717302894315-25\"><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">message</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Message</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739717302894315-26\"><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">message</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">setContent</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"bob message\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-58adaad739717302894315-27\"><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">joeMailer</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Mailer</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">message</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739717302894315-28\"> </div><div class=\"crayon-line\" id=\"crayon-58adaad739717302894315-29\"><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">message</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">setContent</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"joe message\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739717302894315-30\"><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">bobMailer</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Mailer</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">message</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-58adaad739717302894315-31\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad739717302894315-32\"><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">joeMailer</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">sendMessage</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-58adaad739717302894315-33\"><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">bobMailer</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">sendMessage</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0035 seconds] -->\r\n<p>在这个例子中，Message 是通过引用传递的，两个实例的输出都是 “joe message”。一个解决方案是复制 Mailer 构造函数中的 message 对象。但是我们应该做的是试着使用（不可变的）<a href=\"https://en.wikipedia.org/wiki/Value_object\">值对象</a>，而不是简单可变的 Message 对象。尽可能使用不可变的对象。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-58adaad73971b429587881\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n&lt;?php\r\n\r\nclass Message\r\n{\r\n    protected $content;\r\n    public function __construct($content)\r\n    {\r\n        $this-&gt;content = $content;\r\n    }\r\n}\r\n\r\nclass Mailer \r\n{\r\n    protected $message;\r\n    public function __construct(Message $message)\r\n    {\r\n        $this-&gt;message = $message;\r\n    }\r\n    public function sendMessage()\r\n    {\r\n        var_dump($this-&gt;message);\r\n    }\r\n}\r\n\r\n$joeMailer = new Mailer(new Message(\"bob message\"));\r\n$bobMailer = new Mailer(new Message(\"joe message\"));\r\n\r\n$joeMailer-&gt;sendMessage();\r\n$bobMailer-&gt;sendMessage();</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-58adaad73971b429587881-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad73971b429587881-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-58adaad73971b429587881-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad73971b429587881-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-58adaad73971b429587881-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad73971b429587881-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-58adaad73971b429587881-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad73971b429587881-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-58adaad73971b429587881-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad73971b429587881-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-58adaad73971b429587881-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad73971b429587881-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-58adaad73971b429587881-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad73971b429587881-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-58adaad73971b429587881-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad73971b429587881-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-58adaad73971b429587881-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad73971b429587881-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-58adaad73971b429587881-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad73971b429587881-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-58adaad73971b429587881-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad73971b429587881-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-58adaad73971b429587881-23\">23</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad73971b429587881-24\">24</div><div class=\"crayon-num\" data-line=\"crayon-58adaad73971b429587881-25\">25</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad73971b429587881-26\">26</div><div class=\"crayon-num\" data-line=\"crayon-58adaad73971b429587881-27\">27</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-58adaad73971b429587881-28\">28</div><div class=\"crayon-num\" data-line=\"crayon-58adaad73971b429587881-29\">29</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-58adaad73971b429587881-1\"><span class=\"crayon-o\">&lt;</span><span class=\"crayon-sy\">?</span><span class=\"crayon-e\">php</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad73971b429587881-2\"> </div><div class=\"crayon-line\" id=\"crayon-58adaad73971b429587881-3\"><span class=\"crayon-t\">class</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Message</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad73971b429587881-4\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-58adaad73971b429587881-5\"><span class=\"crayon-h\">    </span><span class=\"crayon-m\">protected</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">content</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad73971b429587881-6\"><span class=\"crayon-h\">    </span><span class=\"crayon-m\">public</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">__construct</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">content</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-58adaad73971b429587881-7\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad73971b429587881-8\"><span class=\"crayon-h\">        </span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-v\">content</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">content</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-58adaad73971b429587881-9\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad73971b429587881-10\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-58adaad73971b429587881-11\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad73971b429587881-12\"><span class=\"crayon-t\">class</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Mailer</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-58adaad73971b429587881-13\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad73971b429587881-14\"><span class=\"crayon-h\">    </span><span class=\"crayon-m\">protected</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">message</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-58adaad73971b429587881-15\"><span class=\"crayon-h\">    </span><span class=\"crayon-m\">public</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">__construct</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">Message</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">message</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad73971b429587881-16\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-58adaad73971b429587881-17\"><span class=\"crayon-h\">        </span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-v\">message</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">message</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad73971b429587881-18\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-58adaad73971b429587881-19\"><span class=\"crayon-h\">    </span><span class=\"crayon-m\">public</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sendMessage</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad73971b429587881-20\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-58adaad73971b429587881-21\"><span class=\"crayon-h\">        </span><span class=\"crayon-e\">var_dump</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">$</span><span class=\"crayon-r\">this</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-v\">message</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad73971b429587881-22\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-58adaad73971b429587881-23\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad73971b429587881-24\"> </div><div class=\"crayon-line\" id=\"crayon-58adaad73971b429587881-25\"><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">joeMailer</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Mailer</span><span class=\"crayon-sy\">(</span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Message</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"bob message\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad73971b429587881-26\"><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">bobMailer</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Mailer</span><span class=\"crayon-sy\">(</span><span class=\"crayon-r\">new</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Message</span><span class=\"crayon-sy\">(</span><span class=\"crayon-s\">\"joe message\"</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-58adaad73971b429587881-27\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-58adaad73971b429587881-28\"><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">joeMailer</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">sendMessage</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-58adaad73971b429587881-29\"><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">bobMailer</span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-e\">sendMessage</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0031 seconds] -->\r\n<p></p>\n<h2>编写测试</h2>\n<p>这点我们很还需要再说吗？编写单元测试可以帮助你秉承一般的原则，比如高内聚、单一职责、低耦合和正确的对象组合。它不仅帮助你测试小的单元用例，也能测试你组织对象的方式。确实，当测试你的小功能时，你会清晰的看到你需要测试多少情况和需要模拟多少对象，来达到 100% 的覆盖率。</p>\n<h2>结论</h2>\n<p>希望你喜欢这篇文章。记住这些仅仅是建议而已，由你决定何时、何处以及是否应用。</p>\n<p>感谢阅读！</p>\n\r\n        \r\n            <blockquote class=\"rewards\">\n        <p><strong>打赏支持我翻译更多好文章，谢谢！</strong></p>\n        <a href=\"#rewardbox\" id=\"rewards-button\" class=\"fancybox\"><span class=\"btn-bluet-blue href-style\"><i class=\"fa fa-jpy\"></i> 打赏译者</span></a>\n    </blockquote>\n\n    <div id=\"rewardbox\">\n        <h4>打赏支持我翻译更多好文章，谢谢！</h4>\n                <p>任选一种支付方式</p>\n                <p>\n                        <img src=\"http://jbcdn2.b0.upaiyun.com/2017/01/5085cce1bd4e144b7d148079a34b20c1.jpg\">\n            \n                            <img src=\"http://jbcdn2.b0.upaiyun.com/2017/01/02b09a29fdb3ab5fe03d4bd1afe95664.jpg\">\n                    </p>\n    </div>\n\n    \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"110123\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"110123votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"110123\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i>  收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/snowhere\">孙腾浩</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/snowhere\">\r\n\t\t\t<img src=\"http://jbcdn2.b0.upaiyun.com/2016/12/8b28eb463f61fc4c63b814690dfc40e3.png\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            write the code, change the world.        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/snowhere\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/snowhere/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/snowhere/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 12</a> · <a title=\"我的网站\" target=\"_blank\" href=\"http://snowhere.me/\"><i class=\"fa fa-link\"></i></a> <a title=\"QQ：459904593\" target=\"_blank\" href=\"#\"><i class=\"fa fa-qq\"></i></a> <a title=\"GitHub主页\" target=\"_blank\" href=\"https://github.com/Snowhere/\"><i class=\"fa fa-github\"></i></a>         </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "front_image_url": ["http://ww2.sinaimg.cn/mw690/7cc829d3gw1f6r1wqy5zdj20b408cwem.jpg"], "tags": "其他,Bug,安全,软件开发", "url_object_id": "fc974d7d9cd914700b735f8d1d00b89a", "title": "想写无Bug的安全代码？看防御性编程的艺术", "comment_nums": 0, "front_image_path": "full/baaeb2680c2322b87da39ac99b973d9c5f676e18.jpg", "create_date": "2017/02/21"}
